mon
astron
soc
000
1–9
2011
latex
style
ﬁle
v2.2.1
margins
ﬁxed
symplectic
integrators
shearing
sheet
hanno
rein
cid:63
scott
tremaine
institute
advanced
study
einstein
drive
princeton
08540
usa
submitted
march
2011
revised
april
2011
accepted
april
2011
published
abstract
shearing
sheet
model
dynamical
system
used
study
small-scale
dy-
namics
astrophysical
disks
numerical
simulations
particle
trajectories
shearing
sheet
usually
employ
leapfrog
integrator
integrator
performs
poorly
velocity-dependent
coriolis
forces
describe
two
new
integrators
purpose
symplectic
time-reversible
second-order
accurate
easily
generalized
higher
orders
moreover
integrators
exact
small-scale
forces
mutual
gravitational
forces
disk
particles
numerical
experiments
integra-
tors
errors
often
several
orders
magnitude
smaller
competing
methods
ﬁrst
new
integrators
sei
well-suited
disks
typical
inter-particle
separation
large
compared
particles
hill
radii
e.g.
planetary
rings
second
seki
designed
disks
particles
bound
orbits
separation
smaller
hill
radius
e.g.
irregular
satellites
giant
planets
key
words
methods
n-body
simulations
methods
numerical
celestial
mechanics
planets
rings
planets
satellites
formation
introduction
hill
approximation
hill
approximation
shearing
sheet
approximation
essential
tool
study
small-scale
dynamics
astro-
physical
disks
general
review
hill
approximation
see
e.g.
binney
tremaine
2008
method
originally
de-
vised
hill
1878
study
motion
moon
applied
galaxy
disks
e.g.
goldreich
lynden-bell
1965
julian
toomre
1966
goldreich
tremaine
1978
accretion
disks
e.g.
hawley
balbus
1992
stone
gardiner
2010
plan-
etary
rings
e.g.
wisdom
tremaine
1988
salo
1992
richardson
1994
crida
2010
rein
papaloizou
2010
planetesimal
disks
e.g.
tanga
2004
johansen
2009
bai
stone
2010
rein
2010
hill
approximation
widely
used
nu-
merical
simulations
impossible
model
entire
disk
adequate
numerical
resolution
paper
discusses
numerical
methods
following
orbits
hill
approximation
ﬁrst
describe
relevant
equations
motion
sect
review
existing
integrators
sect
describe
two
new
algorithms
sect
compare
con-
vergence
performance
integrators
summarize
discuss
several
generalizations
sect
cid:63
e-mail
rein
ias.edu
cid:13
2011
ras
simplicity
consider
mainly
three-body
problem
al-
though
results
describe
easy
generalize
sys-
tems
planetary
rings
see
sect
thus
follow
mo-
tion
two
nearby
small
bodies
masses
grav-
itational
ﬁeld
large
body
mass
cid:29
careful
version
derivation
given
h´enon
petit
1986
two
small
bodies
follow
approximately
orbit
around
large
body
assume
mean
orbit
circular
semi-major
axis
angular
speed
mean
orbit
m+m
/a3
1/2
m1+m2
formally
derive
hill
equations
motion
one
lets
m/m
shrink
zero
assuming
mass
ratio
m1/m2
ﬁxed
separation
two
small
bodies
order
m/m
1/3
let
adopt
local
right-handed
cartesian
coordinate
system
origin
rotating
uniformly
angular
velocity
unit
vector
points
away
larger
mass
unit
vector
points
direction
motion
along
mean
orbit
unit
vector
points
direction
angular
velocity
vector
mean
orbit
hill
equations
motion
relative
position
−2ω
3ω2
force
exerted
−∇φ
gm/|r|
hamiltonian
corresponding
equations
mo-
rein
tremaine
tion
cid:104
cid:105
canonical
momentum
conjugate
note
equations
motion
invariant
cid:16
shear
transformation
ωeyt
cyey
cid:17
arbitrary
constants
invariance
allows
use
periodic
shearing
boundary
conditions
study
local
dynamics
disks
one
reason
hill
approximation
useful
alternatively
work
non-rotating
accelerated
reference
frame
origin
relative
position
frame
reference
frames
coincide
cid:110
cid:111
cos
sin
hamiltonian
−gm/|r|
since
|r|
|r|
physical
interpretation
eqs
opti-
mum
choice
integrator
depend
relative
size
terms
right
side
parametrized
using
hill
radius
rhill
3gm/ω2
1/3
sets
relevant
scale
problem
mass
small
bodies
negligible
rhill
relative
motion
simply
epicyclic
motion
solved
exactly
see
e.g
h´enon
petit
1986
binney
tremaine
2008
suﬃciently
small
motion
re-
garded
perturbed
epicycle
quantitatively
requires
one
ﬁrst
three
terms
right
side
cid:104
much
larger
|f|
gm/r2
ωrhill/v
1/2
cid:105
cid:29
min
rhill
velocity
one
example
planetary
ring
semi-major
axis
much
less
roche
limit
2.46
3m/
4πρp
1/3
planet
mass
masses
ring
particles
ring-particle
den-
sity
two
particles
separation
less
twice
radius
implies
r/rhill
cid:38
ar/a
cid:29
force
due
mutual
gravity
small
masses
large
interpret
solution
keplerian
orbit
per-
turbed
coriolis
tidal
forces
terms
proportional
respectively
circular
orbit
semi-major
axis
ratio
perturbing
forces
kepler
force
gm/r2
r/rhill
3/2
r/rhill
respectively
one
example
ir-
regular
satellites
giant
planets
solar
system
typically
r/rhill
cid:39
0.1–0.5
integrators
3.1
leapfrog
integrator
many
n-body
simulations
hill
approximation
con-
texts
use
standard
leapfrog
integrator
e.g.
springel
2005
binney
tremaine
2008
however
shall
show
leapfrog
work
well
hill
approximation
velocity-dependent
forces
leapfrog
best
suited
integrat-
ing
equations
motion
form
−∇φ
general
time-dependent
potential
note
written
form
hamiltonian
corre-
sponding
hkin
assume
position
velocity1
particle
time
goal
approximate
new
position
velocity
time
tn+1
leapfrog
usually
written
chain
three
operators
labeled
kick
drift
kick
applied
successively2
vn+1/2
fn+1
vn+1/2
rn+1
vn+1/2
vn+1
kick
drift
kick
−∇φ
kick
operator
corresponds
follow-
ing
trajectory
exactly
inﬂuence
hamiltonian
potential
energy
drift
operator
corresponds
hamiltonian
hkin
kinetic
energy
thus
denote
op-
erator
exact
evolution
trajectory
time-step
un-
der
arbitrary
hamiltonian
single
leapfrog
step
operator
ˆhkin
operators
symplectic
since
governed
hamiltonian
im-
plies
leapfrog
operator
also
symplectic
saha
tremaine
1992
moreover
leapfrog
time-reversible
second-order
error
single
time-step
∆t3
ˆhkin
leapfrog
used
hill
approximation
integrate
equations
motion
governed
rather
additional
terms
right
side
added
kick
step
since
change
velocity
thus
partly
component
notation
clarity
vn+1/2
vn+1/2
vn+1/2
kick
cid:17
cid:17
cid:17
3ω2
cid:16
cid:16
−2ω
cid:16
−ω2
cid:16
cid:16
−2ω
vn+1/2
cid:16
−ω2
zn+1
n+1
cid:17
n+1
cid:17
3ω2
xn+1
vn+1/2
rn+1
vn+1
vn+1
vn+1
vn+1/2
vn+1/2
vn+1/2
vn+1/2
cid:17
drift
kick
n+1
however
velocity-dependent
coriolis
force
right
side
form
leapfrog
loses
desirable
prop-
erties
neither
symplectic
time-reversible
ﬁrst-order
accurate
rather
second-order
error
single
time-step
∆t2
iii
leads
secular
drifts
quantities
conserved
principle
diﬃculties
could
avoided
using
hamiltonian
canonical
momentum
time
derivative
position
velocity
case
hamiltonian
hill
approximation
one
also
apply
operators
diﬀerent
order
drift
kick
drift
change
conclusion
paper
cid:13
2011
ras
mnras
000
1–9
leapfrog
integrate
equations
motion
form
velocity-dependent
forces
leapfrog
symplectic
time-
reversible
second-order
pursue
option
equations
invariant
shear
transformation
limits
usefulness
study
disks
rings
method
described
sect
3.5
better
schemes
constructing
symplectic
integrators
arbitrary
hamiltonians
generally
implicit
often
algebraically
complicated
least
high-order
schemes
ﬁrst
explicit
symplectic
integrator
trajectories
hill
approxima-
tion
due
heggie
2001
however
heggie
integrator
time-reversible
ﬁrst-order
discuss
numerical
experiments
show
competitive
integrators
described
3.2
modiﬁed
leapfrog
integrator
one
improve
standard
leapfrog
algorithm
using
pre-
dictor
step
approximate
velocity-dependent
forces
end
time-step
leads
following
scheme
cid:17
cid:17
cid:17
cid:17
3ω2
cid:16
cid:16
−2ω
cid:16
−ω2
cid:16
cid:16
−2ω
cid:17
cid:16
cid:17
cid:16
−2ω
¯vn
cid:16
−ω2
zn+1
n+1
3ω2
n+1
cid:17
vn+1/2
vn+1/2
vn+1/2
¯vn+1
¯vn+1
rn+1
vn+1
vn+1
vn+1
vn+1/2
vn+1/2
vn+1/2
vn+1/2
3ω2
xn+1
¯vn
n+1
kick
cid:17
drift
kick
¯vn+1
predicted
value
velocity
time
integrator
second-order
one
order
higher
standard
leapfrog
neither
time-reversible
symplectic
method
im-
plemented
particle
codes
gasoline
pkdgrav
wadsley
2004
3.3
symmetrized
leapfrog
mikkola
merritt
2006
describe
simple
algorithm
converts
one-step
integrator
time-reversible
integrator
ap-
plied
mikkola–merritt
algorithm
standard
ﬁrst-order
leapfrog
integrator
sect
3.1
thereby
upgrading
time-
reversible
second-order
symplectic
integrator
time-
reversibility
endows
integrators
desirable
properties
symplecticity
tests
described
show
symmetrized
leapfrog
competitive
integrators
discussed
however
elegant
integrator
could
proﬁtably
applied
sys-
tems
described
complicated
time-reversible
hamiltonians
also
systems
governed
hamiltonian
3.4
quinn
integrator
recently
quinn
2010
described
integrator
exhibits
desirable
features
leapfrog
despite
presence
velocity-
dependent
forces
hill
approximation
particular
quinn
cid:13
2011
ras
mnras
000
1–9
symplectic
integrators
shearing
sheet
vn+1/4
vn+1/2
vn+1/2
vn+1/2
2ωxn
vn+1/4
ωpn
ωxn
integrator
symplectic
time-reversible
accurate
second
order
refer
reader
original
paper
derivation
merely
list
ﬁnal
algorithm
also
written
cid:16
cid:17
three
operators
kick
drift
kick3
ω2xn
cid:16
cid:16
−ω2
cid:16
cid:17
xn+1
n+1
cid:16
−ω2
zn+1
n+1
xn+1
vn+1/2
vn+3/4
vn+1/2
vn+1/2
vn+3/4
vn+1
vn+1
vn+1
vn+1/2
n+1
drift
kick
kick
rn+1
cid:17
cid:17
cid:17
3.5
symplectic
epicycle
integrator
sei
mixed
variable
symplectic
mvs
schemes
wisdom-
holman
integrator
become
method
choice
long-
term
integrations
planetary
orbits
wisdom
holman
1991
ki-
noshita
1991
like
leapfrog
mvs
schemes
split
hamil-
tonian
two
parts
analytically
integrable
first
trajectory
advanced
inﬂuence
half
time-step
full
time-step
contrast
leapfrog
ki-
netic
potential
energy
mvs
schemes
chosen
|hb|
cid:28
|ha|
thus
planetary
case
chosen
kepler
hamiltonian
represents
small
gravitational
forces
planets
mvs
integrators
symplectic
since
trajectory
advanced
sequence
hamiltonian
maps
time-reversible
error
per
time-step
∆t3
hb/ha
interestingly
even
easier
derive
mvs
integrator
hill
equations
motion
keplerian
motion
show
possible
solve
epicyclic
motion
motion
governed
hamiltonian
closed
form
almost
computational
eﬀort
see
also
h´enon
petit
1986
use
result
construct
two
new
mvs
in-
tegrators
one
two
cases
given
end
sect
systems
forces
due
gravity
small
bodies
sources
relatively
small
section
systems
gravity
single
pair
bodies
dominates
motion
sect
3.6
ﬁrst
solve
equations
motion
governed
shift
particle
coordinate
system
particle
center
epicyclic
motion
origin
rotation
account
evolution
epicycle
finally
shift
back
account
shear
using
notation
above4
center
epicyclic
mo-
drift
step
standard
leapfrog
kick
step
modiﬁed
note
velocity
canonical
momentum
rein
tremaine
tion
particle
2vn
2vn
ω−1
4xn
ω−1
deﬁne
evolution
quantities
one
time-step
written
rotation
around
origin
angle
ω∆t
xn+1
−xn
yn+1
cos
sin
sin
cos
undo
previous
shift
center
epicyclic
motion
account
shear
get
position
velocity
new
time
ω−1
ω−1
xn+1
xn+1
yn+1
2yn+1
vn+1
yn+1
−2xn+1
vn+1
integration
vertical
motion
also
described
rotation
new
vertical
position
velocity
time
+∆t
given
zn+1
cos
−znω
sin
vn+1
ω−1
sin
cos
uses
hill
approximation
galactic
disks
epicycle
vertical
frequencies
may
diﬀer
azimuthal
frequency
generalization
easy
incorporate
op-
erator
corresponding
steps
may
written
notation
ˆh0
note
function
evaluation
performed
dur-
ing
entire
step
i.e.
call
sqrt
sines
cosines
appearing
equations
constant
particles
pre-calculated
beginning
time-step
even
beginning
simulation
time-step
ﬁxed
operations
additions
multiplications
signiﬁcant
additional
storage
needed
many
parti-
cles
also
note
integrator
completely
described
translations
rotations
making
attractive
choice
pro-
grams
running
graphic
processors
gpus
long
high-accuracy
integrations
round-oﬀ
errors
ro-
tations
steps
cause
linear
drift
energy
integrals
motion
rate
|∆e/e|
t/∆t
machine
precision
typically
2−53
double-precision
arithmetic
elegant
solution
problem
described
appendix
mvs
integrator
includes
additional
forces
due
potential
may
written
ˆhsei
ˆh0
ˆh0
usual
represents
kick
step
cid:16
rn+1/2
cid:17
vn+1
integrator
symplectic
time-reversible
second-order
contrast
integrators
discussed
far
becomes
exact
precisely
gravitational
po-
tential
error
sei
integrator
single
time-step
∆t3
error
quinn
integrator
∆t3
pointed
quinn
2010
numerical
codes
implement
collision
detection
usually
assume
particles
move
along
straight
lines
case
collision
detection
done
ex-
actly
although
often
done
approximately
contrast
leapfrog
quinn
integrators
trajectory
particle
sei
straight
line
kick
steps
might
make
collision
detection
harder
however
curved
trajectories
real
feature
physics
hill
approximation
therefore
make
sense
choose
integrator
solves
equa-
tions
motion
incorrectly
search
collisions
along
incorrect
trajectories
exactly
better
detect
collisions
ap-
proximately
along
exact
trajectories
reverse
developing
eﬃcient
collision
algorithm
curved
trajectories
kind
research
problem
needs
work
obvious
ﬁrst
step
re-use
already
implemented
collision
detection
algorithms
approximating
trajectory
line
joins
initial
ﬁnal
positions
deﬁned
curved
trajectory
work
reasonably
well
long
ω∆t
cid:28
3.6
symplectic
epicycle-kepler
integrator
seki
integrator
described
previous
subsection
designed
case
forces
due
potential
small
compared
forces
govern
epicyclic
motion
describe
integrator
situation
force
due
kepler
potential
−gm/|r|
comparable
stronger
forces
governing
epicyclic
motion
ﬁrst
note
one
integrate
motion
kepler
hamiltonian
hkep
hkin
gm/|r|
ex-
actly
machine
precision
eﬃcient
methods
described
wisdom
holman
1991
also
note
one
rewrite
hkep
hkin
motivates
following
scheme
call
symplectic
epicycle-kepler
integrator
seki
ˆhseki
ˆh0
ˆh0
ˆhkep
ˆhkin
ˆhkin
ˆhkin
negative
time-step
note
drift
operator
scheme
symplectic
second-order
time-reversible
statements
also
true
symmetric
permutations
operators
particular
permutation
chosen
computationally
expensive
operator
hkep
called
per
time-step
course
output
needed
every
time-step
half-steps
end
step
start
step
combined
alternative
scheme
ˆh0
ˆhkin
ˆhkep
ˆhkep
ˆhkin
hardly
expensive
note
operators
deﬁned
phase
space
operators
ˆhkin
ˆhkep
canonical
momentum
equal
velocity
∂h/∂p
ˆh0
cid:13
2011
ras
mnras
000
1–9
symplectic
integrators
shearing
sheet
4.2
perturbed
epicyclic
motion
motion
test
particle
presence
mass
cid:44
described
perturbed
epicycle
mass
suf-
ﬁciently
small
words
test
particle
suf-
ﬁciently
far
away
mass
moving
suﬃciently
fast
quantiﬁed
place
particle
initially
circular
orbit
around
mass
uniform
motion
along
hill
approxi-
mation
positions
velocities
5.55
2613.91
−8.32
trajectory
passes
perturbing
mass
impact
parameter
corresponding
rhill
integration
time
100
epicycle
periods
astrophysical
example
tra-
jectories
refer
reader
study
stochastic
motion
moonlets
embedded
saturn
rings
rein
papaloizou
2010
figure
plot
diagnostics
figure
additionally
phase
error
also
looked
measures
accuracy
integrators
show
results
sei
unbound
orbits
seki
bound
orbits
see
perform
least
well
integrators
tested
measures
examined
much
better
sei
seki
also
turn
exceptionally
good
calculating
phase
epicyclic
motion
one
see
figure
sei
seki
exhibit
en-
ergy
errors
three
orders
magnitude
smaller
integrator
typical
time-steps
used
simulations
10−3–5·10−2
eventually
errors
dominated
round-
errors
cid:46
10−4
integrators
one
see
ﬁxed
time-step
sei
produces
phase
error
seven
orders
magnitude
smaller
error
produced
quinn
integrator
figure
clear
sei
also
far
fastest
integrator
given
precision
4.3
strongly
perturbed
epicyclic
motion
also
performed
tests
place
test
particle
orbit
impact
parameter
1rhill
perturbing
forces
much
stronger
previous
case
trajectory
test
particle
horse-shoe
orbit
figure
plot
diagnostics
figure
case
one
see
sei
quinn
integrator
perform
equally
well
measured
energy
error
however
phase
error
two
orders
magnitude
smaller
using
sei
seki
integrator
rather
integrators
note
seki
integrator
signiﬁcantly
larger
energy
error
sei
test
case
hamiltonian
operators
eqs
roughly
magnitude
thus
commutators
operators
give
rise
large
integration
errors
seki
based
split
ﬁve
oper-
ators
sei
based
three
commutators
total
error
larger
seki
4.4
perturbed
keplerian
motion
ﬁnally
test
strong
gravity
regime
forces
gov-
ern
epicyclic
motion
viewed
perturbation
keple-
rian
orbit
initial
positions
velocities
0.125
−0.354
correspond
initially
circular
bound
orbit
semi-major
axis
orbit
cor-
responds
0.18rhill
integration
time
ten
epicycle
periods
corresponding
226
kepler
orbital
periods
figure
particle
motion
one
epicycle
using
diﬀerent
integrators
time-step
0.1
2πω−1
initial
position
also
exact
ﬁnal
position
marked
circle
tests
ran
many
test
integrations
study
convergence
accuracy
computational
cost
integrators
presented
previous
section
present
four
representative
examples
tests
use
algorithm
appendix
minimize
round-oﬀ
errors
without
loss
generality
set
4.1
epicyclic
motion
ﬁrst
examine
case
perturbing
force
vanishes
corresponds
rhill
case
hill
equations
motion
solved
analytically
lead
epicyclic
motion
initialize
particle
position
velocity
corresponds
tra-
jectory
clockwise
closed
ellipse
centered
origin
integrate
trajectory
forward
time
one
epicycle
period
2πω−1
illustrate
behavior
integrator
use
relatively
large
time-step
one
tenth
epicycle
period
plot
posi-
tion
particle
every
time-step
figure
expected
sei
seki
follow
analytic
solution
exactly
quinn
in-
tegrator
yields
approximate
ellipse
exhibits
phase
error
per
epicycle
period
three
versions
leapfrog
integrator
diverge
badly
analytic
solution
less
one-quarter
epicycle
period
figure
plot
relative
energy
error
function
time-step
expected
sei
seki
exact
machine
pre-
cision
time-steps
quinn
integrator
mod-
iﬁed
symmetrized
leapfrog
integrators
converge
quadratically
machine
precision
reached
leapfrog
converges
lin-
early
figure
plot
computation
time
function
relative
error
plot
shows
fastest
integrator
desired
precision
course
test
case
choice
trivial
sei
seki
give
exact
solution
time-step
cid:13
2011
ras
mnras
000
1–9
-3-2-1
3-2.5-2-1.5-1-0.5
0.5
1yxleapfrogmod
leapfrogsym
leapfrogquinnseiseki
rein
tremaine
relative
energy
error
function
time-step
lower
better
computation
time
function
relative
energy
error
lower
better
figure
epicyclic
motion
perturbing
forces
sect
4.1
case
sei
seki
follow
motion
exactly
method
described
appendix
used
control
round-oﬀ
errors
integration
time
one
epicycle
period
relative
energy
error
phase
error
function
time-step
lower
better
computation
time
function
relative
energy
error
phase
error
lower
better
figure
perturbed
epicyclic
motion
sect
4.2
trajectory
passes
perturbing
point
mass
impact
parameter
rhill
integration
time
100
epicycle
periods
cid:13
2011
ras
mnras
000
1–9
10-1410-1210-1010-810-610-410-210010-610-510-410-310-210-1100relative
errortimestep
2pw-1
leapfrogmod
leapfrogsym
leapfrogquinnseiseki10-610-510-410-310-1410-1210-1010-810-610-410-2100102computation
time
relative
energy
error10-1010-810-610-410-210010-610-510-410-310-210-1100relative
energy
errortimestep
2pw-1
10-1010-810-610-410-2100phase
errorleapfrogmod
leapfrogsym
leapfrogquinnseiseki10-410-310-210-110-1010-810-610-410-2100computation
time
relative
energy
error10-410-310-210-110-1010-810-610-410-2100computation
time
phase
error
symplectic
integrators
shearing
sheet
relative
energy
error
phase
error
function
time-step
lower
better
computation
time
function
relative
energy
error
phase
error
lower
better
figure
strongly
perturbed
epicyclic
motion
sect
4.3
trajectory
impact
parameter
rhill
corresponding
horse-shoe
orbit
integration
time
100
epicycle
periods
relative
energy
error
function
time-step
lower
better
computation
time
function
relative
error
lower
better
figure
perturbed
keplerian
motion
sect
4.4
initial
orbit
circular
semi-major
axis
0.18
rhill
integration
time
epicycle
periods
226
orbital
periods
around
mass
cid:13
2011
ras
mnras
000
1–9
10-1210-1010-810-610-410-210010-610-510-410-310-210-1100relative
energy
errortimestep
2pw-1
10-1010-810-610-410-2100phase
errorleapfrogmod
leapfrogsym
leapfrogquinnseiseki10-610-510-410-310-210-110-1010-810-610-410-2100computation
time
relative
energy
error10-510-410-310-210-110-1010-810-610-410-2100computation
time
phase
error10-1010-810-610-410-210010-610-510-410-310-210-1100relative
errortimestep
2pw-1
leapfrogmod
leapfrogsym
leapfrogquinnseiseki10-410-310-210-110010-810-610-410-2100computation
time
relative
computing
error
rein
tremaine
figure
relative
energy
error
using
diﬀerent
integrators
time-step
10−5
2πω−1
algorithm
described
appendix
used
minimize
round-oﬀ
errors
figure
plot
diagnostics
figure
seki
integrator
robust
integrator
sample
energy
error
given
time-step
two
orders
magnitude
smaller
competitors
performance
comes
drawback
time-step
computationally
expen-
sive
nevertheless
ﬁxed
energy
error
still
one
or-
der
magnitude
faster
competitors
relative
advantage
improves
orbits
smaller
semi-major
axis
relative
rhill
also
note
integrations
evaluation
forces
expensive
example
tree
code
seki
integrator
advantage
uses
fewer
time-steps
figure
shows
time
evolution
relative
energy
error
integration
10−5
2πω−1
integrators
except
various
ﬂavors
leapfrog
far
scale
therefore
plotted
show
sign
linear
drift
energy
error
maximum
error
independent
time
good
behavior
due
symplectic
nature
integrators
well
use
procedure
described
appendix
control
round-oﬀ
error
seki
integrator
two
orders
magnitude
better
integrator
example
conclusions
presented
two
new
integrators
studying
small-scale
dynamics
disks
using
hill
approximation
ﬁrst
simple
symplectic
time-reversible
integra-
tor
hill
equations
motion
call
symplectic
epicy-
cle
integrator
sei
absence
small-scale
forces
self-gravitational
forces
disk
particles
sei
solves
hill
equations
motion
epicyclic
motion
exactly
otherwise
error
ﬁxed
time
integral
scales
∆t2
small-scale
forces
numerical
tests
using
variety
measures
shown
sei
always
converges
much
faster
various
ﬂavors
leapfrog
often
much
faster
quinn
2010
inte-
grator
small
rhill/r
0.01
phase
error
seven
orders
magnitude
smaller
phase
error
quinn
integrator
time-step
figure
com-
putational
cost
per
time-step
sei
quinn
integrator
equivalent
although
sei
simple
code
implementation
downloaded
http
//sns.ias.edu/˜rein/
second
integrator
also
symplectic
time-reversible
called
symplectic
epicycle-kepler
integrator
seki
integrator
useful
following
bound
two-body
orbits
sheared
sheet
case
yield
errors
several
orders
magnitude
smaller
sei
integrators
generalized
several
ways
first
higher
order
integrators
constructed
concatenating
sei
seki
steps
varying
lengths
e.g.
yoshida
1993
second
although
discussion
paper
simplicity
focused
three-body
problem
sei
applied
n-body
problem
using
shear
periodic
boundary
conditions
e.g.
richardson
1994
force
also
describe
gas
drag
particles
al-
though
case
dynamics
described
hamiltonian
advantage
symplectic
time-reversible
integrator
less
clear
seki
integrator
also
generalized
beyond
hill
ap-
proximation
example
consider
test
particle
orbiting
gravitational
ﬁeld
binary
star
masses
hamiltonian
written
sum
two
keplerian
hamiltoni-
ans
minus
kinetic
energy
hkep
hkep
hkin
ﬁrst
two
terms
solved
exactly
last
term
simply
drift
thus
analog
provides
second-order
accu-
rate
symplectic
time-reversible
integrator
exact
test-particle
motion
dominated
gravitational
ﬁeld
either
body
acknowledgments
work
supported
part
nsf
grant
ast-0807444
nasa
grant
nnx08ah83g
thank
tobias
heinemann
helpful
discussions
tom
quinn
thoughtful
construc-
tive
referee
report
references
bai
stone
2010
apjs
190
297
binney
tremaine
2008
galactic
dynamics
second
edi-
tion
princeton
university
press
blank
kruger
pustyl
nikov
1997
arxiv
e-prints
crida
papaloizou
rein
charnoz
salmon
2010
140
944
goldreich
lynden-bell
1965
mnras
130
125
goldreich
tremaine
1978
apj
222
850
hawley
balbus
1992
apj
400
595
heggie
2001
steves
maciejewski
ed.
restless
universe
109–128
h´enon
petit
1986
cel
mech.
hill
1878
astr
nach.
251
johansen
youdin
mac
low
2009
apj
704
l75
julian
toomre
1966
apj
146
810
kinoshita
yoshida
nakai
1991
cel
mech
dyn
astr.
mikkola
merritt
2006
mnras
372
219
petit
1998
celestial
mechanics
dynamical
astronomy
cid:13
2011
ras
mnras
000
1–9
1e-10
1e-09
1e-08
1e-07
1e-06
100relative
energy
errortime
2pw-1
quinnseiseki
symplectic
integrators
shearing
sheet
tested
implementations
rotation
operator
expected
implementation
using
shear
operators
shows
sign
linear
drift
energy
figure
contrast
test
case
presented
figure
straightforward
implementation
produces
linear
drift
10−7
100
epicycle
periods
additional
computational
cost
implementing
rotations
using
shear
operators
negligible
long
integrations
reﬁnement
dramatically
improve
accuracy
quinn
perrine
richardson
barnes
2010
139
803
rein
lesur
leinhardt
2010
511
a69
rein
papaloizou
2010
524
a22
richardson
1994
mnras
269
493
saha
tremaine
1992
104
1633
salo
1992
nature
359
619
springel
2005
mnras
364
1105
stone
gardiner
2010
apjs
189
142
tanga
weidenschilling
michel
richardson
2004
427
1105
wadsley
stadel
quinn
2004
new
astronomy
137
wisdom
holman
1991
102
1528
wisdom
tremaine
1988
925
yoshida
1993
cel
mech
dyn
astr.
appendix
round-off
error
due
rotations
floating-point
operations
computer
subject
rounding
errors
ieee
standard
ﬂoating-point
arithmetic
ieee
754
speciﬁes
rounding
algorithm
ensures
rounding
error
additions
multiplications
quasi-random
thus
round-
ing
error
grow
time
t/∆t
1/2
machine
precision
sei
seki
integrators
use
rotations
written
eqs
rotation
matrix
angle
ω∆t
however
operating
matrix
position
vector
general
preserve
norm
x2+y2
1/2
numer-
ically
sin2
+cos2
cid:44
since
every
time-step
error
grows
linearly
number
operations
much
worse
t1/2
behavior
described
petit
1998
references
therein
results
undesirable
linear
drift
en-
ergy
integrators
solve
kepler
problem
using
rota-
tions
wisdom–holman
integrator
problem
usu-
ally
important
rotation
angle
kepler
problem
depends
implicitly
radius
kepler
law
thus
rotation
actually
so-called
twist
map
exists
kam-like
theorem
blank
1997
twist
maps
restricts
solution
invariant
torus
phase
space
cid:33
tors
cid:32
cos
cid:32
sin
petit
1998
describes
one
way
solve
problem
de-
composing
rotation
operator
three
shear
opera-
sin
cos
tan
cid:33
cid:32
cid:33
cid:32
sin
tan
cid:33
pn+1
help
suppose
replace
rotation
matrix
arbitrary
matrix
straightfor-
ward
show
transformation
xn+1
yn+1
pn+1
deﬁned
eqs
symplectic
det
since
represented
exactly
ﬂoating-point
arithmetic
matrices
right
side
determinant
exactly
thus
transformation
symplectic
whether
sin
tan
related
appro-
priate
trigonometric
identity
hence
insensitive
round-oﬀ
errors
evaluating
functions
cid:13
2011
ras
mnras
000
1–9
