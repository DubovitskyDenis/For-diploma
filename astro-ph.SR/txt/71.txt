astron
nachr
328
3-4
313
318
2007
doi
10.1002/asna.200610736
slim
code
simulation
wave
propagation
inhomogeneous
magnetised
solar
atmosphere
cameron⋆
gizon
daiffallah
max-planck-institut
f¨ur
sonnensystemforschung
37191
katlenburg-lindau
germany
received
nov
2006
published
online
later
paper
describe
semi-spectral
linear
mhd
slim
code
written
follow
interaction
linear
waves
inhomogeneous
three-dimensional
solar
atmosphere
background
model
allows
almost
arbitrary
perturbations
density
temperature
sound
speed
well
magnetic
velocity
ﬁelds
give
details
several
tests
used
check
code
code
useful
understanding
helioseismic
signatures
various
solar
features
including
sunspots
introduction
local
helioseismology
uses
waves
propagating
solar
interior
probe
inhomogeneities
therein
flows
temperature
magnetic
ﬁeld
inhomogeneities
imprint
signatures
waves
helioseismology
attempts
learn
inhomogeneities
studying
waves
duvall
1993
order
better
understand
various
signatures
developed
numerical
code
forward
calculations
numerically
propagates
waves
various
types
inhomogeneities
calculations
performed
past
mainly
2-d
geometry
cally
bogdan
1997
simplifying
physical
assumptions
bogdan
1996
fan
braun
chou
1995
analytic
solutions
also
exist
idealised
problems
sound
speed
perturba-
tions
jensen
pijpers
2003
isolated
mass
ﬂow
birch
felder
2004
ﬂux
tube
otherwise
uni-
form
atmosphere
gizon
hanasoge
birch
2006
solutions
useful
revealing
various
effects
aiding
understanding
remains
however
need
3-dimensional
treatments
see
werne
birch
julien
2004
paper
describes
three-dimensional
physical
mathematical
problem
chosen
tackle
well
numerical
scheme
implemented
code
subjected
number
tests
several
described
detail
intention
make
code
available
helioseismology
community
part
helas
project
e-mail
cameron
mps.mpg.de
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
statement
problem
2.1
nonlinear
equations
starting
point
consider
typical
formulation
mhd
equations
cgs
units
relevant
equations
continuity
equation
∂tρ
compressible
navier-stokes
equation
including
lorentz
buoyancy
forces
ρdtu
−∇p
+µ∆u
induction
equation
∂tb
η∆b
energy
equation
ρcvdtt
k∇2t
+viscous
heating
ohmic
heating
+radiative
heating
equation
state
solenoidality
condition
usual
symbols
used
denote
physical
quantities
appear
equations
gravitational
acceleration
assumed
uniform
constant
diffusivities
written
particularly
simple
isotropic
uniform
principle
complicated
forms
might
needed
certain
appli-
cations
however
intend
treat
waves
ideal
perturbations
ignore
effects
diffusivities
particular
forms
terms
important
2.2
ideal
linear
equations
waves
generally
small
perturbations
excited
turbulent
motions
granules
rare
cases
re-
sult
impulsive
events
ﬂares
code
follows
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
314
cameron
simulation
wave
propagation
inhomogeneous
magnetised
solar
atmosphere
evolution
perturbation
superimposed
pro-
vided
background
background
assumed
time-
independent
equilibrium
speciﬁed
giving
density
pressure
magnetic
ﬁeld
velocity
ﬁeld
ﬁrst
adiabatic
index
position
everywhere
inside
domain
background
current
sound
speed
γ1p0/ρ0
1/2
derived
quanti-
ties
perturbation
assumed
sufﬁciently
small
consider
linearised
equations
currently
as-
sume
waves
adiabatic
wave
propagation
ideal
allows
write
magnetic
velocity
pres-
sure
density
perturbations
terms
displacement
vector
using
primed
quantities
eulerian
perturba-
tions
background
state
master
equation
ρ0∂
−∇p
ρ′g
ρ0∂tξ
ρ′u
ρ0u
−ρ0u
∂tξ
perturbed
quantities
appear
equation
functions
according
∇ρ0
∇p0
ρ0ξ
∂tξ
refer
reader
lynden-bell
ostriker
1967
equation
christensen-dalsgaard
2003
page
174
treatment
continuity
equation
moffatt
1978
induction
equation
note
assumed
presence
ﬂow
magnetic
ﬁeld
mutually
exclusive
2.3
boundary
conditions
tests
described
paper
involve
magnetic
density
velocity
inhomogeneities
superimposed
isotropic
uniform
background
tests
assumed
periodicity
three
spatial
directions
however
since
code
also
intended
used
stratiﬁed
atmospheres
describe
boundary
condition
im-
plemented
cases
intend
simulate
small
regions
solar
surface
used
box-geometry
used
spec-
tral
treatment
horizontal
directions
ﬁnite
differ-
ence
vertical
boundary
conditions
naturally
important
side
boundaries
simple
box
peri-
odic
upper
boundary
currently
use
condition
lagrangian
perturbation
vertical
component
stress
tensor
vanishes
following
cally
bogdan
1997
∇πiz
stress
tensor
furthermore
assume
background
ﬂow
restricted
regions
away
top
boundary
purely
horizontal
ﬁeld
πij
b2/
δij
bibj/
regions
condition
implies
·∇πxz
b0xb
b0xb0z
b0z
condition
implies
b0yb
b0yb0z
b0z
boundary
condition
converted
constraint
top
boundary
∇πzz
b0zb
b0xb
b0yb
∇p0
known
also
deduce
density
top
boundary
using
equation
c−2
∇p0
∇ρ0
lastly
assumption
velocity
vanishes
near
boundary
implies
∂tξ
regions
boundary
conditions
otherwise
unchanged
case
magnetic
ﬁeld
bound-
ary
readily
seen
equation
specifying
boundary
equivalent
specifying
relation-
ship
∂zξx
∂zξz
similarly
constraint
∂zξy
three
∂zξz
given
condition
related
∂zξz
condition
equation
thus
three
relationships
three
unknowns
well
posed
problem
deﬁning
∂zξ
boundary
con-
ditions
magnetic
regions
equivalent
specifying
boundary
condition
three
components
∂zξ
non-magnetic
fewer
wave
modes
boundary
condition
reduces
specifying
∂zξz
special
case
boundary
condition
corresponds
free-surface
cally
bogdan
1997
2.4
initial
conditions
equations
allow
follow
evolution
arbitrary
perturbations
∂tξ
often
initial
conditions
take
form
p-mode
packet
code
able
deal
arbitrary
initial
per-
turbations
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
www.an-journal.org
astron
nachr
2007
2.5
physical
instabilities
code
evolves
perturbations
superimposed
back-
ground
atmosphere
assuming
evolution
linear
consequently
atmosphere
linearly
unstable
exponentially
growing
modes
exist
almost
cir-
cumstances
fastest
growing
modes
even-
tually
dominate
solution
particularly
important
remember
interest
wave
propagation
convection
zone
atmosphere
places
supera-
diabatically
stratiﬁed
places
atmosphere
con-
vectively
unstable
exponentially
growing
solutions
expected
real
property
background
necessarily
exist
proper
numerical
treatment
problem
suggestion
approach
adopted
preliminary
calculations
preprocess
back-
ground
becomes
marginally
stable
removes
unstable
modes
without
introducing
new
unphysical
modes
example
gravity
waves
convection
zone
naturally
code
also
used
study
linear
growth
ideal
instabilities
without
modiﬁcation
either
code
atmosphere
numerical
methods
since
chosen
periodic
boundary
conditions
side
walls
implemented
pseudo-spectral
scheme
horizontal
directions
horizontal
derivatives
evaluated
fourier
space
products
evaluated
physical
space
use
fftw
package
frigo
john-
son
2005
move
two
spaces
since
aim
model
sun
stratiﬁcation
due
gravity
implies
pe-
riodic
boundaries
appropriate
top
bot-
tom
boundaries
therefore
used
simple
two-step
lax-wendroff
scheme
vertical
evolve
horizon-
tal
fourier
modes
care
taken
order
ensure
various
derivatives
deﬁned
appropriate
grids
since
lax-wendroff
scheme
reasonably
efﬁcient
damping
waves
wavelengths
comparable
grid-
spacing
implemented
hyper-diffusivity
horizontal
directions
scales
like
horizontal
wavenumber
short
wavelength
modes
horizontal
directions
thus
damped
similar
way
occurs
vertical
without
signiﬁcantly
af-
fecting
modes
interested
comparison
exact
solutions
315
fig
scattered
pressure
perturbations
snapshot
vertical
ﬂux
tube
axis
radius
tube
bottom
panel
shows
exact
result
top
panel
numerical
result
simple
acoustic
wave
packet
propagating
direc-
tion
right
ˆxz
∂tξ
ˆxz
sin
c0k
cos
gaussian
envelope
cen-
tred
wavenumber
corresponding
angular
frequency
mhz
standard
deviation
mhz
wave
packet
centred
left
edge
computational
domain
−12
provide
examples
test
calculations
used
verify
code
tests
background
uniform
away
inhomogeneity
initial
condition
4.1
magnetic
pressure
perturbations
ﬁrst
test
reproduces
analytic
result
wilson
1980
gizon
2006
problem
fully
de-
www.an-journal.org
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
316
cameron
simulation
wave
propagation
inhomogeneous
magnetised
solar
atmosphere
fig
cut
scattered
pressure
per-
turbations
shown
figure
vertical
ﬂux
tube
dashed
line
shows
exact
solution
solid
line
numerical
units
incoming
pressure
perturbations
amplitude
scribed
brief
background
state
consists
cylin-
drical
ﬂux
tube
pressure
thermal
equilibrium
external
plasma
uniform
rest
density
10−7
g/cm3
sound
speed
105
cm/s
5/3
ﬂux
tube
radius
tests
uniform
properties
magnetic
ﬁeld
uniform
considered
different
ﬁeld
strengths
btube
relatively
weak
ﬂux
tube
evacuated
magnetic
ﬁeld
condition
pressure
equilibrium
imply
pressure
inside
tube
pin
pext
assumed
thermal
equilibrium
requires
tempera-
ture
inside
tube
equals
outside
tube
density
inside
tube
reduced
tube/
problem
thus
discontinuous
jump
across
ﬂux
tube
jump
important
obtaining
analytic
solution
somewhat
problematic
numerical
treat-
ment
fortunately
reason
expecting
dis-
continuity
singular
therefore
proceed
considering
discontinuity
limit
thin
boundary
layer
properties
tube
vary
speciﬁcally
assume
distance
tube
axis
consider
limit
practice
resolve
using
grid
points
increase
resolution
behaviour
con-
verges
case
choose
total
ﬂux
corresponds
tube
ﬁeld
strength
btube
completes
speciﬁcation
background
background
consider
plane
parallel
wave
test
cases
considered
assume
direction
propa-
gation
perpendicular
ﬂux
tube
prob-
lem
essentially
two-dimensional
since
use
different
btube
fig
scattered
pressure
perturbations
snapshot
horizontal
ﬂux
tube
axis
radius
tube
bottom
panel
shows
exact
result
top
panel
numerical
result
schemes
horizontal
vertical
directions
checked
code
using
vertical
horizontal
tubes
fig-
ures
show
comparison
scattered
pressure
perturbations
computed
analytically
numerically
vertical
ﬂux
tube
numerical
calculation
used
200
fourier
modes
directions
similar
results
found
horizontal
tube
see
fig
important
comment
resolution
200
pixels
direction
required
accurately
capture
wave
interaction
discontinuities
edge
tube
rather
tube
problems
without
discontinuities
expect
convergence
occur
even
lower
resolutions
also
worthwhile
show
results
lower
res-
olution
100
pixels
direction
three
points
resolving
boundary
layer
−r0
case
chosen
strong
magnetic
ﬁeld
strength
density
ﬂux-tube
reduced
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
www.an-journal.org
astron
nachr
2007
317
fig
cut
scattered
pressure
per-
turbations
shown
figure
vertical
ﬂux
tube
low
resolution
dashed
line
shows
exact
solution
solid
line
numerical
units
in-
coming
pressure
perturbations
amplitude
cylinder
embedded
stationary
uniform
media
assume
density
temperature
inside
outside
cylinder
deﬁning
property
velocity
assume
directed
along
axis
cylinder
analytic
solution
obtained
similar
manner
gizon
2006
important
property
solution
scat-
tered
wave
ﬁeld
vanishes
plane
parallel
wave
perpen-
dicular
cylinder
non-trivial
solutions
three-dimensional
therefore
chosen
compare
analytic
numerical
solutions
case
cylinder
direction
wave
propagation
make
45◦
an-
gle
additional
complication
analytic
solution
longer
corresponds
undisturbed
plane
wave
en-
countering
obstacle
rather
part
wave-front
pre-
viously
passed
cylinder
calculation
taken
wave
propagation
direction
cylinder
running
bot-
tom
left
top
right
x-z
plane
radius
cylinder
background
sound
speed
km/s
ﬂow
cylinder
km/s
sharp
jump
properties
inside
cylinder
outside
principle
use
different
resolu-
tions
check
convergence
solution
practice
used
grid
200
grid
points
modes
direction
similar
resolution
found
suitable
magnetic/pressure
perturbations
analytic
numerical
solutions
found
reasonable
agreement
shown
figures
unlike
results
shown
section
4.1
exact
agreement
case
expected
since
numerical
ana-
lytic
problems
signiﬁcantly
different
analytic
solu-
tion
snapshot
wave
always
affected
tube
contrast
numerical
solution
evolves
scattering
beginning
makes
two
fig
scattered
pressure
perturbations
snapshot
strong
vertical
ﬂux
tube
axis
bottom
panel
shows
exact
result
top
panel
nu-
merical
calculation
performed
lower
resolu-
tion
100
100
grid
points
points
across
tube
boundary
shows
type
artifacts
expected
using
low
resolution
results
shown
figures
mag-
netic
ﬁelds
strength
level
evacuation
presumably
important
calculations
wave
propaga-
tion
sunspots
given
resolution
agreement
numerical
analytic
results
reasonable
however
artifacts
near
poorly
resolved
boundary
layer
clearly
visible
4.2
background
velocity
ﬁeld
test
involves
several
terms
related
background
inhomogeneities
magnetic
ﬁeld
density
pressure
ﬁelds
obvious
remaining
class
perturbations
involve
velocity
ﬁeld
tested
code
comparing
analytic
solution
uniform
ﬂow
www.an-journal.org
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
318
cameron
simulation
wave
propagation
inhomogeneous
magnetised
solar
atmosphere
solutions
useful
test
two
problems
become
iden-
tical
limit
large
box
kept
increasing
size
box
analytic
numerical
solutions
would
presumably
converge
tests
smaller
boxes
cubes
indeed
showed
much
worse
match
analytic
numerical
results
agreement
achieving
even
boxes
reasonable
discussion
written
tested
code
studying
wave
prop-
agation
inhomogeneous
magnetised
solar
atmosphere
wide
range
possible
applications
code
including
understanding
observational
signature
wave
propagation
small-scale
magnetic
features
granulation
supergranulation
complex
magnetic
velocity
ﬁelds
associated
sunspots
penumbrae
tests
slim
code
far
successful
conﬁdence
code
use-
ful
tool
understand
signatures
wave
propagation
various
types
solar
features
references
birch
a.c.
felder
2004
apj
616
1261
bogdan
t.j.
hindman
b.w.
cally
p.s.
charbonneau
1996
apj
465
406
cally
bogdan
t.j.
1997
apj
486
l67
christensen-dalsgaard
2003
lecture
notes
stellar
oscilla-
tions
aarhus
universitet
duvall
t.l.
jefferies
s.m.
harvey
j.w.
pomerantz
m.a
1993
nature
362
430
fan
braun
d.c.
chou
d.-y
1995
apj
451
877
frigo
johnson
2005
special
issue
program
gen-
eration
optimization
platform
adaptation
proceedings
ieee
216
gizon
hanasoge
s.m.
birch
a.c.
2006
apj
643
549
jensen
j.m.
pijpers
f.p
2003
412
257
moffatt
h.k
1978
magnetic
ﬁeld
generation
electrically
con-
ducting
ﬂuid
cambridge
univ
press
cambridge
werne
birch
a.c.
julien
2004
proc
soho
esa
sp-559
172
wilson
p.r
1980
apj
237
1008
fig
scattered
pressure
perturbations
snapshot
km/s
ﬂow
within
cylinder
inclined
45◦
di-
rection
propagation
incoming
wave
ﬂow
aligned
axis
cylinder
directed
upwards
right
shown
x-z
plane
black
lines
indi-
cate
boundaries
cylinder
bottom
panel
shows
analytic
result
top
corresponds
numerical
so-
lution
initial
condition
numerical
analytic
treatments
different
analytic
treatment
consid-
ering
wave
permanent
contact
cylinder
top
panel
lower
left
hand
corner
least
contaminated
resulting
artefacts
note
periodic
nature
box
scattered
waves
appear
top
half
box
white
line
shows
cut
used
figure
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
www.an-journal.org
astron
nachr
2007
319
fig
cut
across
white
lines
shown
figure
solid
curve
shows
numerical
solution
dashed
curve
analytic
www.an-journal.org
cid:13
2007
wiley-vch
verlag
gmbh
co.
kgaa
weinheim
