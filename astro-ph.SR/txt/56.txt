astronomy
astrophysicsmanuscript
aa˙terzo˙reale˙xp
june
2018
cid:13
eso
2018
importance
background
subtraction
analysis
coronal
loops
observed
trace
s.terzo1
f.reale1,2
dipartimento
scienze
fisiche
astronomiche
universit
degli
studi
palermo
via
archiraﬁ
90123
palermo
italy
e-mail
terzo
astropa.unipa.it
inaf
osservatorio
astronomico
palermo
piazza
del
parlamento
90134
palermo
italy
e-mail
reale
astropa.unipa.it
received
15/10/2009
accepted
05/02/2010
abstract
aims
framework
trace
coronal
observations
compare
analysis
diagnostics
loop
subtracting
background
two
diﬀerent
independent
methods
methods.the
dataset
includes
sequences
images
171
195
ﬁlter
bands
trace
one
background
subtraction
method
consists
taking
background
values
obtained
interpolation
concentric
strips
around
analyzed
loop
method
pixel-to-pixel
subtraction
ﬁnal
image
loop
completely
faded
already
used
reale
ciaravella
2006.
results
compare
emission
distributions
along
loop
obtained
two
methods
ﬁnd
considerably
diﬀerent
ﬁnd
diﬀerences
well
related
derive
ﬁlter
ratio
temperature
proﬁles
particular
pixel-to-pixel
subtraction
leads
coherent
diagnostics
cooling
loop
subtraction
diagnostics
much
less
clear
conclusions
background
subtraction
delicate
issue
analysis
loop
pixel-to-pixel
subtraction
appears
reliable
application
always
possible
subtraction
interpolation
surrounding
regions
produce
higher
systematic
errors
intersecting
structures
large
amount
subtracted
emission
trace
observations
key
words
sun
corona
sun
x-rays
gamma
rays
method
data
analysis
introduction
important
issue
data
analysis
coronal
loops
observations
background
subtraction
recent
results
del
zanna
mason
2003
testa
2002
schmelz
2003
aschwanden
nightingale
2005
reale
ciaravella
2006
aschwanden
2008
established
impor-
tance
separating
actual
loop
plasma
diﬀuse
fore-
ground
background
emission
results
unresolved
coronal
structures
instrumental
eﬀects
need
back-
ground
subtraction
arises
presence
many
overlap-
ping
bright
structures
diﬀuse
emission
nearby
along
line
sight
well
stray
light
deforest
2009
accurate
extraction
emission
along
loop
necessary
apply
standard
diagnostic
methods
like
ﬁlters
ra-
tio
derive
physical
quantities
temperature
even
apply
detailed
loop
models
wherever
background
non-negligible
compared
loop
intensity
would
se-
riously
aﬀect
extracted
intensity
along
loop
standard
generally
accepted
method
background
sub-
traction
procedure
operator-sensitive
turn
results
issue
critical
especially
analysis
obser-
vations
background
signiﬁcant
fraction
signal
happens
instance
observation
made
trace
e.g.schmelz
2003
aschwanden
nightingale
2005
reale
ciaravella
2006
explore
depen-
dence
sensitivity
results
background
subtrac-
tion
method
comparing
two
methods
applied
loop
observed
trace
one
ﬁlter
band
take
advantage
unique
opportunity
apply
two
diﬀer-
ent
independent
methods
background
subtraction
dataset
one
methods
reale
ciaravella
2006
hereafter
rc06
objective
support
facts
use
background
image
loop
region
loop
absent
background
variations
estimated
small
throughout
observation
section
describe
data
analysis
background
subtraction
section
shows
compares
results
two
diﬀerent
background
subtractions
including
implications
temperature
diagnostics
ﬁlter
ratios
section
discuss
results
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
08:30:06
195
ﬁlter
ﬁlters
diﬀerent
sensi-
tivity
temperature
observed
plasma
observations
taken
time
diﬀerent
ﬁlters
provide
information
plasma
temperature
particular
ratio
emis-
sion
two
diﬀerent
ﬁlter
bands
compared
ratio
response
functions
ﬁlters
gives
temperature
emitting
plasma
since
ﬁlter
ratio
may
altered
diﬀuse
emission
signals
structures
co-
aligned
along
line
sight
stray
light
important
estimate
remove
background
emission
trace
observations
diﬀuse
emission
typically
high
might
represent
signal
2.1.
loopanalysis
analyze
loop
rc06
loop
selected
trace
images
fig.1
appears
entire
loop
several
171
ﬁlter
images
fig.2
clearly
visible
well
195
ﬁlter
band
fig.2
loop
bright
i.e
ob-
served
good
count
statistics
high
contrast
background
selected
far
possible
free
structures
intersecting
along
line
sight
loop
evolves
ﬁlterbands
171
band
faint
ini-
tially
brightens
reaching
peak
intensity
around
07:30
fades
disappears
end
sequence
10:00
rc06
195
band
loop
brightest
initially
progressively
fades
loop
evolution
even
clear
fig
shows
images
loop
region
normalized
ﬁnal
image
loop
longer
visible
revisit
data
four
selected
times
data
treated
standard
procedures
trace
data
processing
contained
solar
software
ssw
images
co-aligned
standard
cross-correlation
technique
2.2.
backgroundsubtraction
compare
method
already
adopted
rc06
alternative
indepedent
approach
based
in-
terpolation
emission
values
region
close
outside
loop
similar
testa
2002
aschwanden
nightingale
2005
schmelz
2003
aschwanden
2008.
ﬁrst
step
measure
emis-
sion
loop
deﬁne
strip
enclosing
loop
trace
ﬁlter
passband
visible
footpoints
even
beyond
divide
sectors
shown
fig.4
analyzed
strips
diﬀerent
widths
width
pixels
good
compromise
low
statistics
overcoming
much
loop
borders
choice
end
similar
almost
square
sectors
rc06
mark
two
strips
parallel
concentric
one
used
extract
loop
emission
one
outer
one
inner
imaginary
circle
loop
part
divide
two
additional
strips
sectors
aligned
central
strip
fig.4
two
strips
used
extract
emission
back-
ground
subtraction
put
close
possible
loop
interest
avoiding
structures
near
although
dis-
250
200
150
100
07:37:41.000
171
100
150
arcsec
200
250
fig
loop
region
observed
trace
256
×256
pixels
image
171
ﬁlter
labelled
time
lower
panel
loop
analysis
pointed
arrow
loop
region
located
inset
yohkoh/sxt
full
disk
im-
age
upper
panel
grey
scale
inverted
linear
trace
image
dn/s/pix
inverted
logarithmic
yohkoh
image
150
dn/s/pix
data
analysis
transition
region
coronal
explorer
trace
nasa
small
explorer
smex
mission
image
solar
corona
transition
region
high
angular
temporal
reso-
lution
operating
since
1998
handy
1999
analyze
trace
observation
may
1998
3.5h
time
sequence
1024
1024
pixels
full
resolution
image
two
trace
ﬁlters
171
195
data
set
selected
an-
alyzed
rc06
512×512
pixels
region
whole
ﬁeld
view
extracted
analysis
data
four
images
selected
ﬁlter
following
times
06:36:57
06:59:35
07:39:26
08:29:34
171
ﬁlter
06:37:18
07:00:06
07:39:47
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
time
06:36:57.000
time
06:59:35.000
time
07:39:26.000
time
08:29:34.000
600
600
500
500
600
600
500
500
600
600
500
500
600
600
500
500
400
400
300
300
200
200
600
600
500
500
200
200
300
300
pixels
400
400
500
500
600
600
time
06:37:18.000
400
400
300
300
200
200
600
600
500
500
200
200
300
300
pixels
400
400
500
500
600
600
time
07:00:06.000
400
400
300
300
200
200
600
600
500
500
200
200
300
300
pixels
400
400
500
500
600
600
time
07:39:47.000
400
400
300
300
200
200
600
600
500
500
200
200
300
300
pixels
400
400
500
500
600
600
time
08:30:06.000
400
400
300
300
200
200
400
400
300
300
200
200
400
400
300
300
200
200
400
400
300
300
200
200
200
200
300
300
pixels
400
400
500
500
600
600
200
200
300
300
pixels
400
400
500
500
600
600
200
200
300
300
pixels
400
400
500
500
600
600
200
200
300
300
pixels
400
400
500
500
600
600
fig
loop
region
top
row
171
bottom
row
195
subsequent
times
left
right
06:36:57.000
06:59:35.000
07:39:26.000
08:29:34.000
171
06:37:18.000
07:00:06.000
07:39:47.000
08:30:06.000
195
grey
scale
inverted
linear
0.4
s−1
pix−1
images
frame
top
right
image
part
shown
fig
tinct
analyzed
loop
strips
also
width
pixels
divided
sectors
one-to-
one
correspondence
sectors
sectors
patching
loop
sectors
two
external
strips
compute
mean
emission
value
per
pixel
sector
central
strip
assign
background
emission
value
linearly
interpolated
two
corresponding
sectors
external
strips
fig.4
sake
completeness
reﬁnement
considered
also
least-squares
quadratic
interpolation
considered
two
concentric
strips
around
analyzed
loop
one
outer
inner
however
additional
outer
strips
far
central
loop
end
include
bright
structures
severely
con-
taminate
procedure
locally
alter
otherwise
smooth
emission
distribution
therefore
case
higher
order
interpolation
lead
improvement
results
anyhow
point
basic
linear
interpolation
made
values
averaged
sector
therefore
already
intrinsically
accurate
linear
interpola-
tion
made
values
single
pixels
remind
method
background
subtraction
rc06
based
fact
loop
disappears
end
image
sequence
last
image
around
sub-
tracted
pixel-by-pixel
images
assuming
structures
surrounding
crossing
loop
interest
along
line
sight
change
much
observation
se-
quence
estimate
ﬂuctuations
background
observation
rc06
measured
average
pixel-by-
pixel
standard
deviation
171
195
ﬁlter
band
accurate
subtraction
would
obtained
sub-
tracted
image
resulted
interpolation
image
loop
switches
one
loop
switches
unfortunately
loop
long
lifetime
order
ﬁnd
images
loop
ignition
back
earlier
start
time
analysis
opin-
ion
time
long
pretend
environment
change
meantime
reliable
background
prefer
keep
ﬁnal
image
image
subtrac-
tion
also
point
image
subtract
taken
10:00
signiﬁcantly
apart
time
analyzed
images
taken
06:30
08:30
perspective
i.e
view-
ing
angle
observed
loop
changing
in-
terval
may
impact
rc06
scheme
assumes
line
sight
intersects
column
plasma
throughout
entire
sequence
however
expect
signiﬁcant
eﬀect
since
estimate
change
viewing
angle
order
less
conﬁrmed
visual
inspection
images
subtraction
two
methods
background
sub-
traction
schmelz
2007
schmelz
2003
used
two
lower-order
methods
background
subtraction
con-
stant
background
subtraction
pixel
pair
background
sub-
traction
former
method
subtract
constant
value
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
time
06:36:57.000
time
06:59:35.000
time
07:39:26.000
time
08:29:34.000
400
400
350
350
400
400
350
350
400
400
350
350
400
400
350
350
300
300
250
250
200
200
400
400
350
350
300
300
250
250
200
200
300
300
250
250
200
200
300
300
250
250
200
200
150
150
200
200
pixels
250
250
300
300
350
350
150
150
200
200
pixels
250
250
300
300
350
350
150
150
200
200
pixels
250
250
300
300
350
350
150
150
200
200
pixels
250
250
300
300
350
350
time
06:37:18.000
time
07:00:06.000
time
07:39:47.000
time
08:30:06.000
400
400
350
350
400
400
350
350
400
400
350
350
300
300
250
250
200
200
300
300
250
250
200
200
300
300
250
250
200
200
300
300
250
250
200
200
150
150
200
200
pixels
250
250
300
300
350
350
150
150
200
200
pixels
250
250
300
300
350
350
150
150
200
200
pixels
250
250
300
300
350
350
150
150
200
200
pixels
250
250
300
300
350
350
fig
zooms
loop
region
fig
frame
top
right
image
fig
images
top
row
171
bottom
row
195
normalized
ﬁnal
image
sequence
10:00
loop
longer
visible
enhance
loop
evolution
grey
scale
linear
0.4
2.5
means
emission
value
ﬁnal
image
extracted
single
background
pixel
chosen
loop
apex
latter
selected
background
pixel
loop
pixel
results
3.1.
loopemission
fig.5
show
examples
application
interpola-
tion
method
background
subtraction
lines
join
data
points
obtained
mean
values
pixel
emission
sec-
tor
error
mean
value
estimated
standard
deviation
mean
sector
error
conser-
vatively
rounded
0.05.
lower
panels
fig.5
show
results
subtraction
values
interpolating
dotted
dashed
curves
solid
curve
loop
emission
signiﬁcantly
lowered
back-
ground
subtraction
points
even
completely
cancelled
due
overlap
bright
structure
close
dis-
antangled
loop
direct
comparison
rc06
background
subtraction
methods
plot
emis-
sion
along
loop
obtained
two
methods
ﬁgure
fig.7
shows
results
171
ﬁlter
195
ﬁlter
see
emission
signiﬁcantly
dif-
ferent
background
subtraction
two
methods
proﬁles
mostly
diﬀer
central
part
predicted
faint
time
background
subtraction
interpolation
method
contrary
latter
method
footpoints
found
mostly
brighter
pixel-to-pixel
subtraction
although
see
agreement
times
e.g
right
end
06:36
07:00
ﬁlters
result
regarding
footpoints
may
de-
bated
since
footpoint
regions
clearly
resolved
original
data
fig.2
doubt
bulk
loop
clearly
visible
many
times
fig.2
fig.3
therefore
emission
low
contrast
interpolation
method
agreement
pixel-to-pixel
method
therefore
case
two
methods
diﬀer
rc06
pixel-to-pixel
method
surely
provides
re-
liable
result
agreement
proﬁles
latest
time
moreover
notice
fig.7
since
subtracted
emission
obtained
interpolation
method
invariably
low
except
near
loop
footpoints
show
clear
evolution
instead
rc06
obtain
background-subtracted
central
section
loop
evolution
agreement
evolution
observed
images
fig.2
fig.3
therefore
results
obtained
method
rc06
appear
reliable
3.2.
temperaturediagnostics
assess
diﬀerences
background
sub-
traction
methods
explored
temperature
diagnostics
obtained
ﬁlter
ratio
well-known
optically
thin
plasma
isothermal
along
line
sight
ratio
emission
detected
two
diﬀerent
ﬁlters
function
temperature
e.g
rosner
1978
ratio
value
measured
image
pixel
derive
temperature
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
ture
along
loop
background
subtraction
exam-
ple
fig.8
shows
ﬁlter
ratio
195/171
corresponding
tem-
perature
along
loop
07:40
computed
back-
ground
subtraction
pixel-to-pixel
method
also
shown
rc06
interpolation
method
immediately
apparent
ratio
proﬁle
obtained
latter
method
much
irregular
deﬁne
overall
trend
method
instead
leads
regular
proﬁle
co-
herent
clear
visibility
loop
ﬁlter
ratio
map
rc06
spite
dip
left
leg
due
another
cross-
ing
bright
structure
ﬁnd
similar
trends
corresponding
temperature
proﬁles
along
loop
point
although
proﬁles
indicate
overall
small
temperature
variation
along
loop
pixel-
to-pixel
background
makes
diﬀerence
identifying
identifying
trend
globally
ﬂat
temperature
proﬁle
typical
result
trace
data
e.g
lenz
1999
explained
partly
instrumental
bias
weber
2005
however
rc06
pointed
ﬁlter
ratio
diagnos-
tics
anyhow
meaningful
sensitive
enough
de-
tect
loop
progressive
cooling
fig
shows
loop
average
ﬁlter
ratio
obtained
two
diﬀerent
background
subtrac-
tions
four
diﬀerent
times
evolution
obtained
interpolation
method
much
less
clear
loop
cooling
conﬁrming
sensitivity
temperature
di-
agnostics
higher
pixel-to-pixel
background
subtrac-
tion
inner
strip
central
strip
outer
strip
background
discussion
coordinate
across
loop
pixels
fig
background
subtraction
interpolation
method
upper
panel
strips
loop
analysis
central
background
subtraction
outer
inner
marked
loop
region
07:39:26.000
171
ﬁlter
lower
panel
emission
proﬁle
thin
solid
line
measured
cut
across
loop
marked
upper
panel
compute
average
emission
thick
horizontal
lines
corresponding
sectors
intersected
outer
inner
strips
bounded
vertical
dashed
lines
background
value
central
horizontal
line
computed
linear
interpolation
average
emission
val-
ues
outer
strips
subtracted
total
emission
measured
central
strip
upper
solid
line
value
pixel
build
therefore
proper
thermal
map
case
narrow
band
171
195
ﬁlters
trace
relationship
temperature
ﬁlter
ratio
195/171
monotonic
certain
temperature
range
i.e
0.7
1.8
e.g
aschwanden
2000
also
range
ﬁlters
responses
highest
reasonable
assume
detected
plasma
temperature
range
allows
measure
tempera-
background
subtraction
important
analysis
trace
coronal
loops
background
signal
high
inﬂuenced
presence
many
bright
structures
near
perhaps
entangled
analyzed
loop
along
line
sight
recent
results
del
zanna
mason
2003
testa
2002
schmelz
2003
aschwanden
nightingale
2005
reale
ciaravella
2006
aschwanden
2008
estab-
lished
importance
separating
actual
loop
plasma
diﬀuse
foreground
background
emission
re-
sults
unresolved
coronal
structures
instrumental
ef-
fects
stray
light
catch
unique
opportunity
compare
two
diﬀerent
independent
methods
background
subtraction
one
subtracts
interpolated
emission
two
oﬀ-loop
strips
subtracts
pixel-by-pixel
complete
image
disappearance
loop
rc06
extracting
background
emission
two
strips
near
possible
loop
interest
certainly
consider
re-
move
emission
structures
intersect
transversally
loop
true
long
contaminating
loops
run
across
target
loop
case
happens
oblique
angle
shown
diﬀerent
methods
lead
diﬀerent
emission
proﬁles
also
subsequent
diag-
nostics
aﬀected
pixel-by-pixel
subtraction
able
derive
quite
coherent
ﬁlter
ratio
proﬁles
along
loop
quite
coherent
temperature
evolution
loop
globally
cooling
expected
sequence
appear-
ance/disappearance
diﬀerent
trace
ﬁlters
infor-
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
time
06:59:35.000
sector
number
sector
number
time
07:39:26.000
sector
number
sector
number
fig
emission
along
loop
171
ﬁlter
06:59:35.000
left
column
07:39:26.000
right
column
upper
panels
emission
along
loop
strip
solid
line
outer
strip
dotted
line
inner
strip
dashed
line
lower
panels
emission
background
subtraction
interpolation
method
time
07:00:06.000
sector
number
sector
number
time
07:39:47.000
sector
number
sector
number
fig
fig.5
195
ﬁlter
07:00:06.000
left
column
07:39:47.000
right
column
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
time
06:36:57.000
sector
number
time
06:59:35.000
sector
number
time
07:39:26.000
sector
number
time
08:29:34.000
sector
number
time
06:37:18.000
sector
number
time
07:00:06.000
sector
number
time
07:39:47.000
sector
number
time
08:30:06.000
sector
number
fig
emission
along
loop
labelled
times
171
ﬁlter
left
column
195
ﬁlter
right
column
panels
show
emission
along
loop
background
subtraction
two
diﬀerent
methods
pixel-by-pixel
method
rc06
dashed
line
interpolation
method
solid
line
mation
much
less
clear
using
method
back-
ground
subtraction
rc06
background
subtraction
looks
therefore
reliable
method
principle
accurate
loop
in-
terest
variable
structure
ﬁeld
observation
direct
variance
interpolation
method
applied
pixel-by-pixel
allowing
derive
background-subtracted
images
therefore
visual
feedback
ana-
lyze
loop
pixels
instead
sampling
selected
posi-
tions
hand
method
works
well
long
structures
surrounding
crossing
loop
interest
along
line
sight
change
much
observation
words
rc06
method
take
time-variations
background
emission
account
exclude
crossing
structures
vary
observation
also
re-
mark
pixel-by-pixel
subtraction
could
applied
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
time
07:39:47.000
1.5
1.0
0.5
0.0
1.4•106
1.2•106
1.0•106
8.0•105
6.0•105
4.0•105
2.0•105
time
since
06:31:36.000
fig
evolution
loop
average
195/171
ﬁlter
ratio
sam-
pled
four
times
analyzed
work
obtained
diﬀerent
background
subtractions
pixel-to-pixel
stars
interpolation
triangles
ing
way
structures
cross
loop
interest
alter
signiﬁcantly
loop
emission
conclusion
work
conﬁrms
qualiﬁes
re-
liable
background
subtraction
delicate
diﬃcult
task
analysis
coronal
loops
observed
trace
problem
course
greatly
reduced
observations
diﬀerent
instruments
amount
instrumental
back-
ground
emission
lower
therefore
presence
systematic
eﬀects
less
inﬂuence
acknowledgements
thank
anonymous
referee
construc-
tive
suggestions
acknowledge
support
italian
ministero
dell
universit
ricerca
agenzia
spaziale
italiana
asi
con-
tract
i/023/09/0
references
aschwanden
nightingale
2005
apj
633
499
aschwanden
nitta
wuelser
j.-p.
lemen
2008
apj
680
1477
aschwanden
tarbell
nightingale
2000
apj
535
1047
deforest
martens
wills-davey
2009
apj
690
1264
del
zanna
mason
2003
406
1089
handy
acton
kankelborg
1999
sol
phys.
187
229
lenz
deluca
golub
1999
sol
phys.
190
131
reale
ciaravella
2006
449
1177
rosner
tucker
vaiana
1978
apj
220
643
schmelz
beene
nasraoui
2003
apj
599
604
position
fig
filter
ratio
195/171
top
corresponding
tempera-
ture
bottom
along
loop
07:40
computed
diﬀerent
background
subtractions
pixel-to-pixel
dashed
interpolation
solid
arrow
upper
limit
among
inter-
polation
data
loop
disappears
end
image
sequence
condition
matched
evolving
loops
loops
keeping
steady
entire
observation
meth-
ods
must
used
interpolation
out-loop
emission
often
used
testa
2002
aschwanden
nightingale
2005
schmelz
2003
aschwanden
2008
according
analysis
may
lead
severe
systematic
er-
rors
may
aﬀected
structures
close
distinct
loop
analysis
fig
points
diﬃculties
encountered
interpo-
lation
method
since
shows
relatively
close
target
loop
another
structure
similar
intensity
although
interpolation
method
provide
good
estimate
background
around
two
loops
able
take
over-
lap
two
loops
full
proper
account
scheme
ﬁts
two
loops
separately
together
background
estimated
may
represent
better
solution
methods
background
subtraction
instead
operator-sensitive
based
upon
meticu-
lous
selection
single
background
pixels
intentionally
avoid-
s.terzo
f.reale
importance
background
subtraction
analysis
coronal
loops
observed
trace
schmelz
roames
nasraoui
2007
advances
space
research
1497
testa
peres
reale
orlando
2002
apj
580
1159
weber
schmelz
deluca
roames
2005
apj
635
l101
