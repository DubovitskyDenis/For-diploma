1/23researchonthebackgroundcorrectionmethodinx-rayphasecontrastimagingwithtalbot-lauinterferometer0f⃰wangsheng-hao
王圣浩
zhangcan
margiep.olbinado2
atsushimomose2
gaokun
wangzhi-li
王志立
huren-fang
胡仁芳
hanhua-jie
韩华杰
yangmeng
zhangkai
zhupei-ping
朱佩平
3andwuzi-yu
吴自玉
1,3
1f‡1nationalsynchrotronradiationlaboratory
universityofscienceandtechnologyofchina
hefei230027
china.2instituteofmultidisciplinaryresearchforadvancedmaterials
tohokuuniversity,2-1-1katahira
aoba-ku
sendai
miyagi980-8577
japan.3instituteofhighenergyphysics
chineseacademyofsciences
beijing100049
china.abstract
x-raytalbot-lauinterferometerhasbeenusedwidelytoconductphasecontrastimagingwithaconventionallow-brilliancex-raysource.typically
inthistechnique
backgroundcorrectionhastobeperformedinordertoobtainthepuresignalofthesampleunderinspection.inthisstudy
wereportedonaresearchonthebackgroundcorrectionstrategieswithinthistechnique
especiallyweintroducedanewphaseunwrappingsolutionforoneconventionalbackgroundcorrectionmethod
thekeypointofthissolutionischangingtheinitialphaseofeachpixelbyanovelcyclicshiftoperationontherawimagescollectedinphasesteppingscan.experimentalresultandnumericalanalysisshowedthatthenewphaseunwrappingalgorithmcouldsuccessfullysubtractcontributionofthesystem
sbackgroundwithouterror.moreover
apotentialadvantageofthisphaseunwrappingstrategyisthatitseffectivephasemeasuringrangecouldbetunedflexiblyinsomedegreeforexampletobe
-π+3
π+3
thusitwouldfindusageincertaincasebecausetheeffectivemeasuringrangeofthecurrentlywidelyusedbackgroundcorrectionmethodisfixedtobe
.keywords
x-rayimaging
phase-contrast
talbot-lauinterferometer
backgroundcorrection
cyclicshift
phasewrapping
phaseunwrapping.pacs:87.59.-e,07.60.ly,42.30.rx⃰supportedbythemajorstatebasicresearchdevelopmentprogramofchina
grantno.2012cb825800
thesciencefundforcreativeresearchgroups
china
grantno.11321503
thenationalnaturalsciencefoundationofchina
grantnos.11205189,11475170
and11205157
andthejapan-asiayouthexchangeprograminscience
sakuraexchangeprograminscience
administeredbythejapanscienceandtechnologyagency.‡email
wuzy
ustc.edu.cn
2/231.introductionx-rayphase-contrastimaging
whichusesphaseshiftastheimagingsignal
canprovideremarkablyimprovedcontrastoverconventionalabsorption-basedimagingforweaklyabsorbingsamples
suchasbiologicalsofttissuesandfibrecomposites.
1-3
inthelast50years
severalx-rayphase-contrastimagingmethodshavebeenputforward
4-13
howevernoneofthemhassofarfoundwideapplicationsinmedicalorindustrialareas
wheretypicallytheuseofalaboratoryx-raysourceishighlyrequired.thedemonstrationofatalbot-lauinterferometerinthehardx-rayregionwithaconventionallow-brilliancex-raysourcecanbeconsideredasabreakthroughinx-rayphase-contrastimaging
14-16
becauseitshowedthatphase-contrastx-rayimagingcanbesuccessfullyconductedwithalow-brilliancex-raytube
thusovercomingtheproblemsthatimpairedawideruseofphase-contrastinx-rayradiographyandtomography
andmanypotentialapplicationsofthistechniqueinbiomedicalimaginghavebeenstudied.
17-21
duringx-rayphasecontrastimagingwithtalbot-lauinterferometer
typicallyabackgroundcorrectionprocesshastobeperformed
inthehopeofobtainingthepurephasesignalofthesample
13,22
thereforeintheexperiment
usuallyonephasesteppingscaniscarriedoutwithsample
whileanotherscanneedstobeperformedwithoutsampleinthebeampath
andtheninthedatapostprocessing
basedonthesetwosetsofrawdata
twobackgroundcorrectionmethodswrittenrespectivelyasformulae
1.1
1.2
areusuallyusedtoretrievetherefractionimageofthesample.-110-110
exp
arg2z
exp
mskkmbtkkkidmkim
1.1
-1-11100
arg
exp
arg
exp
2zmmsbkkkktdkkiimm
1.2
whereztisthedistancebetweengratingsg1andg2
whenthesampleisplaced
3/23betweengratingsg0andg1
dstandsfortheperiodofthegratingg2.1x
yskiand1x
ybkirepresentthegrayvaluesofthepixelx
yatthe
thkstepofthephasesteppingscanwithandwithoutsample
respectively.misthenumberofstepsduringthescaninoneperiodofgratingg2.inthefollowing
wenameformula
1.1
asmethodarg
s/b
andformula
1.2
asmethodarg
-arg
.thesetwomethodslookequivalentinmathematics
howevertherearesomedifferencesbetweenthemwhenperformingbackgroundcorrectioninphasecontrastimagingwithanx-raytalbot-lauinterferometer.theeffectivephasemeasuringrangeofmethodarg
-arg
-2π,2π
butphasewrappingphenomenonsometimestakesplaceevenwhenthephaseshiftintroducedbythesampleisverysmall
thisisthereasonwhymethodarg
s/b
getsusedmorewidelyinthecommunitythanmethodarg
-arg
.howevertheeffectivephasemeasuringrangeofmethodarg
s/b
isfixedtobe
theexpectedphasewouldbewrappedifitexceedsthisrange
andcomplicatedphaseunwrappingalgorithmhastobecarriedoutinordertogettherealphasevalue.
23-27
combiningadvantagesofthesetwomethodsinsomedegreeandmeanwhileavoidingweaknessesofthemwouldthusbeinterestingandmeaningful.thefollowingsectionswillbearrangedlikethis
firstlywewilldisplaylayoutofthex-raytalbot-lauinterferometerandacquisitionoftherawdata
andthencomparisonismadebetweenmethodsarg
-arg
andarg
s/b
whendealingwithasetofdata.afterthatweanalyzetheoriginofphasewrappinginmethodarg
-arg
andprovideaconventionalphaseunwrappingsolution.thenthetheoryofcircleshiftoperationontherawimagesisdemonstrated
basedonwhichwewillintroducethenewphaseunwrappingstrategy
performanceofthenewphasewrappingsolutiontogetherwiththeconventionalonewouldthenbeevaluatedincomparisonwithmethodsarg
-arg
andarg
s/b
.finally
potentialadvantageofthenewphaseunwrappingsolutionwouldbediscussedandtwoidenticalbutmoreconvenientimplementationmeansofthenewsolutioninpcwillbeprovided
4/232.materialsandmethods2.1experimentalsetupthex-rayphase-contrastimagingwascarriedoutwithatalbot-lauinterferometerlocatedattheinstituteofmultidisciplinaryresearchforadvancedmaterials
tohokuuniversity
japan.fig.1istheschematicofthisx-rayinterferometer
itismainlymadeupofanx-raytube
threemicro-structuredgratings
andanx-raydetector
whichareassembledonmulti-dimensionalmotorizedstages.thex-rayisgeneratedfromatungstenrotatinganodex-raysource.thesourcegratingg0
period22.7μm
auheight70μm
ispositionedabout8cmfromtheemissionpointinsidethex-raysource
thebeamsplittergratingg1
period4.36μm
auheight2.43μm
whichinducedaphaseshiftof/2approximatelyat27kev
situates106.9cmfromg0behindthegantryaxis
andthesampleismountedcloselybeforeg1.theanalyzergratingg2
period5.4μm
auheight65μm
ispositionedat~10mmbeforethedetectorwhilethedistancebetweeng1andg2is25.6cm
correspondingtothefirstorderintegertalbotdistanceofgratingg1.thex-raydetectorisacombinationofascintillatorandaccdcameraconnectedviaafibercouplingchargecoupleddevice
itspixelsizeis18×18um2andtheeffectivereceivingareais6.84×6.84cm2.figure1
coloronline
.schematicofx-raytalbot-lauinterferometer.1.x-raysource,2.sourcegrating
,3.sample,4.beamsplittergrating
,5.analyzergrating
,6.x-raydetector.asillustratedinfig.1
thedifferentialphase-contrastimageinformationprocess
5/23essentiallyreliesonthefactthatthesampleplacedinthex-raybeampathcausesslightrefractionofthebeamtransmittedthroughtheobject
andtheideaofdifferentialphase-contrastimagingdependsonlocallydetectingtheangulardeviation.typically
therefractionanglecanbemeasuredbycombiningthemoirefringeandphase-steppingtechnique.
28,29
muchdetailedtheoreticalbasisofx-rayphase-contrastimagingusinggratinginterferometercanbereferredathere
12-14,30
2.2imageacquisitionthesampleweusedisapomcylinder
itsdiameteris10mmandthelengthisabout90mm
apmmacylinder
itsdiameteris5mmanditslengthisabout100mm
andapomcylinder
itsdiameteris5mmandlengthisabout80mm
.duringtheexperiment
thex-raygeneratorwasoperatedwithatubecurrentof45maandatubeacceleratingvoltageof40kv.afterfinelyaligningthethreegratingsandthesamplestage,5stepsinoneperiodofgratingg2wereadoptedforthephasesteppingscan
andforeachstep,20swastakentocapturearawimage
thenasamephasesteppingscanwasperformedafterremovingthesample.eachpositionofgratingg2inthescanwithoutsamplewaskeptthesameasthecorrespondingoneinthescanwithsampleinthebeampathbyusingstageofhighpositioningprecision.3.retrievaloftherefractionsignalindatapostprocessing3.1backgroundcorrectionusingmethodsarg
s/b
andarg
-arg
figure2.rawimagesofthetwoscans.s①
s⑤arethedatawithsampleand
6/23b①
b⑤standforthatwithoutsampleinthebeampath.intheimageswithsample
toptobottom-pomcylinder
=10mm
pmmacylinder
=5mm
andpomcylinder
=5mm
.alltheimagesarewindowedforoptimizedappearancewithalineargrayscale.fig.2demonstratesrawimagesofthetwophasesteppingscans.figs.2
and2
arethe5rawimageswithsample
whilefigs.2
and2
standforthosewithoutsample
background
inthebeampath.hereweliketopointoutthatthelightintensityisnotuniforminthefieldofviewofallthe5backgroundimagesbecauseoftheunidealmoirefringes
asamatteroffact
itisalwaysalmostimpossibletoobtainaflatbackgroundwithanx-raytalbot-lauinterferometerbecauseimperfectionsexistinthex-raygratingsandthealignmentofgratingsisnotideal.figure3.x-rayrefractionimagesofthesample.thedatawascomputedwith
methodarg
-arg
methodarg
s/b
aretheenlargedviewoftheredrectangularchosenin
respectively.alltheimagesarewindowedforoptimizedappearancewithalineargrayscale.weusedmethodsarg
-arg
andarg
s/b
separatelytocomputethepure
7/23refractionimageofthesample.fig.3
depictstherefractionsignalyieldedbymethodarg
-arg
whilefig.3
showsthatbymethodarg
s/b
.figs.3
and3
representtheenlargedviewoftheredrectangularextractedfromthesamepositionasshowninfigs.3
and3
respectively.itwasobservedveryclearthatgreatdifferencesexistbetweenthetworefractionimages
forexample
infig.3
thegrayvaluesofthepixelsp1ands1areobviouslydifferentfromthoseofthecorrespondingpixels
p2ands2
infig.3
.here
accordingtoouraforehandknowledgeaboutthefeatureofthesample
judgmentcanbemadethatacorrectrefractionimagewasobtainedbymethodarg
s/b
andonthecontrary
therefractionanglesinmanypartsoftheimageretrievedbymethodarg
-arg
arewrong.3.2theoriginoferrorintherefractionimageretrievedbymethodarg
-arg
inthehopeoffiguringouttheoriginoferrorintherefractionimageyieldedbymethodarg
-arg
wetracedthecomputationalprocessoftherefractionangleatpixelp1asshowninfig.3
andatthecorrespondingpixelp2infig.3
whicharewrittenrespectivelyasfollows
44p11100arg
exp
arg
exp
2z55
arg
-3629.9+66.9497
arg
-3899.72-499.816
3.12315
3.01412
6.13727.2zsbkkkkttttdkkiiddd
1.3
4102410
exp
5arg2z
exp
5-3629.9+66.9497
arg2z-3899.72-499.816
arg0.9136040.134262
i2z
0.145914
2zskkpbtkktttkidkiddd.
1.4
8/23similarly
weshowthesourceofdataatpixels1infig.3
andatthecorrespondingpixels2infig.3
respectivelyasfollows
4411100arg
exp
arg
exp
2z55
arg
-4044.07-252.068
arg
-4411.39+80.1258
3.079343.123432z
6.20277
.2zsbskkkkttttdkkiiddd
1.5
4102410
exp
5arg2z
exp
5-4044.07-252.068
arg2z-4411.39+80.1258
arg0.9153930.0737667
i2z
=0.080411.2zskksbtkktttkidkiddd
1.6
thecomparisonsbetweenformulae
1.3
1.4
betweenformulae
1.5
1.6
wellconfirmthedifferencesbetweentherefractionimagesretrievedbymethodsarg
-arg
andarg
s/b
.thevaluesofpixelsp1ands1infig.3
are6.137272ztdand
6.20277
2ztd
rememberthatthefunctionrangeofarg
-arg
-2π,2π
thisisthereasonwhyasshowningrayvalueimagefig.3
pixelp1featuresultra-whiteandpixels1displaysultra-black.andaccordingtoouraforementionedjudgment
therefractionangleatpixelsp1ands1computedbyformulae
1.3
1.5
arewrong.avividexplanationontheoriginoferrorintherefractionimagecomputedbymethodarg
-arg
canbeshowninfig.4
thebluesinusoidcurveinfig.4
standsfortheshiftcurveofonecertainpixelinthedetectorwithoutsample
andtheblackonerepresentsthatwithsampleinthebeampath
thelateralshiftofthecurveiscausedbythedeflectionofthebeamwhenpassingthroughthesample
whichisthe
9/23fundamentalprincipleofrefractionsignalretrievalinx-rayphasecontrastimagingwithtalbot-lauinterferometer.heretheabsorptionandscatteringeffectsofthesamplewereignoredwhengeneratingthecurve.thebluesawtoothcurveinfig.4
isthephaseofthepixel
possessingaone-to-onerelationshipwiththebluesinusoidcurveinfig.4
inthisway
foronepixel
forexamplethe1ststepofthephasesteppingscanwithoutsampleislocatedatpointaintheshiftcurve
andthe2nd,3rd,4th,5thstepsaresuccessivelyequallyspacedbyd/5totherightofpointainthecurve
disperiodoftheanalyzinggrating
thentheretrievedphaseofthispixelwouldbetheordinatevalueofpointbinthesawtoothcurveasshowninfig4
byformulawrittenas
10/23figure4.
coloronline
.thesourceoferrorintherefractionimageyieldedbymethodarg
-arg
.410arg
exp
5kkki.
1.7
where1kirepresentsgrayvalueofthispixelatthe
thkstepofthephasesteppingscan.hereweassumethephaseofthispixelwithoutsample
arg
isπ-0.1π
andaftermovingthesampleinsidethebeampath
wemakethehypothesisthattheshiftcurveofthispixelislateralshiftedlessthanaperiodtobeasshowntheblacksinusoidcurveinfig.4
.becauseeachpositionofgratingg2inthescanwithsamplewaskeptthesameasthecorrespondingoneinthescanwithoutsampleinthebeampath
the1ststepofthepixelwithsamplewouldbelocatedatpointcintheblackshiftcurve
obviouslythephaseofpointcintheblackcurveequalstothatofpointdintheblueshiftcurve.andbasedontheaforementionedone-to-onerelationship
thephaseofthispixelwithsampleistheordinatevalueofpointeasshowninfig.4
herethephase
arg
isassumedtobe–π+0.3π.thenthepurephaseofthesampleatthispixelcomputedbymethodarg
-arg
wouldbe
arg
arg
-+0.3
0.1
-2+0.4
1.8
clearly
thismeasuredphaseiswrongbecauseofthediscontinuousnatureofthesawtoothcurveasshowninfig4
seethejumpingedgebetweenpointsbande
.thistypeoferrorcanalsobenamedasphasewrappingeffectbecausetherealphaseis
=+2
1.9
whereisthemeasuredphase
errorinpixels1canbeclassifiedintothiscase
whileforpixelp1
theequationis
11/23=2
1.10
3.3typicalphaseunwrappingalgorithmformethodarg
-arg
tofixtheerrorinmethodarg
-arg
atypicalphaseunwrappingsolutionbasedontheabovediscussioncanbewrittenas
arg
arg
modulo
22ztd
1.11
arg
arg
modulo
2operationcanberewrittenintheform
arg
arg
modulo
2=arg
arg
2k.
1.12
wherekandforces
arg
arg
2k.
1.13
usingthisphaseunwrappingalgorithm
correctrefractionsignalsinpixelsp1ands1canbeobtainedas
*p1p26.13727modulo2
0.145915
2z2zttdd
1.14
*126.20277modulo20.08041532z2zssttdd
1.15
therefractionimageoftheaboveexperimentaldatayieldedbythisphaseunwrappingalgorithmtogetherwiththenumericalcomparisonwouldbeprovidedlaterinsection4.3.4anewphaseunwrappingsolutionformethodarg
-arg
4.1strategyofcyclicshiftoperationontherawimagesournewphaseunwrappingsolutionisbasedonanovelcyclicshiftoperationontherawimages
asshowninfig.5
thebluesinusoidcurveinfig.5
andthebluesawtoothcurveinfig.5
sharethesameone-to-onerelationshipasthatinfig.4.nowwesupposeforonepixelthephasesteppingscanwasperformedwithoutsampleinthebeampathwhentheanalyzinggratingsituatessuccessivelyatpositions①②③
12/23④⑤intheshiftcurve
these5positionsareequallyspacebyd/5
distheperiodoftheanalyzinggrating
.thenifweinputtheimagesequenceof①②③④⑤intoformula
1.7
asdescribedaforementioned
theretrievedphaseofthispixelwouldbeindicatedasshowninfig.5
theordinatevalueofpointt1.nowletuscyclicallyshifttheorderoftheimagesfrom①②③④⑤to⑤①②③④andcalculateagainthephaseusingformula
1.7
.clearlythenewphaseisidenticaltothatoftheimageorderof⑤1①②③④asshowninfig.5
hereposition⑤1and⑤sharethesamefeatureinthesinusoidcurve
andthephaseoftheimagesequenceof⑤1①②③④istheordinatevalueofpointt2.similarly
thephasesoftheimagesequencesof④⑤①②③
③④⑤①②and②③④⑤①equalrespectivelytotheseoftheimagesequencesof④1⑤1①②③
③1④1⑤1①②and②1③1④1⑤1①
thecorrespondingphasesaretheordinatevaluesofpointst3
t4andt5asdemonstratedinfig.5
.figure5.
coloronline
.schematicofthetheoryofcyclicshiftoperationontherawimages
13/23inthecasedemonstratedinfig.5
thepixel
sphasewithoutsampleinthebeampathofthefiveimagesequencescanbewrittenas:0101101110
background
background
background
background
background
background
background
background
=argargargargargargargargar①②③④⑤⑤①②③④⑤①②③④④⑤①②③④⑤①②③③④⑤①②③④⑤①②②③④⑤①111102
background
=.5g②③④⑤①
1.16
nowaftermovingthesampleinsidethebeampath
weassumethephaseshiftintroducedbythesample2ztdissotiny
forexample-0.001radian
thatthecontributionofthephaseshiftintroducedbythesamplewouldnotpassoverthejumpingedgeatpointst1
t4andt5
thenthephasesofthepixelwithsampleinfiveimageorderscanbeexpressedas:01011011102
sample
sample
sample
524
sample
sample
524
sample
sample
sample
sattttargdargargdargargdargargdargarg①②③④⑤⑤①②③④⑤①②③④④⑤①②③④⑤①②③③④⑤①②③④⑤①②②③④⑤①1111022mple
=z.5td②③④⑤①
1.17
thanafterbackgroundcorrectionusingmethodarg
-arg
wecanget:2
sample
background
sample
background
sample
background
sample
background
sample
-ttttargargdargargdargargdargargdargarg①②③④⑤①②③④⑤⑤①②③④⑤①②③④④⑤①②③④⑤①②③③④⑤①②③④⑤①②②③④⑤①2
background
=z.td②③④⑤①
1.18
formula
1.18
showsthatundertheassumptionthatthephaseshiftintroducedbythesampleisverytiny
iftheimagesequenceoftherawdatawithsampleiskept
14/23thesameasthatofthedatawithoutsampleinthebeampath
theretrievedphaseofthepixelbymethodarg
-arg
wouldbeequal.fig.6demonstratesthecomputationalprocessusingmethodarg
-arg
infiveimagesequencesoftheaforementionedexperimentaldata
figs.6
and6
showsuccessivelythephaseimagewithsample
thephaseimagewithoutsampleandthepurephaseimageofthesamplewhentheimageorderis①②③④⑤.similarly
figs.6
figs.6
figs.6
andfigs.6
representrespectivelythosewhentheimagesequenceare⑤①②③④
④⑤①②③
③④⑤①②and②③④⑤①.figure6.a1
b1andc1showthecomputationalprocessofarg
-arg
whentheimagesequenceis①②③④⑤
phaseimagewithsample
phaseimagewithoutsample
purephaseimageofthesample.a2/b2/c2
a3/b3/c3
a4/b4/c4
a5/b5/c5showrespectivelythosewhentheimagesequenceare⑤①②③④
④⑤①②③
③④⑤①②and②③④⑤①.alltheimagesarewindowedforoptimizedappearancewithalineargrayscale.comparisonamongthe5purephaseimagesofthesampleasshowninfigs.6
showsthatincontrastwiththetheoreticalanalysisinformula
1.18
theretrievedphaseimagesofthefiveimagesequencesaretotallydifferent
meanwhile
itwasobservedthattheareaswhereerrorstakeplaceisalways
15/23movinginthe5phaseimages
thereasonisthatthephaseshiftintroducedbythesampleinthisexperimentisnotsotinyasweassumedinformula
1.17
thatthecontributionofthesample
phaseshiftwouldpassoverthejumpingedge
andaccordingtoouraforementionedanalysis
theerrorisalwayshappeningwhentheinitialphaseislocatednearthejumpingedgeofthesawtoothcurveasshowninfig.4
inanotherwaywecansaythaterrorusuallyoccursattheplacewherethelightintensityinthefirstimageofthedatasituatesaroundtheminimumvalueasdemonstratedinfig.4
thiswasconfirmedaswecanseeinfig.6
thetracesoferrorcoincidetosomerangethedarkareasinfig.2
.ifwechangetheimagesequenceoftherawdata
thedarkpartsinthefirstimagewouldmovebecausethemoirefringeisshiftingwhenthepositionoftheanalyzinggratingischangedinphasesteppingscan
andthereforetheareaswhereerrorstakeplacewouldbemovinginthe5phaseimages.thephenomenonthatthetraceoferrorisalwaysmovinginthe5phaseimagesimpliesthatforeachpixel
therewouldsurelybeatleastonepurephaseimagewithoutintroducingerror.forexample
seetheupperrightpartofthephaseimage
errorappearedonlyinfigs.6
and6
whilecorrectresultswereobtainedinfigs.6
and6
.ajudgmentcriteriaonwhichphaseimageofthe5imagesequencespossesstheleastpossibilityofyieldingerrorforacertainpixelcanbemade
seefig.5
thecriteriacanbeachievedthaterrorhastheleastpossibilityofemergingintheimagesequencewhoseinitialphaseatthispixelwithoutsampleislocatedasfarfromthejumpingedgeaspossible
itisidenticaltothattheinitialphasesituatesasnearthereddottedlineaspossible.thiscriteriaworksbecauseforthepixel
itwouldbethesafestconditionwherethesubsequentphasewiththecontributionofthesample
phaseshiftwouldnotcrossthejumpingedgeifwebeforehanddonotknowthedirectionofthephaseshiftintroducedbythesample
rememberthatthejumpingedgeistheultimatesourceoferrorinmethodarg
-arg
.4.2algorithmofthenewphaseunwrappingsolution
16/23s1.calculatethephaseimageswithandwithoutsamplerespectivelybyformula
1.7
in5imagesequencesoftherawdataasfollows:1122334
=arg
background
=arg
sample
=arg
background
=arg
sample
=arg
background
=arg
sample
=arg
backgroundbsbsbsb①②③④⑤①②③④⑤⑤①②③④⑤①②③④④⑤①②③④⑤①②③455
=arg
sample
=arg
background
=arg
sample
.sbs③④⑤①②③④⑤①②②③④⑤①②③④⑤①
1.19
s2.forpixel
1,1
indextheminimumabsolutevalueinthe5phaseimageswithoutsampleas:12345k=minimum
index
1,1
1,1
1,1
1,1
1,1
1k5bbbbb
1.20
computetherefractionangleofpixel
1,1
1,1
1,1
1,1
2zsbkktd
1.21
step4
foralltheotherpixels
repeats2ands3
andtherefractionimage
isobtained.4.3performanceofthenewphaseunwrappingsolution
17/23figure7.
coloronline
.refractionimagesofthesampleafterbackgroundcorrectionwith
methodarg
-arg
methodarg
s/b
phaseunwrappingsolution
arg
-arg
modulo2π
thenewphaseunwrappingalgorithm
arehistogramsofthefourimages
representtherefractionanglesofthecrosssectionschosenasshownin
respectively.alltheimagesarewindowedforoptimizedappearancewithalineargrayscale.thefirstcasewetookforevaluatingthenewphaseunwrappingsolutionistheaforementionedexperimentaldata.figs.7
and7
showrespectivelytheretrievedphaseimageofthesamplebymethodarg
-arg
methodarg
s/b
phaseunwrappingsolution
arg
-arg
modulo2πandthenewphaseunwrappingalgorithm
wenameitas
arg
-arg
cyclicshift
.infig.7
theblackcurve
thebluecurve
thegreendashedcurveandthereddottedonedepictrespectivelyhistogramsofthefourimages
andtherangeofrefractionangledisplayedisfrom-1.1e-8to1.4e-8radian.fig.7
istherefractionanglesofthecrosssectionschosenasshownthelinesinfigs.7
respectively
thebluecurvestandsforthedatayieldbymethodarg
s/b
whilethegreendashedoneandthereddottedoneshowsthoseofthetwophaseunwrappingsolutions.here10pixelsinthehorizontaldirectionwereaveragedtogeneratetheprofiles
inthehopeofdecreasingthenoise.fig.8showsperformanceofthenewphasewrappingsolutionwhendealingwithanothersetofdata
thesampleisachickenbone
andrawimageswereacquiredinasamemannerasthepreviousone.fig.8
representstherefractionimageobtainedbymethodarg
-arg
andfig.8
showsthatbymethodarg
s/b
whilefigs.8
and8
depictthoseusingthetwophaseunwrappingsolutions.fig.8
providehistogramsofthefourimages
wechosetherefractionanglefrom-11.5e-7to-5e-7radianwhengeneratingthehistogram
theblackcurve
thebluecurve
thegreendashedcurveandthereddottedoneshowrespectivelyhistogramsofthefourimages.fig.8
aretherefractionanglesofthecrosssectionschosenasshowninfigs.8
and8
respectively
thebluecurvestandsfortheprofileofmethodarg
s/b
whilethegreendashedcurveandthereddottedonearethoseofthetwophase
18/23unwrappingalgorithms.figure8.
coloronline
.refractionimagesofthesampleafterbackgroundcorrectionwith
methods
arg
-arg
arg
s/b
phaseunwrappingsolutions
arg
-arg
modulo2πand
arg
-arg
cyclicshift
arehistogramsofthefourimages
showstherefractionanglesofthecrosssectionschosenasshownin
respectively.alltheimagesarewindowedforoptimizedappearancewithalineargrayscale.5discussionfromfigs.7
and8
itwasobservedveryclearthatusingboththetwointroducedphaseunwrappingsolutions
thephasewrappingphenomenonintherefractionimagesbymethodarg
-arg
asshowninfigs.7
and8
hasbeentotallyeliminatedandalsowecanseethatthereisalmostnovisualdifferenceamongtheimagesyieldedbythetwophaseunwrappingsolutionsandtheimagescomputedbymethodarg
s/b
.numericalcomparisonsasshowninfigs.7
thehistogramsandinfigs.7
thesectionprofilesfurtherconfirmusthatboththetwophaseunwrappingstrategiescouldsuccessfullyyieldexactlythesamerefractionsignalasmethodarg
s/b
seetheenlargedviewinfigs.7
19/238
.itshouldbepointedoutthatthefirstphaseunwrappingsolution
arg
-arg
modulo2π
sharesthesamefeaturewithmethodarg
s/b
theeffectivephasemeasuringrangeofbothisfixedtobe
andphasewrappingeffectwouldnottakeplaceifthedesiredphasesituateswithinthisrange.onthecontrary
thereissomedifferencesbetweensolution
arg
-arg
cyclicshiftandmethodarg
s/b
intheaforementioneddatapostprocessing
wetunedtheinitialphaseofeverypixelwithoutsampletopositiont1asshowninfig.5
andthenthisstrategycouldmeasurewithouterrorthephaseintherangeof00

weassume0isapositivenumberforexample10
.ifwemovetheinitialphaseofeverypixeltopointt3
thenthephaseintherangeof009,55canbemeasuredbythisphaseunwrappingalgorithmwithouterror
rememberthattheeffectivephasemeasuringrangeofmethodarg
s/b
isfixedtobe
thereforethenaturethattheeffectivephasemeasuringrangeofthenewphaseunwrappingsolutioncouldbetunedinsomedegreewouldembodyitssuperiorityovermethodarg
s/b
incertaincases.foraneasierimplementationofthenewphaseunwrappingsolutionincomputer
thefirststeps1insection4.2canbereplacedasfollowswithouttheneedofcyclicallyshiftingthesequenceoftherawimages.1122334411005511612
=arg
exp
arg
exp
55arg
exp
arg
exp
55arg
exp
arg
5bsbsbsbskkkkbskkkkbkkkkiikkiiki4455612772233883344
=.exp
5arg
exp
arg
exp
55arg
exp
arg
exp
55bsbsskkbskkkkbskkkkkikkiikkii
1.22
thisnumericalcomputingisidenticaltoformula
1.19
20/234521014310sequence=sequence=sequence=
=arg
exp
arg
exp
=arg
exp
5kkkkkkkkiiki⑤①②③④①②③④⑤④⑤①②③=6124741203sequence=sequence=sequence=arg
exp
=arg
exp
arg
exp
55kkkkkkkikkii①②③④⑤③④⑤①②①②③④⑤==4851304sequence=sequence=
=arg
exp
arg
exp
.55kkkkkkii②③④⑤①①②③④⑤=
1.23
anotheralgorithmsharingthesamekeypointofthenewphaseunwrappingsolutioncanbewrittenasfollows
inthehopeofreducingthememoryconsumedincomputer.s1
forpixel
1,1
indexthemaximumvalueoflightintensityinthe5rawimageswithoutsampleas
bbbbb12345=maximum
indexi
1,1
1,1
1,1
1,1
1,1
15nn
1.24
computetherefractionangleofpixel
1,1
as:5511
1,1
2zarg
exp
arg
exp
55tnnsbknknknkndkkii
1.25
foralltheotherpixels
repeats1ands2
andtherefractionimage
isobtained.thisalgorithmisidenticaltothesolutiondescribedinsection4.2
asshowninfig.5
ifthelightintensityofthefirststepintheimagesequenceisthemaximum
theinitialphasewouldthensituatesasfarfromthejumpingedgeaspossible.advantageofthisalgorithmisthatthephasewascomputedonlyonceandthememoryconsumedincomputerwouldthusbegreatlyreduced
rememberthatintheprevioustwoalgorithms
thephasehastobecomputedfor5timesandthepersonal
21/23computerhastoallocatemuchmorememoryforthestorageofthe10phaseimages.finally
wewanttopointoutthatthenewphaseunwrappingsolutioncanalsogetusedinothertechniques
forexampleinx-rayphasecontrastimagingwithacrystalx-rayinterferometer
4-6
andinphasemeasurementtechniquewithvisiblelight.
6conclusioninthisstudy
wetalkedabouttwobackgroundcorrectionmethodsinx-rayphasecontrastimagingwithtalbot-lauinterferometer.
methodarg
-arg
.itseffectivephasemeasuringrangeis
-2π,2π
butphasewrappingphenomenonusuallyhappenswhenthepurephaseintroducedbythesampleisverysmall.
methodarg
s/b
.theeffectivephasemeasuringrangeis
andphasewrappingeffectwouldn
texistifthedesiredphasesituatesinsidethisrange.meanwhile
weintroducedtwophaseunwrappingsolutionstofixtheerrorsinbackgroundcorrectionmethodarg
-arg
algorithm
arg
-arg
modulo2π.thissolutionsharesexactlythesamefeaturewithmethodarg
s/b
algorithm
arg
-arg
cyclicshift.withthisphaseunwrappingsolution
phasewrappingeffectwouldn
ttakeplacewhenthephasetomeasureissmall.andcomparedwithmethodarg
s/b
superiorityofthisalgorithmsisthatitseffectivephasemeasuringrangecouldbetunedinsomedegreeforexampleto
-π+3
π+3
thusitwouldfindpotentialadvantageundercertaincasebecausetheeffectivephasemeasuringrangeofmethodarg
s/b
isfixedtobe
.acknowledgementstheauthorsaregratefultomurakamigaku
wataruabe
taikiumemotoandkosukekato
instituteofmultidisciplinaryresearchforadvancedmaterials
tohokuuniversity,2-1-1katahira
aoba-ku
sendai
miyagi980-8577
japan.
fortheirkindhelpwhileconductingtheexperiments
22/23references
lewisr2004phys.med
biol.493573
momosea2005jpn.j.appl.phys.446355
zhousaandbrahmea2008phys.medica24129
bonseuandhartm1965appl.phys.lett.6155
momosea1995nucl.instrum.meth.a352622
momosea
takedat
itaiyandhiranok1996nat.med.2596
wilkinss
gureyevt
gaod
poganyaandstevensona1996nature384335
nugentk
gureyevt
cooksond
paganindandbarneaz1996phys.rev.lett.772961
davist
gaod
gureyevt
stevensonaandwilkinss1995nature373595
chapmand
thomlinsonw
johnstonr
washburnd
pisanoe
gmürn
zhongz
menkr
arfellifandsayersd1997phys.med
biol.422015
davidc
nöhammerb
solakhhandzieglere2002appl.phys.lett.813287
momosea
kawamotos
koyamai
hamaishiy
takaikandsuzukiy2003jpn.j.appl.phys.42l866
momosea
yashirow
takeday
suzukiyandhattorit2006jpn.j.appl.phys.455254
pfeifferf
weitkampt
bunkoanddavidc2006nat.phys.2258
pfeifferf
kottlerc
bunkoanddavidc2007phys.rev.lett.98108105
pfeifferf
bechm
bunko
kraftp
eikenberryef
broennimannc
gruenzweigcanddavidc2008nat.mater.7134
stutmand
becktj
carrinojaandbinghamco2011phys.med
biol.565697
zanettei
weitkampt
leducgandpfeifferf2013rscadv.319816
bechm
tapfera
velroyena
yaroshenkoa
pauwelsb
hostensj
bruyndonckxp
sasovaandpfeifferf2013sci.rep.3
tanakaj
nagashimam
kidok
hoshinoy
kiyoharaj
makifuchic
nishinos
nagatsukasandmomosea2013z.med.phy.23222
23/23
momosea
yashirow
kidok
kiyoharaj
makifuchic
itot
nagatsukas
hondac
nodadandhattorit2014philos.t.r.soc.a37220130023
zanettei2010interférométriexàréseauxpourl'imagerieetl'analysedefrontd'ondesausynchrotron
ph.ddissertation
france
universitédegrenoble
itohk1982appl.opt.212470
judgetrandbryanstoncp1994opt.laser.eng.21199
haasw
bechm
bartlp
bayerf
rittera
webert
pelzerg
willnerm
achterholdkanddurstj2011proc.ofspie796279624r-1
jerjeni
revolv
schuetzp
kottlerc
kaufmannr
luethit
jefimovsk
urbancandsennhauseru2011opt.express1913604
epplef
potdeving
thibaultp
ehns
herzenj
hippa
beckmannfandpfeifferf2013opt.express2129101
bruningj
herriottdr
gallagherj
rosenfeldd
whiteaandbrangacciod1974appl.opt.132693
creathk1988prog.optics26349
weitkampt
diaza
davidc
pfeifferf
stampanonim
cloetenspandzieglere2005opt.express136296
