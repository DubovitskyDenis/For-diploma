normalization
quasinormal
modes
leaky
optical
cavities
plasmonic
resonators
institut
f¨ur
physik
humboldt
universit¨at
berlin
12489
berlin
germany
philip
trøst
kristensen
department
physics
queen
university
kingston
ontario
k7l
3n6
canada
rong-chun
stephen
hughes
dated
august
2018
discuss
three
formally
diﬀerent
formulas
normalization
quasinormal
modes
currently
use
modeling
optical
cavities
plasmonic
resonators
show
complementary
provide
result
regardless
formula
used
normalization
one
use
norm
deﬁne
eﬀective
mode
volume
use
purcell
factor
calculations
introduction
optical
cavities
plasmonic
resonators
enable
tight
localization
electromagnetic
ﬁelds
length
scales
order
wavelength
shorter
addition
resonant
nature
material
systems
suggest
dis-
crete
nature
possible
electromagnetic
waves
sim-
ilar
bound
states
hydrogen
atom
analogy
somewhat
deceptive
inherently
leaky
nature
electromagnetic
resonators
leads
continuous
dissipation
energy
via
radiation
absorption
material
nevertheless
distinct
reso-
nances
show
peaks
spectra
scattering
calcu-
lations
measurements
example
width
peak
related
ﬁnite
lifetime
due
dissipa-
tion
energy
associated
scattered
ﬁelds
often
show
signatures
underlying
modal
structure
throughout
literature
resonances
frequently
referred
modes
explicit
mathematical
deﬁnition
modes
rarely
given
may
cause
con-
ceptual
practical
diﬃculties
using
modes
calculations
fig
color
online
left
illustration
gold
nanorod
dimer
right
absolute
value
fundamental
qnm
˜fc
plane
qnm
scaled
unity
position
center
two
rods
computational
nanophotonics
optical
plas-
monic
response
resonant
systems
often
modeled
use
time-domain
calculations
perfectly
matched
layers
pmls
run-time
fourier
transform
ex-
tract
modal
ﬁeld
distribution
technique
successful
modeling
high
quality
optical
cavities
spectral
resonances
well
sep-
arated
particular
modes
calculated
used
estimates
spontaneous
emission
rate
enhancement
via
purcell
formula1
spontaneous
emission
rate
expected
scale
ratio
cavity
quality
factor
eﬀective
mode
volume
veﬀ
eﬀective
mode
volume
describes
degree
light
localization
cavity
clear
deﬁnition
closed
resonators
terms
integrated
energy
density
light
mode
deﬁnition
how-
ever
directly
extended
dissipative
systems
mode
extends
space
conceptual
consequences
application
purcell
formula
manifestly
pertains
dissipative
systems
ﬁnite
value
theoretically
response
dissi-
pative
resonant
structures
understood
terms
so-called
quasinormal
modes2–4
qnms
appear
discrete
solutions
wave
equation
satisfy
radiation
condition
compatible
propagation
light
away
resonator
figure
shows
exam-
ple
plasmonic
resonator
form
nanorod
dimer
ﬁeld
proﬁle
fundamental
qnm
dimer
use
pmls
one
possible
realization
radiation
condition
resonators
homogeneous
media
wherefore
pointed
ref
op-
tical
cavity
modes
commonly
calculated
time-domain
techniques
exactly
qnms
purcell
formula
derived
within
qnm
framework
developed
refs
6–10
example
leads
naturally
deﬁnition
eﬀective
mode
volume
com-
patible
leaky
nature
modes
eﬀective
mode
volume
intimately
connected
normal-
ization
qnms
two
alternative
formulations
eﬀective
mode
volume
derived
refs
respectively
based
diﬀerent
formulations
norm
article
show
three
diﬀerent
normalization
integrals
closely
related
provide
−0.1−0.0500.050.1−0.15−0.1−0.0500.050.10.15positionx
positiony
00.511.5
result
essence
show
diﬀer-
ences
formulas
understood
alternative
regularization
procedures
inherently
ill-behaved
integral
although
illustrate
formal
connection
three
formulations
worth
emphasizing
derived
use
diﬀerent
approaches
refs
13.
equivalence
formulas
therefore
regarded
profound
strength
entire
modeling
framework
localized
electromag-
netic
resonators
based
qnms
article
organized
follows
section
introduce
three
formulations
qnm
norm
discuss
relate
section
iii
pro-
vides
explicit
example
calculations
illustrate
prac-
tical
evaluation
well
equivalence
norms
section
summarizes
concludes
article
normalization
integrals
consider
electric
ﬁeld
qnms
˜fµ
resonators
embedded
homogeneous
background
deﬁned
eigenmodes
maxwell
wave
equation
˜fµ
˜k2
µr
˜ωµ
˜fµ
˜kµ
˜ωµ/c
ratio
angular
resonance
frequency
speed
light
˜ωµ
rela-
tive
permittivity
leaky
nature
res-
onators
diﬀerential
equation
augmented
radiation
condition
allow
outgoing
wave
so-
lutions
large
distances
case
homogeneous
environment
argue
radiation
condition
formally
silver-m¨uller
radiation
condition14
form
˜fµ
−inb
˜fµ
˜kµ
refractive
index
homogeneous
back-
ground
material
silver-m¨uller
radiation
condition
commonly
imposed
correctly
model
scattered
ﬁelds
therefore
argue
also
radiation
con-
dition
qnms
considered
solutions
scattering
problem
source
deﬁned
limit
inﬁnite
distances
rarely
useful
numerical
calculations
qnms
instead
one
use
pmls
mimic
radiation
condition
removing
reﬂections
calculation
domain
bound-
ary
one
use
calculation
methods
based
green
tensor
manifestly
respects
radiation
con-
dition
result
radiation
condition
diﬀer-
ential
equation
problem
becomes
non-hermitian
where-
fore
number
well-known
text
book
results
hermi-
tian
eigenvalue
problems
apply
particular
discrete
resonance
frequencies
˜ωµ
iγµ
com-
plex
negative
imaginary
part
value
calculated
ωµ/2γµ
complex
resonance
frequencies
combination
radiation
condition
leads
divergent
behavior
qnms
function
distance
resonator
makes
normalization
non-trivial
discussed
introduc-
tion
problem
normalization
qnms
addressed
least
three
diﬀerent
methods
leading
three
diﬀerent
formulas
discuss
detail
moving
however
worth
elaborating
bit
connection
mathematical
concept
norm
physical
concept
mode
volume
regardless
formula
used
normalization
one
use
norm
deﬁne
generalized
eﬀective
mode
volume
qnm
interest
denoted
as5
cid:104
cid:104
˜fc|˜fc
cid:105
cid:105
cid:104
cid:104
˜fc|˜fc
cid:105
cid:105
denotes
qnm
norm
formula-
tion
compatible
divergent
behavior
qnms
˜fc
˜fc
po-
large
distances
sition
denotes
point
special
interest
given
resonator
optical
cavities
often
cen-
ter
cavity
ﬁeld
largest
generalized
eﬀective
mode
volume
gives
measure
maximum
light-matter
interaction
one
obtain
cavity
general
resonators
may
unique
way
deﬁning
center
may
mode
vanishes
point
plasmonic
res-
onators
particular
ﬁeld
may
several
orders
magnitude
larger
edges
within
material
despite
large
ﬁeld
values
however
edges
of-
ten
uninteresting
light-matter
interaction
enormous
non-radiative
decay
quenching
general
therefore
specify
explicitly
resonator
generalized
eﬀective
mode
volume
complex
general
related
eﬀective
mode
volume
veﬀ
purcell
formula
cid:26
cid:27
veﬀ
deﬁnition
follows
directly
quite
naturally
derivation
original
purcell
formula
frame-
work
qnms
either
using
green
tensor
approach4,5,12
mode
expansion
formulation11
follows
derivations
usefulness
eﬀective
mode
vol-
ume
purcell
factor
calculations
restricted
mate-
rial
systems
frequency
ranges
single
mode
dominates
response
moreover
use
purcell
factor
calculations
valid
limit
˜ωc/ωc
may
hold
low-q
optical
cavities
plasmonic
resonators
cases
hold
one
still
recover
purcell
formula
redeﬁning
either
practice
often
easier
convenient
calculate
spontaneous
emis-
sion
enhancement
directly
qnm
expansion
green
tensor
plasmonic
structures
usefulness
original
purcell
formula
limited
non-
radiative
decay
channels
positions
close
material15,16
normalization
lai
lai
introduced
normalization
qnms
applied
study
spherically
symmetric
non-dispersive
material
systems
ref
rewriting
slightly
express
norm
cid:104
cid:104
˜fµ|˜fµ
cid:105
cid:105
lai
lim
2˜kµ
˜fµ
˜fµ
˜fµ
˜fµ
cid:111
cid:110
cid:90
cid:90
spherical
volume
boundary
diﬀerential
volume
area
elements
respec-
tively
normalization
ref
appears
date
back
early
work
zel
dovich
theory
unstable
states17
later
adopted
form
introduce
generalized
eﬀective
mode
volume
leaky
optical
cavities5
formula
extended
disper-
sive
resonators
homogeneous
non-dispersive
sur-
roundings
substitution7
˜ωµ
cid:0
ω2r
cid:1
cid:90
limr→∞
bh2
˜kµr
r2dr
2˜kµ
˜kµr
includes
angular
integration
vector
spherical
harmonics
independent
nite
following
use
linear
combi-
nations
vector
spherical
harmonics
form
˜p±
plm
plm
vector
spherical
harmonic
order
formulation
ref
18.
ar-
gument
originally
lai
al.6
outgoing
wave
nature
hankel
functions
large
distances
increase
volume
integral
ex-
actly
balanced
additional
surface
integral
large
arguments
spherical
hankel
functions
tend
limiting
form
e−iπ
l+1
eiz
inserting
diﬀerentiating
re-
spect
ﬁnd
cid:110
cid:16
e2inb
˜kµr
cid:17
cid:111
l+1
˜k2
e2inb
˜kµr
2nb
˜kµ
norm
suﬀers
pathological
deﬁ-
ciency
case
degenerate
modes
high-symmetry
material
systems
spherical
resonators
example
one
choose
azimuthal
dependence
qnms
form
exp
±imϕ
integer
values
choice
lead
vanishing
norm
discussed
ref
may
therefore
appropriate
for-
mulate
norm
terms
adjoint
ﬁelds
spherical
systems
obtained
complex
conjuga-
tion
angular
dependence
only6
clear
how-
ever
perturbative
breaking
symmetry
lift
degeneracy
lead
well-deﬁned
qnms
norm
applies
immediately
therefore
cases
norm
vanishes
one
always
choose
linear
combinations
degenerate
qnms
norm
applies
written
case
spherical
resonator
example
one
choose
azimuthal
dependencies
qnms
form
exp
imϕ
exp
−imϕ
case
applies
di-
rectly
suggesting
one
assign
well-deﬁned
value
norm
practice
direct
application
leads
integral
seems
quickly
converge
towards
ﬁnite
value
fact
oscillates
value
amplitude
eventually
starts
grow
exponentially
distance
albeit
slowly
compared
length
scales
typical
calculations
noted
ref
oscillations
observed
cavity
lowest
quality
factor
source
oscillating
integral
traced
back
complex
resonance
frequency
means
wavenumber
˜kµ
complex
well
evaluation
leads
residual
radius
dependent
terms
form
res
lai
e2inb
˜kµr
cid:88
resonator
evaluate
norm
ﬁrst
integrating
spherical
domain
ra-
dius
completely
enclosing
resonator
integral
well
behaved
easily
evaluated
next
region
write
qnms
terms
˜kµr
vector
spheri-
spherical
hankel
functions
cal
harmonics18
therefore
norm
may
rewritten
form
cid:104
cid:104
˜fµ|˜fµ
cid:105
cid:105
lai
˜fµ
˜fµ
cid:88
cid:90
denotes
general
polynomials
order
surface
term
cancels
ﬁrst
or-
der
term
thus
eqs
appear
formally
correct
also
complex
arguments
limit
practice
leads
position
dependent
phase
diﬀerence
hankel
function
limiting
form
makes
limit
non-trivial
perform
along
real
axis
principle
however
possible
reg-
ularize
integral
using
coordinate
transforms
tech-
nique
also
also
normalization
leaky
modes
waveguides19
formally
rewrite
in-
tegral
lim
r→∞
cid:110
cid:90
cid:90
cid:16
r3n2
bh2
˜kµr
r2dr
2˜kµ
cid:111
∂rf
res
lai
∂rf
res
lai
cid:90
cid:90
res
lai
lim
r→∞
∂rf
res
lai
˜kµr
hl−1
˜kµr
hl+1
bh2
˜kµr
minus
antiderivative
last
integral
change
integration
con-
tour
writing
ﬁnd
case
spherical
resonator
provide
example
approach
section
iii
obviously
regulariza-
tion
approach
rather
cumbersome
unless
expansion
spherical
wave
functions
explicitly
known
also
rarely
necessary
practice
although
integral
oscil-
lates
function
calculation
domain
size
asso-
ciated
uncertainty
calculated
norm
much
lower
general
numerical
uncertainty
qnm
calculations
elaborate
issue
sections
iii
iii
normalization
sauvan
cid:90
sauvan
al.11
used
diﬀerent
approach
based
lorentz
reciprocity
theorem
introduce
normalization
qnms
general
dispersive
possibly
magnetic
materials
written
cid:104
cid:104
˜fµ|˜fµ
cid:105
cid:105
sauvan
˜fµ
˜fµ
˜gµ
˜gµ
˜gµ
magnetic
ﬁeld
qnm
satisfying
˜fµ
i˜ωµµ0µr
˜ωµ
˜gµ
ωr
ωµ0µr
/0
denote
per-
mittivity
permeability
free
space
respectively
possibly
dispersive
relative
permeability
normalization
seems
originate
theory
leaky
modes
waveguides20
original
formulation
implementation
ref
explicit
re-
quirement
volume
tend
inﬁnity
instead
integral
performed
usual
calculation
do-
main
surrounding
pmls
real
space
coordinates
rotated
complex
plane
causing
propagating
waves
decrease
exponentially
cid:104
cid:104
˜fµ|˜fµ
cid:105
cid:105
sauvan
˜kµr
˜ωµ
˜fµ
˜fµ
cid:0
˜fµ
cid:1
cid:0
˜fµ
cid:1
cid:17
˜kµr
materials
correspondence
normal-
ization
lai
shown
ref
repeated
completeness
first
use
vector
general-
ization
green
identity
ﬁrst
kind21
cid:90
cid:90
cid:90
˜k2
cid:90
rewrite
cid:104
cid:104
˜fµ|˜fµ
cid:105
cid:105
sauvan
˜ωµ
˜fµ
˜fµ
˜k2
2˜k2
˜fµ
˜fµ
cid:16
˜fµ
˜fµ
cid:17
cid:90
using
wave
equation
limit
recover
substitution
˜ωµ
importantly
integrand
invari-
ant
coordinate
transformations
pmls11
therefore
integral
must
well-deﬁned
value
also
trivial
transformation
coordi-
nate
rotation
performed16
view
argument
complement
suggesting
norm
well-deﬁned
value
normalization
muljarov
muljarov
al.12,13
derived
normalization
similar
structure
diﬀerent
surface
term
cid:104
cid:104
˜fµ|˜fµ
cid:105
cid:105
muljarov
cid:90
˜ωµ
˜fµ
˜fµ
2˜k2
cid:0
r∂r
˜fµ
cid:1
˜fµ
cid:1
˜fµ
cid:1
cid:0
cid:90
cid:0
˜fµ
deﬁned
denotes
derivative
direction
normal
surface
volume
needs
spherical
needs
extend
inﬁnity
comparing
two
formulas
makes
explicit
reference
spherical
coordinate
system
center
one
left
free
choose
isotropic
non-magnetic
materials
may
write
terms
electric
ﬁeld
qnms
case
spherical
domain
radius
show
correspondence
normalization
lai
ﬁrst
evaluating
integrals
using
recurrence
relations
hl−1
hl+1
∂rhl
∂rhl
deﬁning
equation
spherical
hankel
func-
tions
r2∂rrhl
2r∂rhl
ﬁnd
cid:16
˜kµr
cid:1
cid:0
r∂rhl
˜kµr
cid:1
cid:17
˜kµr
cid:0
∂rhl
2˜k2
inserting
rearranging
terms
mul-
tiplying
onto
spherical
harmonics
write
angular
integration
surface
integral
terms
qnms
exact
form
iii
example
calculations
section
present
number
example
calcu-
lations
illustrate
three
formulations
give
value
norm
practical
calculations
first
consider
case
homogeneous
sphere
functional
form
qnms
known
analytically
carry
regularization
explic-
itly
example
also
considered
muljarov
ref
12.
next
revisit
photonic
crystal
cavity
ref
plasmonic
nanorod
dimer
ref
elaborate
practical
evaluation
homogeneous
sphere
ﬁrst
set
example
applications
three
for-
mulations
consider
qnms
homogeneous
spheres
radius
air
following
muljarov
al.
con-
sider
electric
ﬁeld
qnms
transverse
kind
may
written
positions
outside
sphere
terms
vector
spherical
harmonics
φlm
cid:0
φlm
cid:1
˜flm
˜kµr
φlm
∇ylm
ylm
denote
scalar
spherical
harmonics
simplicity
limit
discussion
case
purely
real
angular
dependence
corresponding
spherical
hankel
func-
tion
may
written
explicitly
eiz
inserting
follows
cid:104
cid:104
˜f1m|˜f1m
cid:105
cid:105
lai
cid:33
e2i˜kµa
cid:32
˜k4
2˜k3
lai
˜flm
˜flm
lim
r→∞
res
cid:90
cid:90
denotes
integral
ﬁnite
sphere
resid-
ual
dependent
factor
rewriting
norm
regularize
integral
conclude
norm
e2i˜kµr
lai
res
˜k5
µr2
cid:32
cid:33
cid:104
cid:104
˜f1m|˜f1m
cid:105
cid:105
lai
2˜k3
˜k4
e2i˜kµa
similar
way
evaluate
ﬁnd
cid:104
cid:104
˜f1m|˜f1m
cid:105
cid:105
sauvan
cid:33
e2i˜kµa
lim
2˜k3
r→∞
res
cid:32
˜k4
sauvan
cid:33
˜k6
µr3
˜k5
µr2
e2i˜kµr
res
sauvan
clearly
regularized
way
completely
analogous
nothing
diﬀerent
way
introducing
coordinate
transform
performed
use
pmls
ref
11.
ap-
proach
one
ﬁnds
immediately
two
norms
identical
finally
using
one
directly
verify
cid:104
cid:104
˜f1m|˜f1m
cid:105
cid:105
muljarov
cid:33
2˜k3
˜k4
e2i˜kµa
equals
result
two
formulations
norm
notably
without
explicit
need
reg-
ularization
photonic
crystal
cavity
second
example
consider
simple
two
di-
mensional
photonic
crystal
cavity
ref
formed
six
cylinders
relative
permittivity
rods
11.4
air
cylinders
arranged
hexagon
side
length
radii
0.15
con-
sider
out-of-plane
polarization
cav-
cid:32
cid:32
ity
supports
qnm
˜fc
complex
resonance
fre-
quency
˜ωca/2πc
0.425862
0.013539i
corresponding
16.
figure
shows
real
part
˜fc
scaled
unity
cavity
center
fig
color
online
real
part
fundamental
qnm
˜fc
small
cavity
made
high-index
rods
arranged
hexagon
side
length
indicated
black
circles
qnm
scaled
unity
cavity
center
qnm
calculations
used
fredholm
type
integral
equation
qnms
appear
self-
consistent
solutions
scattering
problem
in-
cident
ﬁeld5
equation
solved
iterative
procedure
guess
resonance
fre-
quency
˜ωguess
set
integral
equation
solved
ﬁnd
eigenvalue
closest
˜ωguess
iterations
continued
diﬀerence
smaller
prescribed
tolerance
speciﬁcally
˜ωguess
discretized
integral
eigenvalue
equation
expand-
ing
background
green
tensor
unknown
ﬁeld
within
rod
basis
cylindrical
wave
functions23
owing
inherent
wave
nature
basis
functions
frequency
˜ωguess
basis
particularly
well
suited
expansion
integral
formula-
tion
terms
green
tensor
means
radi-
ation
condition
inherently
satisﬁed
total
en-
ables
high
accuracy
calculations
qnms
although
method
best
suited
collections
cylindrical23
spherical24
scatterers
projections
onto
basis
functions
simplify
signiﬁcantly
help
following
discussion
worth
distin-
guishing
generalized
eﬀective
mode
volume
deﬁned
formally
single
complex
number
numerically
calculated
numbers
vnum
lai
muljarov
obtained
substituting
corresponding
normalization
formulas
calculated
circular
domain
radius
up-
per
panel
fig
shows
zoom
real
part
vnum
lai
oscillatory
behavior
clearly
visible
discussion
section
as-
sociate
oscillations
residual
r-dependent
term
res
lai
minimum
oscillation
amplitudes
occurs
15a
amplitudes
increase
without
bounds
illustrative
alternative
display
oscillatory
be-
lai
found
plotting
values
havior
vnum
fig
color
online
top
real
part
calculated
gen-
eralized
eﬀective
mode
volume
function
calculation
do-
main
radius
blue
red
parts
curve
indicate
regions
oscillations
decrease
increase
mag-
nitude
respectively
black
dashed
curves
show
second
order
running
averages
starting
ﬁrst
local
maximum
minimum
bottom
values
calculated
generalized
eﬀective
mode
volume
parameterized
function
calcula-
tion
domain
radius
part
curve
decreasing
oscillation
amplitudes
15a
center
in-
nermost
circle
corresponds
generalized
eﬀective
mode
volume
indicated
cross
complex
frequency
plane
shown
lower
panel
fig
way
one
quite
easily
appreci-
ate
values
vnum
lai
spirals
initially
towards
ﬁxed
value
complex
exponential
factor
res
lai
takes
causes
values
spiral
out-
wards
oscillating
behavior
provides
convenient
graphical
means
regularizing
integral
simply
determining
center
spiral
clearly
done
accuracy
much
better
smallest
oscillation
magnitude
better
ra-
dius
innermost
circle
spiral
ﬁnd
qualitative
behavior
vnum
lai
form
spi-
ral
aﬀected
accuracy
calculations
center
spiral
therefore
practical
purposes
error
calculated
value
case
dominated
numerical
integration
regularization
integral
practical
calculations
ﬁnd
one
get
convenient
high-accuracy
estimate
center
−4−2024−2−1012positionx/apositiony/a−1−0.500.510102030400.98870.98880.98890.98900.9891domainradiusr/anumericalintegralre
vnumlai
/a20.98870.98880.98890.9890.9891−9.18−9.17−9.16·10−2numericalintegralre
vnumlai
/a2numericalintegralim
vnumlai
/a2
cid:88
n=n0
spiral
calculating
moving
average
n−1
denotes
calculated
value
vnum
lai
present
case
photonic
crystal
cav-
ity
second
order
moving
average
shows
smooth
behavior
r/a
choosing
two
diﬀer-
ent
starting
points
corresponding
consecutive
local
maxima
minima
curve
vnum
lai
get
cor-
responding
upper
lower
bounds
illustrated
fig
exponentially
increasing
factor
res
lai
running
averages
general
tend
ﬁxed
value
large
distances
may
eventually
start
increasing
exponentially
therefore
consider
use
formal
regularization
procedure
rather
simple
computational
method
estimating
center
spiral
procedure
ﬁnd
value
vq/a2
0.988918
0.091688i
estimated
error
|δvq|/a2
10−6
os-
cillating
behavior
fig
exactly
noted
ref
stated
low-q
cavities
how-
ever
convergence
nontrivial
due
exponential
divergence
modes
may
cause
inner
prod-
uct
oscillate
around
proper
value
function
calculation
domain
size
practice
magnitude
oscillations
often
much
smaller
desired
accuracy
positions
within
typical
calculation
domains
may
also
much
smaller
overall
numerical
accuracy
next
compare
results
calculations
based
formulation
muljarov
al..
notably
requirement
inﬁnite
calculation
do-
main
convenient
numerical
point
view
practical
implementation
however
one
must
evaluate
numerically
ﬁrst
sec-
ond
derivative
together
general
accuracy
integral
accuracy
derivatives
governs
overall
precision
ﬁnite
accuracy
calculations
numerically
induced
phase
diﬀer-
ence
two
terms
wherefore
changes
volume
integral
fully
compensated
surface
term
diﬀerence
becomes
pro-
nounced
larger
values
derivatives
become
larger
instead
investigating
behavior
function
calculation
domain
size
fig
take
ﬁxed
calculation
domain
size
evaluate
integrals
ﬁxed
relative
accuracy
|δvnum
muljarov|/a2
10−7
ﬁrst
order
ﬁnite
diﬀerence
approximations
derivatives
calculated
using
suc-
cessively
smaller
diﬀerences
results
shown
table
display
convergent
behavior
towards
value
consistent
calculation
using
formula-
tion
lai
al.
∆r/a
vnum
muljarov
/a2
0.01
0.988894
0.091660i
0.001
0.988918
0.091688i
0.0001
0.988918
0.091688i
table
values
calculated
generalized
eﬀective
mode
volume
vnum
muljarov
ﬁxed
calculation
domain
size
muljarov/a2
10−7
relative
integration
tolerance
δvnum
varying
accuracy
numerical
derivatives
last
compare
calculations
based
formu-
implemen-
lation
sauvan
tation
fredholm
integral
equation
al-
low
evaluation
qnm
complex
positions
instead
used
ﬁnite-diﬀerence
time-domain
fdtd
calculations25
run-time
fourier
transform
cal-
culate
qnm
entire
calculation
domain
includ-
ing
pml
use
fdtd
comes
relatively
large
numerical
error
compared
fredholm
inte-
gral
equation
approach
advantage
immediately
applicable
completely
general
material
structures
calculations
used
formu-
lation
based
electric
magnetic
ﬁelds
evaluated
components
ﬁelds
individual
positions
yee
cells
avoid
interpolation
errors
principle
evaluation
calculated
pml
independent
calculation
domain
size
prac-
tice
however
see
small
variation
domain
size
attribute
limited
accuracy
numer-
ical
data
table
summarizes
results
calculated
four
diﬀerent
domain
sizes
cases
relative
er-
ror
compared
value
less
finally
using
discretization
also
use
fdtd
data
calculate
generalized
eﬀective
mode
volume
formulation
lai
/a2
0.988
0.092i
correspondning
ﬁnd
vfdtd
relative
error
|δvq|/|vq|
0.001
comparing
lai
l/a
sauvan/a2
vnum
0.999
0.091i
0.979
0.084i
0.991
0.102i
0.992
0.085i
table
values
calculated
generalized
eﬀective
mode
volume
vnum
sauvan
diﬀerent
sizes
square
calculation
do-
main
side
length
plasmonic
nanorod
dimer
ﬁnal
example
consider
three
dimensional
metallic
nanorod
dimer
fig
recently
studied
ref
22.
consists
two
gold
nanorods
length
100
radius
rrod
homoge-
neous
background
refractive
index
1.5.
gold
nanorods
aligned
along
axis
spaced
gap
relative
permittivity
gold
modeled
rod
iωγ
1.26
1016
rad/s
1.41
1014
rad/s
resonance
frequency
dipolar
like
qnm
in-
terest
˜ωc/2π
291
20i
thz
corresponding
wavelength
˜λc
2πc/˜ω
1025
70i
quality
factor
qnm
calculations
also
performed
using
fdtd25
run-time
fourier
transform
based
raw
yee
cell
data
without
interpolation
particularly
detrimental
plasmonic
structures
due
large
ﬁeld
gradients
excitation
used
spatial
plane
wave
excitation
near
291
thz
polar-
ization
along
dimer
axis
gaussian
tempo-
ral
proﬁle
common
practise
fdtd
an-
alyzing
metals
high
index
materials
used
non-uniform
mesh
consisting
relatively
small
cubic
yee
cells
side
length
0.8
along
dimer
axis
directions
inner
region
larger
cells
side
length
outer
region
see
ref
calculation
details
despite
ﬁne
discretization
expect
overall
accuracy
cal-
culations
limited
percent
due
meshing
sub-meshing
numerical
dispersion
fdtd
known
particularly
demanding
metallic
struc-
tures26
consider
state-of-the-art
gridding
parameters
metal
resonators
using
fdtd
sim-
ulation
times
order
days
small
computer
cluster
case
two-dimensional
cavity
investigate
variation
calculated
generalized
ef-
fective
mode
volume
calculation
domain
size
end
deﬁne
center
position
point
directly
two
nanorods
evaluate
substitution
˜ωµ
rectangular
cuboid
side
lengths
com-
pletely
enclosing
dimer
figure
shows
variation
vnum
lai
function
domain
width
varia-
tion
numerical
integral
shows
clear
oscillation
fig
although
spiraling
behavior
less
sym-
metric
despite
lower
symmetry
spiral
attribute
lower
degree
symmetry
cal-
culations
use
second
order
running
averages
determine
center
oscillation
relatively
high
precision
approach
ﬁnd
vq/r3
rod
36.15
0.81i
fig
color
online
top
real
part
calculated
gener-
alized
eﬀective
mode
volume
function
calculation
domain
width
black
dashed
curves
show
second
order
running
averages
bottom
values
calculated
generalized
eﬀec-
tive
mode
volume
parameterized
function
calculation
domain
width
full
curve
spline-interpolation
calculated
data
points
shown
gray
circles
generalized
eﬀective
mode
volume
indicated
cross
curves
second
order
running
averages
estimate
error
stemming
regularization
procedure
|δvq|
0.01r3
rod
estimate
take
account
error
fdtd
data
error
numerical
quadrature
noted
expect
actual
uncertainty
fdtd
data
may
large
percent
wherefore
accuracy
also
three
dimensional
calculation
limited
accuracy
numerical
calculations
regularization
next
compare
calculations
based
formu-
lation
sauvan
approach
found
vq/r3
36.17
1.02i
corresponding
rela-
tive
diﬀerence
|∆vq|/|vq|
0.006
comparing
practise
found
formulation
sensitive
boundary
eﬀects
fdtd
data
diﬀerence
likely
caused
material
weight
function
larger
inside
metal
resonator
cid:28
eqs
particular
stress
one
take
care
use
interpolated
ﬁeld
values
integration
rather
use
raw
data
diﬀerent
spatial
grids
individual
components
ﬁelds
last
remark
attempts
using
calculating
qnm
norm
plasmonic
dimer
05010015020025030036.036.136.236.3domainwidthlx/rrodnumericalintegralre
vnumlai
/r3rod35.93636.136.236.336.4−1−0.9−0.8−0.7numericalintegralre
vnumlai
/r3rodnumericalintegralim
vnumlai
/r3rod
found
normalization
muljarov
diﬃcult
evaluate
fdtd
data
precision
provides
better
accuracy
believe
problems
caused
ﬁnite
ac-
curacy
qnm
calculation
practice
unfortunate
rather
general
characteristic
many
nu-
merical
maxwell
solvers
three
dimensions
fdtd
inherent
formulation
terms
cartesian
coordi-
nates
leads
additional
interpolation
errors
per-
forming
radial
diﬀerentiation
dictated
present
case
plasmonic
dimer
found
ﬁeld
gradients
lead
relatively
large
numerical
er-
rors
surface
integral
practice
dominates
achievable
accuracy
analysis
section
obvious
limitations
principal
nature
rather
practical
issues
pertaining
numerical
calculation
method
discussion
comparing
eqs
understand
three
formulations
norm
arising
three
diﬀerent
approaches
regularization
integral
˜fµ
˜fµ
cid:90
integral
regularized
immediately
com-
plex
coordinate
transform
discussed
section
therefore
view
eqs
one
may
view
surface
term
simple
choice
regularization
use
data
positions
along
real
axis
worth
noting
however
surface
term
appears
directly
perturbation
theory
calculations6
assumption
silver-m¨uller
radiation
con-
dition
principle
important
argument
based
eqs
one
assign
well-
deﬁned
value
norm
many
practical
calculations
ﬁnd
relatively
simple
formula
lai
often
suﬃcient
un-
certainty
norm
associated
eﬀective
mode
volume
dominated
uncertainty
numeri-
cal
data
one
access
complex
position
data
normalization
sauvan
represents
obvi-
ous
alternative
high-accuracy
numerical
data
qnms
known
analytically
one
beneﬁt
formula
muljarov
al..
article
focused
normalization
resonators
embedded
homogeneous
background
ma-
terial
argued
represents
proper
choice
radiation
condition
resonators
coupled
waveguides
radiation
condition
diﬀerent
also
case
appears
inherent
need
regularization
normalization
integral27
also
worth
noting
bai
recently
introduced
alternative
calculation
method
qnms
based
scattering
formulation
complex
frequencies
resulting
qnms
naturally
normalized
without
explicit
need
integration
step28
conclusions
conclusion
discussed
relation
three
diﬀerent
formulations
normalization
qnms
leaky
optical
cavities
plasmonic
res-
onators
three
formulations
arise
independent
derivations
expansion
electromagnetic
ﬁeld
terms
qnms
spherical
calculation
volumes
shown
equivalence
diﬀerent
formulas
explicitly
moreover
illustrated
equivalence
norms
number
example
calculations
practical
interest
argued
apparent
diﬀerences
normalization
formulas
understood
arising
alternative
ways
regularizing
normalization
integral
handle
inherently
divergent
qnms
view
surface
term
normalization
lai
represents
simple
choice
regularization
principle
insuﬃcient
properly
regularize
integral
size
calculation
domain
varied
along
real
axis
discussed
issue
detail
shown
one
principle
always
regularize
integral
complex
coordinate
transform
practice
ﬁnd
rarely
need
additional
regularization
beyond
relatively
simple
formula
lai
nevertheless
depending
calculation
method
used
obtain
qnms
normalizations
sauvan
muljarov
may
convenient
regardless
choice
normalization
integral
discussed
one
use
norm
deﬁne
eﬀective
mode
volume
use
purcell
formula
complementarity
three
norms
naturally
leads
estimates
enhanced
spontaneous
emission
factor
work
supported
carlsberg
foundation
queen
university
natural
sciences
engi-
neering
research
council
canada
purcell
spontaneous
emission
probabilities
radio
frequencies
physical
review
681
1946
ching
leung
young
optical
processes
microcavities—the
role
quasi-normal
modes
chang
campillo
eds
world
scientic
1996
ching
leung
maassen
van
den
brink
suen
tong
young
quasinormal-mode
expansion
waves
open
systems
review
modern
physics
1545–1554
1998
kristensen
hughes
modes
mode
volumes
leaky
optical
cavities
plasmonic
nanoresonators
acs
photonics
2–10
2014
kristensen
vlack
hughes
generalized
eﬀective
mode
volume
leaky
optical
cavities
optics
let-
ters
1649–1651
2012
lai
leung
young
barber
hill
time-independent
perturbation
leaking
electro-
magnetic
modes
open
systems
application
reso-
nances
microdroplets
physical
review
5187–5198
1990
leung
liu
young
completeness
time-independent
perturbation
quasinormal
modes
absorptive
leaky
cavity
physical
review
3982–3989
1994
leung
pang
completeness
time-
independent
perturbation
morphology-dependent
reso-
nances
dielectric
spheres
journal
optical
society
america
805
1996
lee
leung
pang
dyadic
formula-
tion
morphology-dependent
resonances
completeness
relation
journal
optical
society
america
1409–1417
1999
lee
leung
pang
dyadic
formula-
tion
morphology-dependent
resonances
perturbation
theory
journal
optical
society
america
1418–1430
1999
sauvan
hugonin
maksymov
lalanne
theory
spontaneous
optical
emission
nano-
size
photonic
plasmon
resonators
physical
review
letters
110
237401
2013
muljarov
doost
langbein
exact
mode
volume
purcell
factor
open
optical
systems
arxiv:1409.6877
cond-mat-mes.hall
2014
muljarov
langbein
zimmermann
brillouin-wigner
perturbation
theory
open
electromag-
netic
systems
european
physics
letters
50010
2010
time-
harmonic
waves
obstacles
cambridge
university
press
2006
martin
multiple
scattering
interaction
koenderink
use
purcell
factors
plas-
mon
antennas
optics
letters
4208–4210
2010
r.-c.
kristensen
young
hughes
quasinormal
mode
approach
modelling
light-emission
propagation
nanoplasmonics
new
journal
physics
113048
2014
zel
dovich
theory
unstable
states
soviet
physics
jetp
542
1961
barrera
est´evez
giraldo
vector
spheri-
cal
harmonics
application
magnetostatics
eu-
ropean
journal
physics
287
1985
snyder
love
optical
waveguide
theory
chapman
hall
1983
lecamp
hugonin
lalanne
theoretical
computational
concepts
periodic
optical
waveguides
optics
express
11042–11060
2007
tai
c.-t.
dyadic
green
functions
electromagnetic
theory
2nd
ieee
press
1994
r.-c.
hughes
design
eﬃcient
single
pho-
ton
source
metallic
nanorod
dimer
quasi-normal
mode
ﬁnite-diﬀerence
time-domain
approach
optics
let-
ters
4235
2014
kristensen
lodahl
mørk
light
propagation
ﬁnite-sized
photonic
crystals
multiple
scattering
using
electric
ﬁeld
integral
equation
journal
optical
society
america
228–237
2010
lasson
mørk
kristensen
three-
dimensional
integral
equation
approach
light
scattering
extinction
cross
sections
local
density
states
quasi-
normal
modes
journal
optical
society
america
1996–2007
2013
used
fdtd
solutions
8.6.3
www.lumerical.com
vlack
dyadic
green
functions
applica-
tions
classical
quantum
nanophotonics
ph.d.
the-
sis
queen
university
2012
kristensen
lasson
gregersen
cal-
culation
normalization
perturbation
quasinormal
modes
coupled
cavity-waveguide
systems
optics
letters
6359
2014
bai
perrin
sauvan
hugonin
j.-p.
lalanne
eﬃcient
intuitive
method
analysis
light
scattering
resonant
nanostructure
optics
express
27371–27382
2013
