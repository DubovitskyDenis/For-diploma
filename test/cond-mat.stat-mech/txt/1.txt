metropolis
monte
carlo
finite
element
algorithm
electrostatic
interactions
lpt-orsay
10-16
martial
mazars∗
laboratoire
physique
th´eorique
umr
8627
universit´e
paris
sud
bˆatiment
210
91405
orsay
cedex
france
dated
october
2018
metropolis
monte
carlo
algorithm
finite
element
method
applied
compute
elec-
trostatic
interaction
energy
charge
densities
described
work
using
finite
element
method
integrate
numerically
poisson
equation
shown
computing
time
obtain
acceptance
probability
elementary
trial
move
principle
depend
number
charged
particles
present
system
pacs
numbers
02.70.dh
02.70.tt
61.20.ja
long
ranged
electrostatic
interactions
particularly
diﬃcult
take
account
correctly
computer
simu-
lation
condensed
matter
present
aim
adequate
methods
accuracy
eﬃciency
ewald
summations
1–3
classical
electrody-
namics
long
ranged
feature
electrostatic
inter-
actions
included
structure
local
partial
diﬀerential
equation
electrostatic
ﬁeld
poisson
laplace
etc
particular
analytical
form
interactions
governed
boundary
conditions
ewald
sums
one
uses
partial
periodic
boundary
con-
ditions
macroscopic
boundary
condition
sur-
face
term
obtain
univocally
energy
systems
5–10
energy
computed
likewise
used
metropolis
algorithm
sample
phase
space
system
monte
carlo
simulations
molecular
dynamics
one
computes
forces
similar
ways
finite
element
method
allows
obtain
numeri-
cal
approximations
partial
diﬀerential
equations
boundary
conditions
12–14
applied
poisson
equa-
tion
deﬁne
poisson
solvers
may
used
com-
pute
electrostatic
ﬁelds
energy
poisson
solvers
used
initio
electronic
structure
calcu-
lations
solids
finite
element
method
combined
ewald
sums
also
proposed
re-
cently
electrostatic
interactions
slablike
geom-
etry
letter
show
use
finite
element
method
obtain
acceptance
probability
trial
moves
metropolis
monte
carlo
algorithms
systems
elec-
trostatic
interactions
work
presented
aims
describe
theoretically
algorithm
considered
eﬃcient
alternative
ewald
methods
detailed
com-
parisons
still
made
main
result
present
work
derivation
electrostatic
energy
trial
conﬁguration
energy
old
con-
ﬁguration
variations
shape
functions
gives
locally
estimate
electrostatic
ﬁeld
eq.19
charge
density
distribution
domain
space
electrostatic
potential
given
pois-
∗electronic
address
martial.mazars
th.u-psud.fr
son
equation
∇2v
−4πρ
boundaries
conditions
must
fulﬁlled
potential
obtain
unique
solution
boundary
conditions
chosen
speciﬁcying
value
electrostatic
potential
dirichlet
prob-
lem
value
electric
ﬁeld
neumann
problem
one
also
show
unique
solution
mixed
boundary
conditions
taking
dirichlet
bound-
ary
conditions
neumann
boundary
conditions
mixed
boundaries
condi-
tions
electrostatic
potential
constrained
−e0
known
functions
called
boundary
conditions
eqs
1-3
deﬁne
so-called
strong
form
boundary-value
problem
ﬁnite
element
method
finite
element
method
starts
deriving
weak
formulation
boundary
value
problem
strong
weak
formulations
boundary-
value
problem
fully
equivalent
weak
formulation
poisson
equation
reads
follows
weighting
functions
variations
ﬁnd
function
∇w.∇v
4πzω
−zγn
ˆn.e0
set
trial
functions
set
weight-
ing
functions
deﬁned
respectively
sobolev
space
degree
one
boundary
conditions
given
called
es-
sential
boundary
conditions
explicitly
involved
deﬁnition
boundary
conditions
given
called
natural
boundary
conditions
incoporated
using
green
ﬁrst
identity
derivation
weak
formulation
essential
boundary
conditions
ﬁnite
values
point
weighting
functions
required
satisfy
homogeneous
counterparts
es-
sential
boundary
conditions
deﬁned
set
eq.
weak
form
boundary-value
problem
finite
element
method
provides
approximation
function
ﬁrst
step
construct
ﬁnite-
dimensional
representations
approxima-
tions
require
sets
associated
mesh
di-
vides
domain
elements
whose
characteristic
length
volume
represented
following
re-
strict
discussion
galerkin
approximation
scheme
finite
element
method
c0-class
instance
see
chap.2
ref
refs
element
domains
nodal
points
shape
functions
associated
nodal
point
deﬁned
numbered
locally
globally
use
following
notations
position
nodal
point
numbered
set
nodal
points
set
nodal
points
lying
called
set
nodal
points
lying
called
function
shape
func-
tion
associated
nodal
point
numbered
note
also
number
nodal
points
require
δij
δij
kronecker
symbol
nodal
points
particular
locations
ap-
proximate
solution
given
finite
element
method
accurate
method
assumes
written
xi∈¯ω
ciφi
constant
i.e
value
node
approximate
solution
weak
form
admits
representation
result
satisfaction
bound-
ary
condition
given
functions
ex-
panded
according
xi∈ω
viφi
unknowns
values
node
xi∈γd
may
easily
obtain
ˆn.e0
xj∈ω
xk∈γd
set
aij
zγn
ˆn.e0


∇φi.∇φj
φiρ
ˆn.e0
matrix
form
weak
formulation
boundary-value
problem
galerkin
approximation
scheme
estimation
therefore
obtained
solving
linear
algebraic
equations
given
obtain
constants
convenient
choices
nodes
shape
functions
matrix
left
handed
side
sparse
boundary
conditions
used
periodic
in-
stance
initio
solid-state
electronic
structure
compu-
tations
molecular
simulations
boundaries
electrostatic
potential
must
fulﬁll
.∇v
.∇v
domain
chosen
parallelepipedic
cell
orthorhombic
triclinic
outward
normal
unit
vector
lattice
vectors
associated
periodic
boundaries
conditions
boundary
con-
ditions
easily
fulﬁlled
clever
global
number-
ing
nodal
points
ref
partial
periodic
boundary
conditions
used
represent
quasi-one
quasi-two
dimensional
systems
nanotubes
surfaces
in-
terfaces
biological
membranes
etc
systems
eqs
applied
directions
spatial
peri-
odicities
eqs
2,3
directions
thus
method
seems
particularly
well
adapted
represen-
tation
systems
partial
periodic
boundary
condi-
tions
set
point
charges
α=1
located
α=1
charge
density
given
xα=1
qαδ
representation
integral
equation
becomes
algebraic
equation
unknowns
one
electrostatic
potential
given
eqs
7,8
solutions
eq.
precisely
xα=1
qαxi∈ω
a−1
jiφi
−xi∈ω
a−1
ˆn.e0
xk∈γd
a−1
stands
inverse
matrix
matrix
de-
ﬁned
eq.
approximation
electric
ﬁeld
−∇v
natural
boundary
conditions
neumann
energy
conﬁguration
given
xi∈ω
xj∈ω
aijvj
elementary
trial
move
particle
numbered
elementary
move
trial
conﬁg-
uration
set
charges
trial
conﬁguration
accepted
rejected
according
metropolis
algorithm
elec-
trostatic
potential
trial
conﬁguration
given
electrostatic
potential
old
conﬁguration
4πqaxj∈ω
a−1
∆φj
∆φj
precisely
approximate
solution
electro-
static
potential
trial
conﬁguration
thus
given
+4πqaxi∈ω
xj∈ω
a−1
∆φj
eqs
obtain
qaxi∈ω
∆φi
+2πq2
axi∈ω
xk∈ω
∆φi
a−1
ik∆φk
last
equation
main
result
letter
may
accept
reject
trial
move
us-
ing
standard
metropolis
scheme
probability
min
exp
trial
move
accepted
new
electrostatic
potential
obtained
updating
using
thus
another
trial
move
may
done
new
conﬁguration
trial
move
changes
loca-
tion
one
charge
case
poly-
atomic
molecules
water
even
complicated
molecules
dna
proteins
rna
etc.
since
equa-
tions
linear
must
include
summa-
tion
charges
involved
trial
move
principle
algorithm
eﬃcient
since
charge
located
one
element
domain
shape
function
diﬀerent
domain
el-
ements
contain
nodal
point
associated
shape
function
nodal
points
domain
element
values
∆φj
deﬁned
non
zero
contribute
eq.
∆φj
computed
evaluate
number
additions
products
needed
scale
4n2
concrete
implementations
method
stan-
dard
nvt
monte
carlo
simulations
one
may
proceed
follows
domain
deﬁned
simulation
box
divided
domain
elements
locations
nodal
points
elements
shape
functions
nodal
point
deﬁned
boundary
condi-
tions
eqs
2,3
applied
step
deﬁnes
matrix
inverse
matrix
computed
stored
initial
conﬁguration
charges
charge
den-
sity
build
step
charge
density
deﬁned
step
contributions
right
handed
side
deﬁned
algebraic
equation
solved
using
matrix
a−1
step
gives
approximation
electrostatic
potential
eq.
electrostatic
energy
initial
conﬁguration
com-
puted
using
eq.
cpu-time
step
scales
number
charges
domain
trial
moves
performed
accepted
rejected
according
metropolis
algorithm
using
averages
accumulated
accord-
ing
matrix
a−1
computed
step
needed
compute
energy
trial
conﬁg-
uration
energy
old
conﬁguration
thus
cpu-time
needed
trial
moves
depend
method
may
also
applied
monte
carlo
simula-
tions
sample
shape
simulation
box
npt
etc.
implementations
steps
done
trial
move
box
shape
principles
monte
carlo
finite
element
algo-
rithm
presented
letter
several
beneﬁts
com-
parison
others
algorithms
electrostatic
long
ranged
interactions
ewald
methods
etc
first
main
beneﬁt
algorithm
local
summations
pairs
particles
done
one
time
whole
computation
step
conse-
quence
cpu-time
needed
compute
acceptance
probability
trial
move
depend
number
particles
system
makes
method
far
eﬃcient
ewald
methods
comparison
mesh
based
ewald
methods
pme
spme
p3m
etc
necessary
assign
charge
mesh
points
charge
keeps
iden-
tity
comparison
auxiliary
ﬁeld
local
algorithm
devel-
oped
refs
one
introduce
gauge
invariant
constrained
auxiliary
ﬁeld
hamiltonian
system
compute
energy
finally
another
important
beneﬁt
algorithm
practical
finite
element
method
one
used
method
solve
numerically
partial
diﬀerential
equa-
tions
therefore
lot
eﬃcient
codes
already
exists
nevertheless
algorithm
presented
present
let-
ter
yet
considered
alternative
exist-
ing
methods
eﬃciency
accuracy
monte
carlo
finite
element
algorithm
com-
pared
eﬃciency
accuracy
ewald
methods
comparison
still
made
preferencially
simple
system
mainly
two
points
strongly
aﬀect
ac-
curacy
eﬃciency
algorithm
first
number
domain
elements
number
nodal
points
critical
convergence
rate
approximate
solutions
electrostatic
potential
two
numbers
de-
ﬁne
size
matrix
a−1
value
large
obtain
accuracy
similar
one
achieved
ewald
methods
eﬃciency
may
drastically
fall
processors
memory
access
problems
second
necessary
compute
energy
system
otherwise
contributions
energy
self
interactions
lost
chap.1
ref
comparisons
ewald
methods
become
diﬃcult
achieve
clearly
implies
finite
elements
c1-class
used
ensure
continuity
electric
ﬁeld
across
bound-
aries
domain
elements
apply
method
molec-
ular
dynamic
simulations
requirement
essential
equation
deﬁnes
unknowns
corresponds
element
c0-class
approximation
continu-
ous
derivatives
continuous
across
boundaries
domain
elements
elements
c1-class
equation
deﬁnes
unknowns
written
xi∈ω
cid:16
viφi
cid:17
δij
∂αφ
notations
equation
shape
functions
partial
derivatives
verify
unknowns
derivatives
one
hand
equa-
tion
number
unknowns
domain
elements
c1-class
increased
comparison
elements
c0-class
thus
size
matrix
a−1
hand
convergence
rate
finite
element
method
c1-class
extremely
better
c0-class
therefore
optimal
choices
shape
functions
structure
domain
elements
etc
made
s.l
leeuw
j.w
perram
e.r
smith
proc
teller
teller
chem
phys.
1087
1953
soc
lond
373
1980
darden
york
pedersen
chem
phys.
10089
1993
deserno
holm
chem
phys.
109
7678
1998
ibid
7694
1998
j.d
jackson
classical
electrodynamics
second
edition
wiley
new
york
1975
e.r
smith
chem
phys.
128
174104
2008
arnold
joannis
holm
chem
phys.
117
2496
2002
t.j.r
hughes
finite
element
method
linear
static
dynamic
finite
element
analysis
dover
publica-
tion
inc.
mineola
new
york
2000
braess
finite
elements
theory
fast
solvers
ap-
plications
solid
mechanics
second
edition.
cam-
bridge
university
press
2001
ramdas
ram-mohan
finite
element
boundary
element
applications
quantum
mechanics.
oxford
university
press
2002
j.e
pask
b.m
klein
p.a
sterne
c.y
fong
comp
s.l
leeuw
j.w
perram
physica
107
179
phys
comm.
135
2001
1981
e.r
smith
stat
phys.
449
1994
l.m
fraser
w.m.c
foukles
rajagopal
r.j.
needs
s.d
kenny
q.j
williamson
phys
rev
1814
1996
h.d
herce
a.e
garcia
darden
chem
phys.
126
124106
2007
metropolis
a.w
rosenbluth
m.n
rosenbluth
a.h.
j.e
pask
p.a
sterne
modelling
simul
mater
sci
eng.
r71
2005
alireza-ghasemi
neelov
goedecker
chem
phys.
127
224102
2007
a.c.
maggs
chem
phys.
117
1975
2002
a.c.
maggs
rottler
comp
phys
comm.
169
160
2005
