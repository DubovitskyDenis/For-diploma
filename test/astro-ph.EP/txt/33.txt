tau
radiative
transfer
code
transmission
spectroscopy
extrasolar
planet
atmospheres
hollis
tessenyi
tinetti
adepartment
physics
astronomy
university
college
london
gower
street
london
wc1e
6bt
abstract
tau
code
line-by-line
radiative
transfer
code
gener-
ally
applicable
modelling
transmission
spectra
close-in
extrasolar
planets
inputs
assumed
pressure-temperature
proﬁle
planetary
atmo-
sphere
continuum
absorption
coeﬃcients
absorption
cross-sections
trace
molecular
absorbers
present
model
well
fundamen-
tal
system
parameters
taken
published
literature
program
calculates
optical
path
planetary
atmosphere
radiation
host
star
quantiﬁes
absorption
due
modelled
compo-
sition
transmission
spectrum
transit
depth
function
wavelength
code
written
c++
parallelised
using
openmp
available
public
download
use
http
//www.ucl.ac.uk/exoplanets/
keywords
radiative
transfer
extrasolar
planets
atmospheric
characterisation
spectroscopy
introduction
discovery
ﬁrst
extra-solar
planet
wolszczan
frail
1992
marked
beginning
entirely
new
area
astronomy
detec-
tion
transiting
exoplanets
mayor
queloz
1995
ﬁrst
time
made
possible
attempt
characterise
planets
outside
solar
system
subsequent
rapid
advances
ﬁeld
led
large
num-
ber
currently
conﬁrmed
planets
predominantly
so-called
hot
jupiters
gas
giants
orbiting
close
parent
stars
planets
exist
extreme
regimes
terms
temperatures
stellar
ﬂuxes
tidal
forces
bridge
gap
planetary
stellar
bodies
hence
wide
variety
models
see
example
showman
guillot
cooper
showman
venot
irwin
fortney
seager
burrows
developed
attempt
understand
orbital
atmospheric
dynamics
email
address
mdjh
star.ucl.ac.uk
hollis
preprint
submitted
computer
physics
communications
july
2018
chemistry
intriguing
objects
retrieve
bulk
atmo-
spheric
compositions
thermal
proﬁles
models
also
extended
understanding
atmospheres
terrestrial
planets
obvious
applicability
search
habitable
worlds
though
data
objects
limited
present
time
observations
forthcoming
making
use
capa-
bilities
aﬀorded
major
future
space
missions
james
webb
space
telescope
jwst
exoplanet
characterisation
observatory
echo
tau
code
radiative
transfer
code
transmission
spectroscopy
infra-red
wavelengths
gaseous
terrestrial
exoplanets
used
exam-
ple
characterising
close-in
hot
jupiters
uses
line-by-line
integration
scheme
model
transmission
radiation
parent
star
atmosphere
orbiting
planet
so-called
forward
model
equating
physi-
cally
observations
radius
ratio
function
wavelength
primary
transit
geometry
allows
user
estimate
abundances
absorbing
molecules
atmosphere
running
code
variety
hypothesised
compositions
comparing
available
observations
speciﬁcally
algorithm
calculates
optical
depth
planetary
at-
mosphere
particular
wavelength
hypothesised
model
bulk
com-
position
trace
molecular
abundances
given
atmospheric
structure
absorbing
behaviour
molecules
rayleigh
scattering
bulk
atmosphere
calculated
speciﬁed
bulk
constituents
opti-
cal
depths
due
trace
molecular
absorption
used
within
geometry
system
calculate
eﬀective
radius
planet
plus
atmosphere
i.e
conventional
radius
modiﬁed
atmospheric
absorp-
tion
transit
depth
hence
calculated
ratio
squared
radii
planet
star
process
repeated
every
wavelength
required
spectral
range
build
spectrum
showing
absorption
function
wavelength
required
input
ﬁles
code
pressure-temperature
p-t
proﬁle
absorption
cross-sections
function
wavelength
species
hypoth-
esised
present
atmosphere
absorption
cross-sections
generally
available
external
sources
see
section
4.1
proﬁle
op-
tional
inputs
sample
ﬁles
provided
altered
required
generated
anew
means
stellar
radius
function
wavelength
either
assumed
constant
default
given
optional
input
code
collision-induced
absorption
coeﬃcients
sample
ﬁles
required
inputs
provided
tar
ball
downloadable
http
//www.ucl.ac.uk/exoplanets/
structure
paper
follows
section
covers
nec-
essary
theory
section
brieﬂy
describes
install
program
section
discusses
detail
inputs
outputs
run
modes
program
struc-
ture
algorithms
finally
section
illustrates
use
model
case
molecules
scatterers
relevant
near-infrared
nir
transmission
spectroscopy
extrasolar
giant
planets
background
theory
2.1.
system
geometry
figure
diagram
illustrating
geometry
primary
transit
light
star
blocked
planet
moves
around
orbit
passes
star
observer
key
able
characterise
exoplanets
infer
vital
information
atmospheric
composition
observation
planetary
transits
e.g
seager
sasselov
brown
tinetti
case
primary
transit
planet
passing
observer
star
shown
figure
light
star
blocked
planet
producing
reduction
observed
ﬂux
reduction
transit
depth
expressed
simply
ratio
radius
planet
radius
star
given
transit
depth
transmission
spectroscopy
name
suggests
deals
transmission
stellar
light
planetary
atmosphere
hence
applies
primary
transit
scenario
particular
probes
terminator
region
part
planet
separating
dayside
nightside
planet
passes
front
star
light
ﬁltered
section
atmosphere
planet
order
reach
earth
introducing
small
nonetheless
measurable
variation
observed
ﬂux
since
diﬀerent
molecules
absorb
stellar
light
diﬀerent
wavelengths
measuring
spectrum
observed
ﬂux
function
wavelength
planet
relative
star
various
absorption
features
identiﬁed
types
amounts
molecules
present
atmosphere
planet
inferred
tau
code
enables
kind
study
used
generate
model
spectra
gaseous
terrestrial
exoplanet
atmospheres
compared
observed
data
e.g
minimising
goodness-of-ﬁt
parameter
order
infer
compositions
see
example
waldmann
danielski
2.2.
radiative
transfer
instructive
consider
simple
absorption
scheme
radiation
passing
gas
e.g
planetary
atmosphere
intensity
start
arbitrary
path
radiation
passes
medium
along
path
weakened
absorption
scattering
material
extinction
eﬀects
expressed
diλ
mass
density
material
m−3
mass
extinction
cross
section
kg−1
radiation
wavelength
sum
absorption
scattering
cross
sections
rearranged
give
diλ
quantities
optical
path
length
optical
depth
deﬁned
respectively
follows
intensity
point
altitude
given
integrating
along
vertical
path
top
atmosphere
exp
cid:18
−σλ
cid:19
monochromatic
intensity
altitude
given
beer-
bouguer-lambert
law
e−τλ
quantifying
absorption
radiation
entering
passing
vertically
atmosphere
information
radiative
transfer
planetary
atmospheres
reader
directed
texts
liou
2.3.
absorption
cross-sections
distance
travelled
atmosphere
hence
important
quan-
tity
determining
transfer
radiation
atmosphere
turn
depends
various
parameters
fundamentally
ex-
tinction
cross-section
equation
neglecting
scattering
simplicity
becomes
absorption
cross-section
calculated
turn
absorption
coeﬃcient
quantity
calculated
considering
quantum
behaviour
molecules
absorb
emit
radiation
example
diﬀerent
molecules
diﬀerent
electronic
transitions
rotate
vibrate
spatially
many
diﬀerent
orientations
conﬁgurations
various
characteristic
frequencies
wavelengths
i.e
diﬀerent
energies
possible
transitions
energy
levels
produce
many
absorption
emission
lines
given
molecule
many
may
occur
wavelengths
represent
diﬀerent
motions
transitions
states
diﬀerent
quantum
numbers
hence
line
list
must
produced
pro-
vides
emission
absorption
line
intensity
function
wavelength
diﬀerent
transition
quantum
states
given
molecule
line
list
used
conjunction
partition
function
molecule
correct
line
shape
i.e
considering
necessary
line
broad-
ening
eﬀects
correct
temperature
pressure
order
combine
transitions
wavelength
gives
variation
absorption
coeﬃcient
wavelength
given
molecule
given
temperature
strength
absorption
quantiﬁed
value
absorption
coeﬃcient
particular
wavelength
absorption
coeﬃcients
normally
expressed
units
giving
absorption
per
unit
mass
attenuation
per
unit
length
density
relative
stp
converted
depending
units
mass
absorption
cross-sections
units
cm2g−1
finally
removing
mass
density
dependence
converting
units
cm2
gives
absorption
cross-sections
function
wavelength
required
code
2.4.
optical
depth
optical
path
stellar
photons
shown
figure
optical
path
calculated
according
geometry
transverse
view
terminator
transit
system
also
requires
knowledge
quantity
molecule
path
expressed
dimensionless
mixing
ratio
ratio
amount
molecule
amounts
molecules
combined
i.e
fractional
abundance
amount
gas
question
relative
rest
atmosphere
hence
concentration
particular
molecule
number
density
m−3
equation
extended
give
optical
depth
altitude
given
molecule
cross-section
figure
geometry
primary
transit
observation
illustrating
paths
stellar
photons
ﬁltered
planetary
atmosphere
total
depth
molecules
path
xi=1
sum
contributions
individual
molecules
present
atmosphere
ﬁnally
converted
equivalent
atmospheric
depth
summing
viewing
paths
zmax
total
transit
depth
wavelength
found
model
actual
stellar
spectrum
thus
required
point
absorption
molecules
present
atmosphere
reduces
overall
ﬁnal
transmitted
ﬂux
wavelength
factor
eﬀect
totally
opaque
body
slightly
larger
radius
transiting
star
absorption
therefore
quantiﬁed
simple
radius
ratio
i.e
conventional
transit
depth
wavelength
spectrum
hence
constructed
showing
absorption
function
wavelength
input
model
parameters
installation
step
download
tar
ball
tau.tar.gz
http
//www.ucl.ac.uk/exoplanets/
step
directory
ﬁle
downloaded
type
ter-
minal
tar
-xvf
tau.tar.gz
extract
source
ﬁles
directory
named
tau
step
compile
make
executable
whilst
tau
directory
type
g++
-lgomp
-fopenmp
tau
./src/tau.cpp
creates
executable
ﬁle
tau
current
directory
header
ﬁle
containing
required
functions
scientiﬁc
constants
located
directory
./tau/src/
output
ﬁles
placed
directory
./tau/out/
required
input
ﬁles
directory
./tau/run/
documentation
code
./tau/doc/
note
compilation
assumed
g++
gcc
gnu
compiler
collection
present
system
may
downloaded
http
//gcc.gnu.org
additionally
library
omp.h
openmp
api
speciﬁcation
parallel
programming
must
installed
obtainable
http
//openmp.org/
implementation
tau
code
line-by-line
radiative
transfer
code
following
ehrenreich
tinetti
calculates
transmittance
radiation
atmosphere
given
temperature
structure
variation
temper-
ature
pressure/altitude
assumed
gaseous
constituent
abundances
mixing
ratios
either
hard-coded
pre-compilation
read
ﬁle
de-
pending
run
mode
deﬁned
spectral
wavelength
grid
calculate
results
resolution
depending
much
detail
required
ﬁnal
model
spectrum
code
assumes
local
thermodynamic
equilibrium
lte
conditions
input
atmospheric
proﬁle
commonly
also
assumes
hydrostatic
equilibrium
atmosphere
divided
horizontal
layers
assumed
suﬃciently
thin
regarded
homogenous
within
layer
layer
hence
uniquely
deﬁned
pressure/altitude
temper-
ature
value
determined
according
precise
nature
p-t
proﬁle
input
user
i.e
existence
exact
form
temperature
inversions
assumption
non-isothermal
atmosphere
optical
path
length
layer
hence
calculated
according
geometry
system
optical
depth
follows
simple
product
length
abundance
type
absorber
present
absorption
cross-section
absorber
layer-segment
along
viewing
path
separately
calculated
contributions
species
optical
depth
may
added
together
optical
depths
may
added
together
provide
value
integrated
along
entire
viewing
path
observer
rayleigh
scattering
within
atmosphere
optionally
opacity
due
collision-induced
absorption
also
included
present
comprehensive
treatment
cloud
scattering
omitted
simplicity
code
written
c++
one
ﬁle
containing
main
program
./tau/src/tau.cpp
one
ﬁle
containing
libraries
scientiﬁc
con-
stants
external
functions
called
main
code
./tau/src/functions.h
includes
functions
openmp
parallel
programming
library
used
retrieve
total
program
runtime
calculations
interpolation
functions
calculations
default
performed
maximum
number
cores
available
single
core
available
program
compiled
normal
program
eﬀectively
run
serial
mode
speedup
factor
parallel
implementation
depends
number
cores
used
also
various
input
factors
number
absorbers
sizes
wavelength
ranges
input
cross-
section
ﬁles
required
resolution
output
spectrum
main
processing
bottleneck
interpolation
absorption
cross-section
ﬁles
wavelength
grid
see
section
4.5
4.1.
input
ﬁles
tau
code
requires
following
ﬁles
run
atmospheric
p-t
proﬁle
absorption
cross-section
function
wavelength
modelled
absorber/trace
molecule
optional
stellar
radius
optional
cia
absorption
coeﬃcients
αcia
optional
cloud
mass
absorption
coeﬃcients
cld
ﬁles
stored
directory
./tau/run/
read
various
points
code
detailed
section
4.5.
note
formats
units
input
ﬁles
must
adhered
absorption
cross-section
data
used
originally
expressed
wavenumbers
must
converted
read
code
example
using
relation
104
wavelength
wavenumber
cm−1
4.1.1.
p-t
proﬁle
atmospheric
proﬁle
ﬁle
see
sample
ﬁle
./tau/run/profile.atm
de-
scribes
temperature
pressure
variation
altitude
given
number
horizontal
layers
top
bottom
model
atmosphere
must
least
4-column
format
separated
non-zero
amount
whitespace
containing
columns
pressure
temperature
altitude
order
least
one
column
mixing
ratios
di-
mensionless
function
altitude
one
column
per
intended
molecular
absorber
modelled
atmosphere
fourth
column
must
still
present
even
run
mode
selected
values
overridden
value
hard-coded
see
section
4.3
columns
must
start
upper-
i.e
lowest
pressure
atmospheric
layer
number
atmospheric
layers
sample
ﬁle
may
value
user
chooses
addition
header
lines
contents
ignored
program
must
present
start
ﬁle
ﬁle
read
function
readatmfile_h
associated
sub-functions
source
code
located
header
ﬁle
atmospheric
proﬁle
calculated
whatever
manner
using
whichever
program
user
chooses
long
ﬁnal
ﬁles
adhere
speciﬁed
format
4.1.2.
absorption
cross-sections
molecular
absorber
cross-section
ﬁles
see
sample
ﬁles
./tau/run/h2o_t.abs1
give
variation
absorption
cross-section
func-
tion
wavelength
one
ﬁle
per
molecule/trace
absorber
present
modelled
atmosphere
2-column
format
separated
non-zero
amount
whitespace
ﬁrst
column
wavelength
second
absorption
cross-section
wavelength
cm2
order
header
associated
ﬁles
ﬁles
1calculated
water
temperature
bt2
line
list
may
either
wavelength-decreasing
wavelength-increasing
order
re-ordering
necessary
performed
within
program
ﬁles
read
function
readabsfile_h
associated
sub-functions
source
code
located
header
ﬁle
absorption
cross-sections
may
obtained
various
external
sources
hitran
exomol
molecular
line
list
projects
may
converted
required
format
units
use
code
care
must
taken
use
appropriate
line
lists
modelled
atmospheric
conditions
since
strong
dependencies
absorption
coef-
ﬁcients
hence
cross-sections
factors
temperature
pressure
detailed
study
temperature
dependence
calculation
molec-
ular
line
lists
however
outside
scope
document
reader
directed
tennyson
yurchenko
information
4.1.3.
stellar
radius
changing
stellar
radius
function
wavelength
may
also
mod-
elled
controlled
cia
cloud
optional
inputs
state
sw_
switches
e.g
sw_rad
stellar
radius
input
ﬁle
e.g
./tau/run/rad_star.rad
must
2-column
format
separated
non-
zero
amount
whitespace
containing
columns
wavelength
stellar
radius
order
wavelength-decreasing
order
header
present
start
ﬁle
read
interpo-
lated
model
grid
function
interpolatecs_h
source
code
located
header
ﬁle
stellar
radius
values
necessary
wavelengths
calculate
absorption
wavelengths
sw_rad
set
range
stellar
radius
input
ﬁle
data
span
wavelength
range
set
model
wavelength
grid
warning
message
displayed
wavelengths
data
provided
set
constant
stellar
radius
value
deﬁned
system
parameters
head
code
may
lead
inaccurate
results
hence
care
taken
stellar
radius
function
wavelength
known
across
entire
desired
wavelength
range
transmission
spectrum
calculation
sw_rad
set
also
note
value
s_rad_fac
overridden
case
eﬀect
4.1.4.
cia
coeﬃcients
ﬁle
containing
collision-induced
absorption
cia
coeﬃcients
e.g
./tau/run/h2_h2_1000k.cia
gives
variation
absorption
coeﬃcient
function
wavelength
2-column
format
separated
non-zero
amount
whitespace
ﬁrst
column
wavelength
second
absorption
coeﬃcient
wavelength
αcia
units
cm−1amagat−2
header
associated
ﬁles
must
wavelength-decreasing
order
ﬁles
read
func-
tion
interpolatecs_h
source
code
located
header
ﬁle
cia
coeﬃcients
may
obtained
external
sources
borysow
units
stated
converted
within
program
richard
diﬀerent
units
requiring
additional
conversion
input
data
span
wavelength
range
model
grid
optical
depths
set
zero
relevant
wavelengths
hence
absorptive
eﬀect
spectrum
extra
cia
desired
e.g
h2-he
collisions
may
added
artiﬁcially
using
cia
ﬁle
another
trace
molecular
absorber
coeﬃcients
converted
cross-sections
per
format
requirements
specifying
mixing
ratio
details
regarding
calculation
found
appendix
4.1.5.
cloud
coeﬃcients
cloud
eﬀects
modelled
version
code
simplicity
al-
though
treated
detail
future
versions
however
scattering
data
available
external
studies
cloud
physics
may
coupled
code
input
ﬁles
e.g
./tau/run/cloud1.cld
since
lorenz-
mie
theory
particle
scattering
complex
dependent
properties
clouds
e.g
particle
shape
size
calculation
parameters
must
performed
externally
optional
input
ﬁles
used
must
contain
cloud
mass
absorption
coeﬃcient
function
wavelength
diﬀerent
cloud
type/composition
ﬁles
must
2-column
format
separated
non-zero
amount
whitespace
containing
columns
wavelength
cld
cm2g−1
order
cloud
mass
absorption
coeﬃcient
wavelength-decreasing
order
header
present
start
ﬁles
read
interpolated
model
grid
function
interpolatecs_h
source
code
located
header
ﬁle
input
data
span
model
wavelength
range
missing
optical
depths
set
zero
i.e
eﬀect
spectrum
cloud
opacity
data
input
vertical
extent
clouds
must
also
set
specifying
maximum
i.e
cloud
base
minimum
pressure
levels
clouds
exist
values
currently
set
every
diﬀerent
input
cloud
ﬁle
simplicity
since
future
versions
code
treat
cloud
eﬀects
completely
capability
specifying
diﬀerent
ver-
tical
extent
type
cloud
default
values
model
clouds
extending
atmospheric
layers
0.1
bar
1.0
mbar
4.2.
output
ﬁles
output
code
ascii
ﬁle
called
tau_output.dat
gives
variation
radius
ratio
planet
star
function
wavelength
per
equation
11.
ﬁle
two
columns
ﬁrst
containing
wavelength
second
containing
amount
absorption
dimensionless
ratio
equation
hence
seen
larger
value
absorption
equivalent
larger
transit
depth
hence
larger
equivalent
planetary
radius
wavelength
plotted
give
full
absorption
spectrum
speciﬁed
molecular
absorbers
given
atmosphere
planet
primary
transit
4.3.
run
modes
current
version
code
option
run
modes
detailed
run
mode
used
calculate
spectrum
single
trace
molecular
absorber
run
mode
used
model
multiple
molecular
absorbers
run
mode
used
quick
run
custom
settings
run
modes
allow
.atm
and/or
.abs
ﬁle
inputs
speciﬁed
command
line
arguments
interactively
run
mode
provides
quick
testing
mode
allowing
interactive
elements
bypassed
input
ﬁles
mixing
ratio
values
hard-coded
prior
compilation
usage
instructions
mode
formats
displayed
typing
./tau
command
line
option
sorting
default
ﬁle
deﬁnitions
found
function
optionsort_h
header
ﬁle
run
mode
run
command
mode
./tau
atmfile
absfile
mode
allows
user
specify
atmospheric
proﬁle
ﬁle
sin-
gle
absorption
cross-section
ﬁle
i.e
model
single
absorber
molecule
atmosphere
run
mode
ﬁles
optional
command
line
arguments
nothing
entered
either
code
reverts
default
ﬁles
./run/profile.atm
./run/h2o_1500k.abs
possible
enter
ﬁlename
atmospheric
proﬁle
leave
code
take
default
absorption
cross-section
ﬁle
.abs
ﬁle
entered
.atm
ﬁle
must
also
mixing
ratios
read
atmospheric
proﬁle
ﬁle
run
mode
run
command
mode
./tau
atmfile
mode
allows
user
specify
command
line
atmospheric
proﬁle
ﬁle
interactively
multiple
absorption
cross-section
ﬁles
i.e
model
arbitrary
number
absorber
molecules
atmosphere
run
mode
ﬁle
optional
command
line
argument
nothing
entered
code
reverts
default
ﬁle
./run/profile.atm
mixing
ratios
read
atmospheric
proﬁle
ﬁle
one
column
per
absorption
cross-section
ﬁle
run
mode
run
command
mode
./tau
mode
allows
user
bypass
interactive
input
spec-
ify
input
ﬁles
mixing
ratios
program
code
pre-compilation
mode
useful
example
comparing
models
at-
mospheric
constituents
mixing
ratios
remain
constant
runs
one
altered
default
atmospheric
pro-
ﬁle
absorption
coeﬃcient
ﬁles
set
ﬁle
functions.h
mixing
ratios
set
10−5
ﬁle
tau.cpp
4.4.
run
parameters
tau
code
requires
certain
parameters
speciﬁed
order
produce
required
model
follows
parameters
deﬁned
user
rad_fac
s_rad_fac
variables
increase
decrease
assumed
planetary
radius
radius
modiﬁers
altered
required
vary
planetary
stel-
lar
radii
percentages
order
improve
observa-
tions
variables
represent
sometimes
signiﬁcant
uncertainties
estimations
planetary
stellar
radii
respectively
deriving
uncertainties
stellar
models
ill-deﬁned
planetary
surface
gas
giants
altitude
generally
unknown
atmospheric
pressure
equal
bar
lambda_min
lambda_max
desired
minimum
maximum
wavelengths
output
spec-
trum
set
lambda_max
lambda_min
program
revert
automatically
adopt
global
minimum
max-
imum
wavelength
values
input
absorption
cross-section
ﬁles
bounds
calculated
spectrum
use
default
wavelength
resolution
lambda_res
default
resolution
output
spectrum
spectral
re-
solving
power
wavelength
deﬁned
wave-
length
range
deﬁned
manually
i.e
lambda_max
lambda_min
resolution
automatically
updated
one
two-thousandth
total
range
sw_rad
sw_cia
sw_cld
switches
include
set
stellar
radius
varying
wave-
length
h2-h2
cia
extra
opacities
due
clouds
respectively
turned
required
cia
general
left
rayleigh
scattering
always
included
becomes
increasingly
impor-
tant
smaller
wavelengths
since
scattering
cross-section
λ−4
cia
provides
base
absorption
ﬂoor
pressure
levels
atmo-
sphere
greater
bar
details
regarding
expressions
used
extra
scattering
eﬀects
found
appendix
cloud
switch
sw_cld
set
equal
number
diﬀerent
clouds
input
ﬁles
supplied
mixdef
default
mixing
ratio
taken
mixing
ratio
trace
molecules
heights
run
mode
parameters
taken
literature
measurements/estimations
radius
planet
modelled
rstar
radius
host
star
semimajor
semi-major
axis
planetary
orbit
grav
gravitational
acceleration
planetary
surface
ms−2
temp
planetary
temperature
rayleigh
scattering
parameters
diﬀerent
bulk
compositions
accounted
using
class
mol
constituent
species
bulk
atmosphere
speciﬁed
variable
type
mol
deﬁned
example
,2.0,2.0e-9,1.0001384
respective
parameters
name
molecule
relative
molec-
ular
weight
particle
radius
refractive
index
assumed
constant
wavelength
class
method
used
add
species
atmos
class
speciﬁed
fractional
abundance
n.b
total
sum
abundances
must
equal
make
entire
bulk
atmosphere
mean
molecular
weight
entire
atmosphere
calculated
along
surface
gravity
pressure
used
cre-
ate
atmospheric
p-t
proﬁle
deﬁnes
scale
height
determines
whether
planet
terrestrial
nature
hydrogen-dominated
giant
filenames
speciﬁed
user
rad_file
ﬁle
containing
stellar
radii
values
cia_file
ﬁle
containing
cia
coeﬃcients
αcia
cld_file
array
ﬁles
containing
cloud
optical
depth
values
τcld
arg_outfile
output
ﬁle
write
ﬁnal
spectrum
4.5.
program
structure
code
run
typing
./tau
mode
input
files
depending
run
mode
required
see
section
4.3
begins
including
required
c++
libraries
scientiﬁc
constants
along
prototypes
external
functions
called
main
code
located
ﬁle
./tau/src/functions.h
run
parameters
initialised
deﬁned
option
sorting
memory
allocation
performed
next
main
stage
read
absorption
cross-sections
modelled
absorber
molecules
see
section
4.1
two-dimensional
vector
container
sigma_array
ﬁrst
declared
resized
one
row
used
store
cross-sections
function
wavelength
molecule
top
row
object
reserved
output
wavelength
grid
order
maintain
well-deﬁned
spectral
resolution
ﬁnal
wavelength
grid
data
absorption
cross-section
ﬁle
read
temporary
containers
cross-interpolated
function
interpolateabs_h
wavelength
grid
deﬁned
using
minimum
maximum
wave-
length
values
either
input
user
taken
automatically
.abs
ﬁles
spacing
given
user-deﬁned
parameter
lambda_res
absorption
cross-section
ﬁles
cover
wavelength
range
determined
lambda_min
lambda_max
values
absorption
cross-sections
molecules
set
zero
regions
hence
molecules
eﬀect
spectrum
throughout
wavelength
ranges
input
data
interpolated
data
ﬁnally
stored
sigma_array
vector
containers
created
hold
data
optional
ﬁle
inputs
radius
rad_star
cia
cia_coeffs
data
one-dimensional
vectors
cloud
data
cld_tau
two-dimensional
vector
optical
depths
function
wavelength
diﬀerent
cloud
type/condition
held
diﬀerent
row
object
depending
states
optional
input
switches
function
interpolatecs_h
may
called
also
interpolate
data
new
wavelength
grid
switches
vectors
initialised
respective
deﬁned
constant
values
detailed
section
4.1
regardless
contents
spec-
iﬁed
ﬁles
even
speciﬁed
ﬁles
exist
cloud
opacity
data
input
cloud
vertical
extent
also
deﬁned
specifying
pressure
levels
cloud
base
top
atmospheric
proﬁle
data
read
code
at-
mospheric
state
parameter
deﬁned
array
ﬂoats
size
equal
number
vertical
layers
read
ﬁle
atmospheric
layer
uniquely
deﬁned
values
pressure
temperature
altitude
variables
mixing
ratios
modelled
absorber
gas
read
simi-
larly
testing
run
mode
hard-coded
atmospheric
state
parameters
also
used
calculate
number
density
vertical
layer
rho
layer
standard
thermodynamic
state
ideal
gas
equations
arranged2
give
layer
boltzmann
constant
pressure
tem-
perature
respectively
layer
ﬁnal
section
code
calculates
path
length
integral
given
equation
molecule
summing
converting
value
equivalent
transit
depth
function
wavelength
program
declares
array
hold
ﬁnal
absorption
values
one
per
wavelength
value
loops
wavelength
number
vertical
layers
ﬁrst
calculate
2note
using
form
equations
eliminates
need
calculate
conventional
density
mass
density
hence
volume
layer
atmosphere
geometric
path
length
altitude
k+j
hence
optical
path
length
product
geometric
path
length
number
density
layers
along
path
optical
path
altitude
tau
found
absorber/scatter
taking
product
optical
path
length
abundance
constituent
calculations
rayleigh
scattering
cia
estimated
cloud
contributions
opacity
also
performed
point
code
since
function
parameters
vary
layer
optical
path
calculation
procedure
extra
opacities
detailed
appendix
finally
equivalent
radius
planet
plus
atmosphere
viewing
paths
i.e
integrated
altitude
function
wavelength
calculated
per
equations
11.
note
equations
code
calculate
half
values
quantities
integral
simply
doubled
due
symmetry
figure
order
ﬁnd
full
values
speciﬁed
output
ﬁle
opened
model
data
written
code
ﬁnishes
call
library
calculate
total
runtime
4.6.
code
validation
order
validate
output
code
comparison
ana-
lytic
solution
may
performed
discussed
lecavelier
des
etangs
howe
burrows
opacity
sources
independent
tem-
perature
pressure
proportional
wavelength
cross-section
may
expressed
form
scaling
law
cid:18
cid:19
slope
observed
planetary
radius
function
logarithm
wavelength
straight
line
gradient
drp
dlnλ
atmospheric
scale
height
kbt
/µg
opacity
source
known
follow
equation
equilibrium
temperature
known
equation
hence
used
calculate
mean
molecular
weight
bulk
atmosphere
conversely
weight
known
approximate
tem-
perature
found
rayleigh
scattering
phenomenon
follows
equation
code
run
opacity
sources
wavelength
region
1.0µm
order
validate
model
performing
check
code
produced
slope
within
analytical
rayleigh
slope
i.e
excellent
agreement
ﬁgure
found
shabram
however
treatment
valid
opacity
sources
vary
signif-
icantly
temperature
pressure
nir
absorption
molecules
general
better
test
validity
code
therefore
obtained
noting
recent
study
using
tau
code
able
infer
molecular
abundances
planet
hd189733b
excellent
agreement
constraints
published
studies
using
variety
diﬀerent
retrieval
methods
see
example
swain
madhusudhan
seager
application
ﬁrst
step
modelling
procedure
obtain
input
ﬁles
correct
formats
p-t
proﬁle
generated
ranging
example
pressure
1.0
10−3
1.0
10+6
nbar
bar
range
covers
relevant
atmosphere
corresponding
altitudes
calculated
level
using
hydrostatic
assumption
atmospheric
scale
height
planetary
surface
gravity
estimated
mass
radius
values
literature
proﬁle
general
isothermal
tobs
planet
since
transmission
observations
currently
able
disentangle
degeneracy
temperature
proﬁle
absorber
abundances
insensitive
exact
form
temperature
proﬁle
absorption
cross-section
data
relevant
molecules
must
obtained
example
hitemp
exomol
line
lists
note
data
may
need
converted
diﬀerent
units
example
absorption
cross-sections
given
units
cm2g−1
need
converted
multiplying
value
mean
molecular
weight
atomic
units
e.g
ch4
co2
avogadro
constant
absorption
cross-sections
calculated
line
lists
ﬁrst
order
temperature
planet
tobs
vary
little
since
atmosphere
unlikely
perfectly
isothermal
ﬁnal
ﬁle
supplied
data
h2-h2
cia
eﬀects
necessary
considering
atmospheric
pressures
approximately
bar
data
taken
literature
example
borysow
converted
speciﬁed
format
correct
units
appropriate
next
step
calibrate
base
level
spectrum
changing
radius
modiﬁers
order
attempt
match
base
level
observations
mixing
ratios
set
zero
i.e
trace
molecular
absorbers
present
eﬀect
model
h2-h2
continuum
minimum
absorption
level
top
trace
molecules
absorb
output
shown
figure
underlying
continuum
always
present
probing
higher
pressures
allows
eﬀective
constraints
placed
minimum
absolute
abundances
trace
absorber
molecules
ﬁrst
calibrated
highest
possible
value
minimum
possible
amounts
molecules
gradually
added
ﬁrst
trace
molecule
consider
adding
model
h2o
since
found
relatively
large
abundances
known
exoplanet
atmospheres
strong
absorber
nir
range
water
characteristic
absorption
bands
wavelengths
around
5.0
7.0
narrower
band
around
3.0
steadily
increasing
broad
band
absorption
wavelength
increases
see
figure
figure
spectra
generated
molecular
absorbers
modifying
radius
factors
order
calibrate
underlying
h2-h2
continuum
base
level
system
parameters
planet
hd189733b
reported
schneider
isothermal
atmosphere
1000k
cia
ﬁle
used
obtained
borysow
1000k
also
note
rayleigh
scattering
evident
large
slope
wavelengths
0.5
s_rad_fac
0.0
s_rad_fac
1.0
s_rad_fac
2.0
0.0230
0.0225
0.0220
0.0215
0.0210
wavelength
microns
process
repeated
adding
one
constituent
time
many
molecules
required
informed
example
results
atmospheric
chemical
equilibrium
models
important
absorbers
include
methane
also
strong
nir
absorber
broad
characteristic
features
carbon
monoxide
dioxide
also
present
much
narrower
absorption
peaks
except
co2
around
14.0
16.0
extra
opacities
remain
molecules
may
added
based
typical
absorption
peaks
atmospheric
chemistry
considerations
examples
output
varying
abundances
methane
carbon
monoxide
carbon
dioxide
shown
figures
conclusion
paper
introduces
tau
code
line-by-line
radiative
transfer
code
transmission
spectroscopy
extrasolar
planets
generally
ap-
plicable
modelling
transmission
radiation
atmo-
spheres
planets
particular
close-in
gas
giants
result
theoretical
transmission
spectrum
planet
given
various
inputs
may
compared
relevant
primary
transit
observations
order
match
spectra
hence
infer
characteristics
atmosphere
question
composition
atmospheric
structure
code
runs
command
figure
adding
h2o
model
mixing
ratio
1.0
10−5
using
zero
oﬀset
rayleigh
cia
baseline
model
figure
absorption
cross-sections
used
water
bt2
line
list
1000k
shape
continuum
clearly
still
seen
water
absorption
lines
extending
higher
atmosphere
shows
spectrum
nir
h2o
absorption
emerging
cia
ﬂoor
shows
model
slightly
lower
model
resolution
larger
scale
0.0222
0.0220
0.0218
0.0216
0.0214
0.0212
0.0224
0.0222
0.0220
0.0218
0.0216
0.0214
0.0212
0.0210
cia
1x10-5
wavelength
microns
1x10-5
wavelength
microns
figure
contribution
ch4
transmission
spectrum
added
top
base
com-
position
mixing
ratio
1.0
10−4
absorption
cross-section
data
exomol
project
900k
1x10-5
1x10-4
0.0224
0.0222
0.0220
0.0218
0.0216
0.0214
0.0212
wavelength
microns
figure
contribution
transmission
spectrum
added
top
base
com-
position
mixing
ratio
1.0
10−4
absorption
cross-section
data
hitemp
1000k
1x10-5
1x10-4
0.0224
0.0222
0.0220
0.0218
0.0216
0.0214
0.0212
wavelength
microns
figure
contribution
co2
transmission
spectrum
added
top
base
composition
mixing
ratio
1.0
×10−5
absorption
cross-section
data
hitemp
1000k
1x10-5
1x10-5
0.0226
0.0224
0.0222
0.0220
0.0218
0.0216
0.0214
0.0212
wavelength
microns
./tau
mode
input
files
proceeds
read
assumed
atmo-
spheric
p-t
proﬁle
absorption
scattering
behaviour
gases
present
interpolates
deﬁned
wavelength
grid
optical
depth
function
wavelength
calculated
line-by-line
integration
scheme
given
input
abundances
trace
constituents
primary
transit
viewing
geometry
program
chemical
equilibrium
code
gcm
model
photochemistry
dynamics
heat
transfer
eﬀects
rainout
assumes
time
variation
atmosphere
studies
using
global
circulation
models
indicate
eﬀects
may
important
necessary
order
accurately
completely
characterise
planetary
atmosphere
consider-
ations
likely
particularly
pertinent
modelling
atmospheres
hot
jupiters
likely
objects
relevant
data
available
ﬁtting
since
objects
likely
tidally
locked
hence
possibly
subject
signiﬁcant
temperature
contrasts
day-
night-sides
extreme
heating
associated
winds
large-scale
circulation
eﬀects
possible
breakdown
hydrostatic
lte
assumptions
infor-
mation
subject
reader
referred
sources
showman
koskinen
code
also
yet
complete
treatment
cloud
physics
terms
detailed
mie
scattering
theory
geometric
approximations
present
model
eﬀects
though
formulation
appear
later
version
however
codes
modelling
eﬀects
perfectly
complementary
tau
provide
extra
data
improve
results
relevant
data
available
sources
e.g
absorption
cross-sections
cloud
types
predicted
present
calcu-
lated
external
program
may
easily
coupled
tau
code
simply
providing
coeﬃcient
ﬁlenames
including
extra
opac-
ities
model
similarly
results
studies
e.g
dynamical
thermochemical
models
terms
modelling
atmospheric
proﬁle
molecules
important
etc
used
conjunction
tau
order
inform
use
code
addition
inclusion
detailed
cloud
modelling
future
work
involve
streamlining
code
treating
inputs
self-consistently
example
calculating
atmospheric
structure
within
code
using
molecular
absorption
collision
data
format
acknowledgments
mdjh
supported
impact/perren
studentship
stfc
studentship
royal
society
university
research
fellow
references
wolszczan
frail
nature
355
1992
145–147
mayor
queloz
nature
378
1995
355–359
showman
guillot
astronomy
astrophysics
385
2002
166–
180
cooper
showman
astrophysical
journal
649
2006
1048–
1063
venot
h´ebrard
ag´undez
dobrijevic
selsis
hersant
iro
bounaceur
astronomy
astrophysics
546
2012
a43
irwin
teanby
kok
fletcher
howett
tsang
wil-
son
calcutt
nixon
parrish
journal
quantitative
spectroscopy
radiative
transfer
109
2008
1136–1150
fortney
lodders
marley
freedman
astrophysical
journal
678
2008
1419–1435
seager
kuchner
hier-majumder
militzer
astrophys-
ical
journal
669
2007
1279–1297
burrows
sudarsky
hubeny
astrophysical
journal
650
2006
1140–1149
tinetti
m.-c.
liang
vidal-madjar
ehrenreich
lecavelier
des
etangs
yung
astrophysical
journal
letters
654
2007
l99–
l102
seager
sasselov
astrophysical
journal
537
2000
916–921
brown
astrophysical
journal
553
2001
1006–1026
waldmann
tinetti
deroo
hollis
yurchenko
tennyson
astrophysical
journal
766
2013
danielski
deroo
waldmann
hollis
tinetti
swain
0.94
2.42
micron
ground-based
transmission
spectra
hot
jupiter
hd-189733b
2013.
revision
k.-n.
liou
introduction
atmospheric
radiation
academic
press
2002
ehrenreich
tinetti
lecavelier
des
etangs
vidal-madjar
selsis
astronomy
astrophysics
448
2006
379–393
tinetti
tennyson
griﬃth
waldmann
philosophical
trans-
actions
royal
society
mathematical
physical
engineering
sciences
370
2012
2749–2764
barber
tennyson
harris
tolchenov
monthly
notices
royal
astronomical
society
368
2006
1087–1094
rothman
gordon
barbe
benner
bernath
birk
boudon
brown
campargue
j.-p.
champion
chance
coudert
dana
devi
fally
j.-m.
flaud
gamache
gold-
man
jacquemart
kleiner
lacome
laﬀerty
j.-y
mandin
massie
mikhailenko
miller
moazzen-ahmadi
naumenko
nikitin
orphal
perevalov
perrin
predoi-cross
rins-
land
rotger
ˇsimeˇckov´a
smith
sung
tashkun
ten-
nyson
toth
vandaele
vander
auwera
journal
quantitative
spectroscopy
radiative
transfer
110
2009
533–572
tennyson
yurchenko
monthly
notices
royal
astronomical
society
425
2012
21–33
borysow
jorgensen
zheng
astronomy
astrophysics
324
1997
185–195
borysow
jørgensen
journal
quantitative
spectroscopy
radiative
transfer
2001
235–255
richard
gordon
rothman
abel
frommhold
gustafs-
son
j.-m.
hartmann
hermans
laﬀerty
orton
smith
tran
journal
quantitative
spectroscopy
radiative
transfer
113
2012
1276–1285
lecavelier
des
etangs
pont
vidal-madjar
sing
astronomy
astrophysics
481
2008
l83–l86
howe
burrows
astrophysical
journal
756
2012
176
shabram
fortney
greene
freedman
astrophys-
ical
journal
727
2011
swain
vasisht
tinetti
nature
452
2008
329–331
swain
vasisht
tinetti
bouwman
chen
yung
deming
deroo
astrophysical
journal
letters
690
2009
l114–
l117
madhusudhan
seager
astrophysical
journal
707
2009
24–39
rothman
gordon
barber
dothe
gamache
goldman
perevalov
tashkun
tennyson
journal
quantitative
spec-
troscopy
radiative
transfer
111
2010
2139–2150
schneider
dedieu
sidaner
savalle
zolotukhin
astronomy
astrophysics
532
2011
moses
visscher
fortney
showman
lewis
griﬃth
klippenstein
shabram
friedson
marley
freedman
astrophysical
journal
737
2011
burrows
sharp
astrophysical
journal
512
1999
843–863
showman
fortney
lian
marley
freedman
knutson
charbonneau
astrophysical
journal
699
2009
564–584
koskinen
aylward
smith
miller
astrophys-
ical
journal
661
2007
515–526
kok
stam
icarus
221
2012
517–524
bates
planetary
space
science
1984
785–790
jackson
classical
electrodynamics
wiley
3rd
edition
1999
dalgarno
kingston
proceedings
royal
society
london
series
mathematical
physical
sciences
259
1960
424–431
allen
allen
astrophysical
quantities
springer
4th
edition
2000
sneep
ubachs
journal
quantitative
spectroscopy
radiative
transfer
2005
293–310
born
optik
ein
lehrbuch
der
elektromagnetischen
lichttheorie
julius
springer
berlin
1933
vardya
astrophysical
journal
135
1962
303
sharp
burrows
astrophysical
journal
supplement
series
168
2007
140–166
ackerman
marley
astrophysical
journal
556
2001
872–
884
appendix
opacities
due
scattering
transmission
atmosphere
may
additionally
decreased
ex-
tra
absorption
scattering
eﬀects
rayleigh
scattering
collision-
induced
absorption
cia
size
scattering
particle
expressed
form
size
parameter
2πa
a.1
particle
characteristic
dimension
light
wavelength
rayleigh
scattering
cause
diﬀuse
sky
radiation
makes
sky
appear
blue
caused
scattering
electromagnetic
radiation
particles
much
smaller
wavelength
radiation
i.e
small
size
parameter
regime
scattering
larger
particles
applicable
example
considering
transmission
radiation
clouds
cal-
culated
using
geometric
approximation
lorenz-mie-debye
theory
reduces
rayleigh
approximation
small
cloud
scattering
im-
plemented
version
code
since
calculation
mie
solutions
depends
complex
manner
factors
particle
size
distribution
cloud
precise
shape
scattering
particles
hence
re-
quires
detailed
cloud
models
photochemical
dynamical
forward
scattering
models
see
example
kok
stam
outside
scope
project
collision-induced
absorption
hand
depend
size
parameter
occurs
regions
atmosphere
high
pressure
i.e
lower
atmosphere
along
long
absorbing
paths
common
diatomic
molecules
normally
absorb
infra-red
since
symmetry
means
lack
permanent
dipole
moment
hence
rotational
vibrational
energy
levels
ex-
cited
absorption
radiation
however
collision
processes
occur
high
pressure
environments
induce
dipole
moment
hence
molecules
suddenly
become
visible
absorption
hot
jupiters
cia
due
hydrogen
pairs
clearly
important
since
hydrogen
abundant
atmospheres
continuum
produced
transmission
spectra
producing
eﬀective
absorption
ﬂoor
atmospheric
level
infra-red
radiation
penetrate
appendix
a.1
rayleigh
scattering
optical
depth
due
rayleigh
scattering
given
scattering
particles
concentration
along
path
rpath
zpath
zpath
a.2
mixing
ratio
scattering
particle
number
density
bulk
atmosphere
composed
mixture
species
e.g
mixes
hot
jupiters
overall
cross-section
simply
weighted
sum
constituents
bulk
atmosphere
i.e
constant
abundance
proﬁles
optical
depth
becomes
zpath
tot
zpath
rayleigh
scattering
cross-section
given
128π5
3λ4
π5a6
128
a.3
a.4
polarisability
particle
real
part
refrac-
tive
index
scattering
particle
radius
molecular
anisotropy
correction
factor
hence
rayleigh
scattering
function
electric
polaris-
ability
scattering
particles
independent
density
scattering
medium
wavelength
dependence
λ−4
equation
used
function
scatterrayleigh_h
located
header
ﬁle
since
rayleigh
cross-section
function
wave-
length
particle
properties
atmospheric
layer
computational
expense
saved
calling
function
per
bulk
atmosphere
species
start
wavelength
loop
wavelength
species
class
mol
arguments
function
reads
initialises
con-
verts
quantities
appropriate
using
equation
calculate
species
rayleigh
cross-section
given
parameters
appropriate
king
correc-
tion
factor
molecular
asymmetry
necessary
returned
ﬁnal
rayleigh
cross-section
bulk
atmosphere
wavelength
tot
weighted
sum
constituent
species
atmospheric
layer
total
cross-section
multiplied
layer
optical
path
length
hence
contributions
every
layer
summed
give
total
rayleigh
optical
depth
wavelength
per
equation
a.3
noted
previously
treatment
rayleigh
scatter
valid
small
size
parameters
condition
tested
main
inte-
gration
loop
cutoﬀ
deﬁned
arbitrarily
valid
regions
deﬁned
wavelength
range
warning
printed
rayleigh
scattering
opacity
included
overall
sum
wavelengths
formulation
also
subject
assumption
absorption
par-
ticles
negligible
i.e
imaginary
part
refractive
index
negligible
particles
purely
scattering
refractive
indices
constant
wavelength
though
see
example
dalgarno
kingston
bates
formulation
therefore
approximate
calculation
rayleigh
scatter
although
complex
aspects
refractive
in-
dex
changing
wavelength
temperature
pressure
considered
insigniﬁcant
incorporated
code
would
required
treat
problem
fully
sample
values
refractive
indices
par-
ticle
sizes
published
code
taken
calculated
using
values
expressions
allen
using
lorentz-lorenz
approximation
low
density
gases
validated
values
expressions
born
vardya
lecavelier
des
etangs
appendix
a.2
collision-induced
absorption
cia
calculated
function
scattercia_h
called
external
absorption
coeﬃcients
cm−1amg−2
previously
interpolated
model
wavelength
grid
function
interpolatecs_h
atmospheric
fraction
return
value
absorption
cross-section
αcia
m5mol−2
full
optical
depth
dependent
densities
scattering
particle
types
every
layer
along
path
τcia
zpath
a.5
cia
two
particles
hence
h2-h2
absorption
optical
depth
τcia
zpath
zpath
a.6
therefore
within
function
read-in
coeﬃcients
converted
units
cm−1amg−2
units
cm5mol−2
using
variable
conv_factor
divides
coeﬃcients
square
loschmidt
number
number
molecules
one
amagat
stp
function
converts
coeﬃcient
units
m5mol−2
returns
gives
dimensionless
value
τcia
required
multiplying
coeﬃcients
mol
m−3
equation
a.6
however
cia
coeﬃcients
example
hitran
see
richard
already
units
cm5mol−2
also
used
simply
setting
value
conv_factor
within
function
appendix
a.3
cloud
opacity
estimation
basic
estimation
optical
depth
due
presence
clouds
also
included
code
ﬁles
containing
relevant
absorption
coeﬃcients
speciﬁed
inputs
program
following
sharp
burrows
cld
cm2g−1
provided
cloud
cloud
mass
absorption
coeﬃcient
optical
depth
found
converting
cloud
absorption
coeﬃcient
αcld
cm5mol−2
τcld
zpath
αcld
ρcld
a.7
ρcld
mass
density
cloud
along
path
density
found
interpolating
speciﬁed
pressure
levels
deﬁne
vertical
extent
cloud
following
density
proﬁles
ack-
erman
marley
ln|ρcld|
ln|p|
units
ρcld
converted
appropriate
absorption
coeﬃcients
estimate
optical
depth
obtained
per
equation
a.7
