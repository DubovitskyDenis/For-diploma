practical
fast
quantum
random
number
generation
based
photon
arrival
time
relative
external
reference
you-qi
nie,1
hong-fei
zhang,1
zhen
zhang,3
jian
wang,1
xiongfeng
ma,3
jun
zhang,1
jian-wei
pan1
hefei
national
laboratory
physical
sciences
microscale
department
modern
physics
university
science
technology
china
hefei
anhui
230026
china
synergetic
innovation
center
quantum
information
quantum
physics
university
science
technology
china
hefei
anhui
230026
china
center
quantum
information
institute
interdisciplinary
information
sciences
tsinghua
university
beijing
100084
china
dated
october
2018
present
practical
high-speed
quantum
random
number
generator
timing
single-photon
detection
relative
external
time
reference
measured
raw
data
bias
raw
data
substantially
reduced
compared
previous
realizations
raw
random
bit
rate
generator
reach
109
mbps
develop
model
generator
evaluate
min-entropy
raw
data
toeplitz
matrix
hashing
applied
randomness
extraction
ﬁnal
random
bits
able
pass
standard
randomness
tests
electronic
mail
zhangjun
ustc.edu.cn
random
numbers
wide
range
applications
daily
life
encryp-
tion
monte
carlo
simulation
statistical
analysis
lottery
mainly
two
kinds
random
number
generators
pseudo-random
number
generators
prngs
true
ran-
dom
number
generators
trngs
prng
generates
bitstreams
based
deterministic
algorithms
may
need
initial
random
seed
input
since
entropy
increase
via
deterministic
algorithms
generated
numbers
truly
random
restricts
application
certain
ﬁelds
especially
cryptographic
usage
randomness
trng
hand
based
fundamental
principles
physics
indeterministic
nature
quantum
mechanics
allows
construct
quantum
random
number
generators
qrngs
whose
output
predicted
appropriate
modeling
one
prove
generated
bits
information-theoretically
random
certain
data
post-processing
called
randomness
extraction
many
qrng
schemes
proposed
past
decade
based
variety
principles
natural
way
construct
qrngs
based
random
path
selection
single
photons
arriving
50/50
beam
splitter
1–3
single-photon
detector
used
output
port
detect
path
single
photons
pass
kind
qrng
generate
one
random
bit
per
detection
event
e.g.
bit
one
port
bit
consequence
speed
type
qrngs
limited
detector
count
rate
ﬁnal
random
number
generation
rate
less
one
bit
per
detection
event
moreover
generated
raw
random
bits
usually
biased
due
device
imperfections
unbalanced
split
ratio
detection
eﬃciency
mismatch
recently
measurement
photon
arrival
time
explored
method
generating
high-speed
random
numbers4–10
type
qrngs
shown
fig
photons
emitted
continuous-wave
laser
diode
measured
single-
photon
detector
time
intervals
successive
detection
events
recorded
raw
data
one
detection
event
principle
generate
random
bits
depends
time
resolution
measurement
compared
aforementioned
based
qrng
scheme
whose
generation
rate
limited
detector
count
rate
speed
photon
arrival
time
based
qrng
scheme
reach
times
higher
however
drawback
scheme
follows
exponential-family
distribution
hence
raw
random
bits
highly
biased
fact
min-entropy
raw
data
widely
used
quantify
randomness
relatively
small
practice6,8,10
therefore
obtained
spad
ref
att
stop
start
tdc
fpga
fig
previous
qrng
schemes
measuring
time
intervals
successive
photons
qrng
scheme
using
external
time
reference
experimental
setup
scheme
random
bit
generation
rate
would
substantially
reduced
due
large
bias
raw
data
remove
bias
various
software-based
post-processing
methods
hash
function6
resilient
function8
discretized
encoding10
used
hardware-based
schemes
also
employed
remove
bias
due
distribution
example
carefully
shaping
laser
pulses
approximately
follow
uniform
distribution7
hardware
would
increase
complexity
system
nevertheless
methods
essentially
partial
randomness
extraction
done
post-processing
solve
issue
present
qrng
scheme
based
photon
arrival
time
measurement
takes
advantage
external
time
reference
shown
fig
single-photon
detector
used
detect
photons
emitted
highly
attenuated
laser
time
diﬀerence
photon
detection
external
time
reference
measured
raw
data
later
show
distribution
approximately
uniform
practical
implementation
hence
min-entropy
raw
data
close
randomness
photon
arrival
time
stems
photon
number
distribution
laser
given
time
period
photon
number
follows
poisson
distribution
mean
photon
number
characterizes
laser
intensity
e−λt
shown
fig
set
time
period
external
reference
divide
period
small
time
bins
...
τnb
i−1
given
photon
detected
time
period
shown
photon
appears
small
time
bin
probability
1/nb
device
imperfections
multi-photon
emission
detector
dead
time
detector
dark
counts
would
degrade
randomness
hence
lower
min-entropy
raw
data
eﬀects
taken
consideration
randomness
extraction
experimental
setup
qrng
shown
fig
laser
attenuated
variable
optical
attenuator
att
da-100
laser
intensity
chosen
less
one
photon
detection
happens
time
period
average
photons
detected
silicon
single-photon
avalanche
diode
spad
id100-smf20-std
dead
time
maximum
count
rate
13.9
mcps
continuous
light
illumination
measure
timing
photon
detections
design
high-performance
timing
mea-
surement
electronics
160
time
resolution
using
time-to-digital
converter
tdc
chip
tdc-gpx
external
time
reference
used
start
tdc
detection
signal
spad
used
stop
tdc
output
fed
high-speed
ﬁeld-programmable
gate
array
fpga
altera
stratix
raw
random
bits
read
personal
computer
via
usb2.0
raw
data
qrng
follows
uniform
distribution
closely
shown
fig
ideal
uniform
distribution
probability
photon
detection
falling
bins
/tb
1/nb
experiment
number
bins
256
time
reference
period
40.96
test
take
800
raw
data
calculate
probability
time
bin
result
compared
theoretical
value
1/256
shown
fig
one
see
raw
data
good
quality
randomness
observation
conﬁrmed
later
post-processing
min-entropy
raw
data
evaluated
close
quantitatively
evaluate
randomness
raw
data
need
model
system
carefully
ﬁgure
facts
would
introduce
bias
major
device
imperfections
examined
detector
eﬃciency
unity
model
eﬃciency
followed
perfect
detector
equivalently
detector
eﬃciency
viewed
part
source
intensity
attenuation
thus
average
photon
number
x10-3
4.00
3.95
3.90
3.85
3.80
3.75
3.70
3.65
3.60
theory
experiment
120
150
180
210
240
bin
number
fig
experimental
solid
line
versus
theoretical
dashed
line
probability
distribution
256
bins
800
raw
data
replaced
detector
dark
counts
may
introduce
noise
experiment
dark
count
rate
cps
comparing
detection
count
rate
13.9
mcps
eﬀect
dark
count
negligible
spad
dead
time
dead
time
period
time
detector
inactive
detection
model
regard
dead
time
shift
detection
event
external
time
reference
shift
aﬀect
randomness
raw
data
probability
multi-photon
emission
attenuated
laser
nonzero
since
set
time
reference
period
smaller
detector
dead
time
get
one
detection
period
photons
appear
period
given
ideal
detector
used
detection
events
small
time
bins
τn1
τn2
τnk
announced
however
experiment
ﬁrst
detection
event
τˆn
recorded
raw
data
min
therefore
detection
event
conditional
probability
getting
result
given
photons
appear
period
i|k
randomness
raw
data
evaluated
min-entropy
deﬁned
log
max
detection
event
probability
time
bin
thus
need
ﬁgure
detection
event
highest
probability
one
easily
see
1|k
largest
upper
bound
given
1|k
ke−λt
e−λt
k=1
k=1
k=1
e−λt
e−λt
e−λt
ke−λt
1−e−λt
normalizing
factor
lower
bound
min-entropy
scheme
given
log
max
log
log
log
e−λt
log
one
see
min-entropy
depends
experimental
parameter
related
spad
count
rate
measure
raw
random
bit
rates
diﬀerent
spad
count
rates
shown
fig
random
bit
rate
linearly
increases
spad
count
rate
109
mbps
detector
saturation
rate
13.9
mcps
minor
deviations
experimental
theoretical
values
mainly
caused
data
loss
process
timing
measurement
tdc
chip
periodically
requires
partial
reset
continuous
operation
spad
count
rate
13.9
mcps
parameter
1.52.
substitute
parameters
estimate
min-entropy
raw
data
0.88
per
bit
apply
universal2
hash
function
toeplitz
matrix
extract
ﬁnal
random
bits11,12
toeplitz
matrix
size
extract
m-bit
uniform
string
bit
raw
data
min-entropy
greater
m/n
data
post-processing
take
3.36
107
2.95
107.
software
implementation
toeplitz
matrix
120
100
theory
experiment
count
rate
mcps
fig
raw
random
bit
rate
function
spad
count
rate
hashing
based
fast
fourier
transform
fft
applied
randomness
extraction
randomness
extraction
ﬁnal
random
bit
rate
reaches
mbps
qrng
system
run
stably
raw
bit
rate
109
mbps
random
bits
acquired
randomness
extraction
experiment
employ
nist
statistical
test
suite13
assess
randomness
ﬁnal
data
data
ﬁles
size
randomly
selected
testing
ﬁles
pass
nist
tests
one
test
results
shown
table
also
test
random
data
ﬁles
diﬀerent
sizes
generated
diﬀerent
spad
count
rates
pass
nist
tests
improve
random
bit
generation
rate
qrng
system
one
use
higher
count
rate
detectors
higher
time
resolution
tdcs
example
silicon
photon
multiplier
maximum
count
rate
430
mcps14
along
high-precision
tdc
time
resolution15
may
yield
generation
rate
gbps
summary
design
test
practical
high-speed
qrng
based
photon
arrival
time
laser
high
min-entropy
raw
data
generated
timing
measurement
single-photon
detection
relative
external
time
reference
compared
previous
photon
arrival
time
based
qrng
schemes
scheme
signiﬁcantly
eliminate
bias
existing
raw
data
generate
almost
uniformly
distributed
raw
bits
also
model
generator
evaluate
min-entropy
raw
data
taking
account
imperfections
qrng
detection
eﬃciency
dark
count
dead
time
single-photon
detector
multi-photon
emission
laser
source
experiment
maximum
raw
random
bit
rate
reaches
109
mbps
randomness
table
typical
test
result
random
bits
tests
produce
multiple
outcomes
p-values
proportions
worst
outcomes
selected
since
signiﬁcance
level
tests
0.01
p-value
larger
0.01
proportion
0.98.
statistical
test
p-value
proportion
result
frequency
0.329850
0.994
pass
block
frequency
0.194813
0.988
pass
cumulative
sum
0.490483
0.994
pass
runs
0.366918
0.990
pass
longest
run
0.368587
0.987
pass
rank
fft
0.701366
0.986
pass
0.735908
0.988
pass
non
overlapping
template
0.017912
0.988
pass
overlapping
template
0.352107
0.985
pass
universal
0.834308
0.988
pass
approximate
entropy
0.881662
0.989
pass
random
excursions
0.106666
0.987
pass
random
excursions
variant
0.173452
0.992
pass
serial
0.189625
0.988
pass
linear
complexity
0.222480
0.992
pass
extraction
fft-based
toeplitz
matrix
hashing
ﬁnal
random
bits
reach
rate
mbps
able
pass
standard
randomness
tests
simplicity
robustness
qrng
scheme
allows
applications
various
practical
situations
acknowledge
insightful
discussions
wang
work
ﬁnancially
supported
national
basic
research
program
china
grant
2013cb336800
national
high-tech
program
grant
2011aa010802
national
natural
science
foundation
china
grant
61275121
chinese
academy
sciences
acknowledge
ﬁnancial
support
national
basic
research
program
china
grants
2011cba00300
2011cba00301
references
rarity
owens
tapster
mod
opt
2435
1994
jennewein
achleitner
weihs
weinfurter
zeilinger
rev
sci
instrum
1675
2000
stefanov
gisin
guinnard
guinnard
zbinden
mod
opt
595
2000
kwiat
jeﬀrey
altepeter
u.s.
patent
application
20060010182
january
2006
l¨utkenhaus
cohen
h.-k.
u.s.
patent
7197523
march
2007
wayne
jeﬀrey
akselrod
kwiat
mod
opt
0516
2009
wayne
kwiat
opt
express
9351
2010
wahl
leifgen
berlin
r¨ohlicke
rahn
benson
appl
phys
lett
171105
2011
9h.-q
xie
l.-a
appl
opt
7760
2005
10s
wang
l.-a
h.-q
g.-j
zhai
opt
soc
124
2013
11f
zheng
h.-k.
opt
express
12366
2012
12x
tan
h.-k.
phys
rev
062327
2013
13a
rukhin
soto
nechvatal
smid
barker
leigh
levenson
vangel
banks
heckert
dray
nist
special
publication
800-22
revision
2010
see
http
//www.nist.gov/customcf/get_pdf.cfm
pub_id=906762
14p
eraerds
legr´e
rochas
zbinden
gisin
opt
express
14539
2007
15m
wahl
rahn
r¨ohlicke
kell
nettels
hillger
schuler
erd-
mann
rev
sci
instrum
123113
2008
