recursive
algorithm
trees
forests
song
guo
victor
guo1
school
mathematical
sciences
huaiyin
normal
university
huai
jiangsu
223300
people
republic
china
guosong77
hytc.edu.cn
jwguo
hytc.edu.cn
abstract
trees
rooted
trees
generously
studied
litera-
ture
forest
set
trees
rooted
trees
give
recurrence
relations
number
kind
rooted
forest
roots
roots
classical
formulas
counting
various
trees
rooted
trees
bipartite
trees
tripartite
trees
plane
trees
k-ary
plane
trees
k-edge
colored
trees
follow
immediately
recursive
relations
keywords
forests
rooted
trees
bipartite
trees
tripartite
trees
plane
trees
k-edge
colored
trees
subject
classiﬁcations
05c05
05a15
05a19
introduction
notations
famous
cayley
formula
counting
trees
states
number
labeled
trees
nn−2
clarke
ﬁrst
gives
reﬁned
version
cayley
formula
setting
recurrence
relation
erd´elyi
etherington
gives
bijection
semilabeled
trees
partitions
bijection
also
discovered
haiman
schmitt
general
bijective
algorithm
given
chen
aigner
ziegler
book
collected
four
diﬀerent
proofs
cayley
formula
refer
reader
several
recent
results
enumeration
trees
goal
paper
establish
simple
linear
recurrences
certain
forests
roots
forests
roots
one
deduce
several
classical
results
counting
trees
suppose
set
forests
rooted
trees
roots
denoted
vertex
subtree
rooted
denoted
say
vertex
descendant
vertex
i.e.
path
root
vertex
denoted
1corresponding
author
edge
tree
forest
vertex
call
father
vertex
child
vertex
father
child
sometimes
also
say
degree
vertex
rooted
tree
number
children
denoted
degt
degf
usual
vertex
degree
zero
called
leaf
unrooted
labeled
tree
treated
rooted
tree
smallest
vertex
chosen
root
moreover
set
trees
use
denote
subset
elements
satisfying
condition
fundamental
recursion
one
main
results
follows
theorem
2.1
following
recurrence
relation
k−1
n|f
2.1
proof
suppose
k−1
first
remove
subtree
add
new
tree
forest
second
descendant
new
forest
must
descendant
exchange
labels
vertices
thus
obtain
forest
conversely
forest
vertex
subtree
trees
subtree
attach
exchange
labels
vertices
proof
follows
fact
vertices
altogether
cid:3
attach
vertex
clear
n−1
2.2
following
corollaries
corollary
2.2
cayley
number
labeled
trees
vertices
nn−2
corollary
2.3
cayley
clarke
number
rooted
trees
n+1
vertices
speciﬁc
root
root
degree
cid:0
n−1
k−1
cid:1
nn−k
proof
follows
2.1
2.2
nn−k−1
figure
example
theorem
2.1
exchanging
labels
vertices
establish
bijection
therefore
knn−k−1
one
see
number
forests
vertices
trees
cid:19
cid:18
cid:18
cid:19
knn−k−1
cid:18
cid:19
nn−k
cid:3
remark
worth
mentioning
third
fourth
proofs
cayley
formula
aigner
ziegler
book
chapter
third
proof
chapter
essentially
due
riordan
r´enyi
follows
let
denote
number
forests
consisting
trees
vertices
appear
diﬀerent
trees
consider
forest
suppose
adjacent
vertices
removing
vertex
obtain
forest
trees
reconstruct
ﬁrst
ﬁxing
selecting
neighbors
forest
gives
n−k
xi=0
cid:18
cid:19
tn−1
k−1+i
prove
cayley
formula
induction
fourth
proof
chapter
due
pitman
follows
let
denote
set
forests
consist
rooted
trees
sequence
forests
called
reﬁning
sequence
fi+1
obtained
removing
one
edge
fix
denote
number
rooted
trees
containing
number
reﬁning
sequences
ending
easy
see
nk−1
counting
two
ways
ﬁrst
starting
tree
secondly
starting
hence
nk−1
since
contains
isolated
nodes
get
fn,1
nn−1
thus
cayley
formula
therefore
proof
cayley
formula
third
proof
chapter
recursive
latter
requires
algebraic
computa-
tions
proof
similar
pitman
proof
diﬀerence
pitman
considers
forests
rooted
trees
consider
forests
roots
pitman
proof
uses
idea
double
counting
proof
little
straightforward
combinatorial
bipartite
trees
tripartite
trees
complete
k-partite
graph
kn1
...
graph
vertex
set
partitioned
parts
|vi|
two
vertices
adjacent
belong
part
spanning
tree
kn1
...
called
k-partite
tree
corollary
3.1
fiedler
sedl´aˇcek
number
span-
ning
trees
complete
bipartite
graph
rs−1sr−1
proof
let
denote
forests
rooted
bipartite
trees
roots
set
note
edge
connecting
vertices
belong
set
similar
way
theorem
2.1
k−1
s|f
3.3
easy
see
rs−1
complete
proof
3.3
3.4
3.4
cid:3
corollary
3.2
r−1
xi=1
xj=1
cid:19
cid:18
cid:18
cid:19
ij−1ji−1
s−j−1
r−i−1
rs−1sr−2
set
proof
follows
3.3
3.4
rs−1sr−2
hand
trees
forest
bipartite
trees
applying
corollary
3.1
complete
proof
cid:3
corollary
3.3
austin
number
spanning
trees
complete
tripartite
graph
t−1
r−1
s−1
proof
let
denote
set
forests
rooted
tripartite
trees
roots
respectively
respectively
exactly
way
proof
corollary
3.1
k−1
follows
r−1|f
following
important
fact
3.5
3.6
tree
forest
diﬀerent
choose
root
tree
left-hand
side
choose
right-hand
side
similarly
proof
corollary
3.1
get
k−1
3.7
hand
r+s−1
t−1
3.8
fact
forests
child
t−1
forests
father
child
comes
proof
follows
combining
3.5
3.8
cid:3
remark
bijective
proof
corollary
3.1
found
stanley
125-
126
austin
proved
number
spanning
trees
complete
k-partite
graph
kn1
...
nk−2
n1−1
nk−1
eˇgecioˇglu
remmel
found
bijective
proof
enumeration
bipartite
trees
tripartite
trees
later
found
bijection
k-partite
trees
reader
encouraged
ﬁnd
simple
proof
austin
formula
modifying
recursive
algorithm
trees
forests
plane
trees
labeled
plane
tree
rooted
labeled
tree
children
vertex
linearly
ordered
denote
set
forests
labeled
plane
trees
vertices
roots
corollary
4.1
following
holds
k−1
4.9
proof
ﬁrst
step
theorem
2.1.
reversal
step
suppose
ﬁrst
case
deg
ways
attach
vertex
trees
subtree
second
case
proof
follows
fact
xx∈v
degf
corollary
4.2
number
labeled
plane
trees
n+1
vertices
i.e.
number
unlabeled
plane
trees
vertices
well-known
catalan
number
cid:19
cid:18
proof
follows
4.9
n+1
number
labeled
plane
trees
n+1
root
n+1
total
number
plane
trees
times
cid:3
say
plane
tree
non-leaf
vertex
labeled
leaves
labeled
vertices
labeled
denote
set
forests
non-leaf
vertex
labeled
plane
trees
vertices
leaves
roots
theorem
4.3
following
holds
r−1
n+1
p+1
4.10
proof
proof
analogous
theorem
2.1.
time
subtree
removed
root
left
considered
unlabeled
vertex
thus
number
leaves
unlabeled
vertices
forest
increased
one
reverse
clear
straightforward
cid:3
example
given
figure
figure
example
theorem
4.3.
plane
tree
called
k-ary
plane
tree
every
non-leaf
vertex
degree
corollary
4.4
number
forests
non-leaf
vertex
labeled
k-ary
plane
trees
vertices
roots
equals
cid:18
cid:19
proof
recurrence
4.10
also
holds
k-ary
plane
trees
case
replaced
hence
kn+1
k−1
n+r
factor
occurs
possibilities
child
proof
follows
fact
kn+1
k−1
n+1
cid:3
kn+1
k−1
n+1|
r|p
corollary
4.5
number
unlabeled
k-ary
plane
trees
vertices
equals
cid:18
cid:19
cid:19
cid:18
proof
k-ary
plane
tree
vertices
non-leaf
vertices
ways
label
non-leaf
vertices
root
labeled
therefore
dividing
number
non-leaf
labeled
plane
trees
vertices
root
obtain
desired
number
unlabeled
k-ary
plane
trees
cid:3
corollary
4.6
n−q
xi=p
cid:18
cid:19
cid:18
cid:19
cid:18
cid:19
proof
let
forest
non-leaf
labeled
trees
may
treated
union
two
small
forests
namely
forest
trees
roots
forest
trees
roots
follows
corollary
4.4
n−q
xi=p
cid:18
cid:19
cid:18
cid:19
cid:19
cid:18
cid:18
cid:19
dividing
sides
identity
complete
proof
cid:3
corollary
4.7
narayana
number
unlabeled
plane
trees
vertices
leaves
equals
cid:18
cid:19
cid:19
cid:18
proof
follows
4.10
n+1
n−p
2n−p
n−1
n−p
2n−p
n−1
4.11
n−p
2n−p
n−1
one
sees
child
number
forests
n−p
2n−p
n−1
vertex
degree
equal
possibilities
child
follows
n−p
2n−p
n−1
xx1+···+xn−p+1=n
4.12
well
known
number
solutions
positive
integers
equation
xn−p+1
cid:0
n−1
n−p
cid:1
right-hand
side
4.12
equal
cid:19
cid:18
together
4.11
obtain
n+1
cid:18
cid:19
cid:19
cid:18
dividing
number
get
desired
formula
unlabeled
plane
trees
cid:3
corollary
4.8
nonnegative
integer
sequence
satisfy-
ing
plane
trees
degree
proof
without
loss
generality
suppose
like
4.11
see
number
non-leaf
vertex
labeled
plane
trees
root
degree
total
number
xdi
ways
label
leaves
plane
tree
completes
proof
cid:3
corollary
4.9
nonnegative
integer
sequence
satisfy-
ing
number
rooted
trees
degree
cid:19
cid:18
proof
rooted
tree
degree
plane
trees
degree
sequence
proof
follows
corollary
4.8
cid:3
corollary
4.10
erd´elyi-etherington
let
1n12n2
mnm
parti-
tion
n−1
i.e.
n1+2n2+·
·+mnm
n−1
n1+n2+·
·+nm
number
unlabeled
plane
trees
vertices
degree
equal
cid:18
cid:19
proof
follows
proof
corollary
4.7
replace
number
non-leaf
vertex
labeled
plane
trees
equal
product
n−2
/n0
xn−n0
ranges
permutations
multiset
1n1
2n2
mnm
hard
see
xj=1
/nj
multiplication
equals
dividing
obtain
desired
number
unlabeled
plane
trees
cid:3
k-edge
colored
trees
k-edge
colored
tree
tree
whose
edges
colored
set
colors
two
edges
common
vertex
diﬀerent
colors
convenience
set
colors
denoted
special
k-edge
colored
tree
rooted
k-edge
colored
tree
edges
root
colored
ﬁrst
colors
i.e.
note
tree
degree
root
less
equal
denote
set
forests
special
k-edge
trees
roots
theorem
5.1
following
recurrence
relations
r−1
5.13
proof
r−1
color
none
edges
father
vertex
could
color
assume
edge
child
vertex
first
remove
subtree
add
new
tree
forest
second
one
edge
father
vertex
colored
recolor
third
descendant
new
forest
must
descendant
exchange
labels
vertices
thus
obtain
forest
conversely
forest
use
following
steps
recover
first
attach
vertex
back
vertex
trees
subtree
subtree
exchange
labels
attach
vertices
note
uncolored
edge
i.e.
edge
child
vertex
denote
father
vertex
set
colors
edges
incident
second
one
roots
forest
i.e.
color
color
whenever
empty
otherwise
color
color
whenever
empty
third
color
say
edge
incident
vertex
recolor
note
degf
otherwise
degf
therefore
number
ways
recover
given
xv=1
degf
degf
xv=r+1
xv=1
degf
completes
proof
5.13
cid:3
figure
gives
example
case
order
make
ﬁgure
clear
replace
colors
set
figure
example
recurrence
relation
5.13
corollary
5.2
number
forests
special
k-edge
colored
trees
roots
cid:19
cid:18
proof
follows
immediately
5.13
fact
n−1
cid:3
following
result
due
gessel
see
124
also
deduced
way
corollary
5.3
number
k-edge
colored
trees
cid:19
cid:18
proof
case
corollary
5.2
implies
number
special
k-colored
trees
root
cid:19
cid:18
note
k-colored
tree
special
one
edges
root
colored
delete
edge
obtain
forest
two
special
k-colored
trees
one
roots
corollary
5.2
says
number
forests
two
special
k-edge
colored
trees
roots
cid:19
cid:18
number
forests
roots
hence
number
k-colored
trees
root
given
cid:18
cid:19
cid:19
cid:18
completes
proof
cid:3
corollary
5.4
number
k-edge
colored
trees
speciﬁc
root
root
degree
cid:18
cid:19
cid:19
cid:18
proof
suppose
root
tree
cid:0
n−1
choose
children
set
cid:0
edges
root
obviously
subtrees
may
regarded
special
k-edge
colored
tree
edges
root
colored
deﬁnite
set
colors
follows
corollary
5.2
cid:1
ways
cid:1
ways
color
cid:0
n−1
trees
vertices
speciﬁc
roots
therefore
number
required
trees
n−r−2
cid:1
ways
construct
forest
special
k-edge
cid:18
cid:19
cid:18
cid:19
cid:19
cid:18
desired
cid:3
acknowledgments
authors
would
like
thank
anonymous
referees
helpful
comments
previous
version
paper
ﬁrst
author
partially
supported
natural
science
research
project
ordinary
universities
jiangsu
province
china
grant
13kjb110001
references
aigner
g.m
ziegler
proofs
book
fourth
ed.
springer-
verlag
berlin
2010
t.l
austin
enumeration
point
labelled
chromatic
graphs
trees
canad
math
1960
535–545
cayley
theorem
trees
quart
math
1889
376–378
w.y.c
chen
general
bijective
algorithm
trees
proc
natl
acad
sci
usa
1990
9635–9639
w.y.c
chen
v.j.w
guo
bijections
behind
ramanujan
polynomials
adv
appl
math
2001
336–356
w.y.c
chen
j.f.f
peng
disposition
polynomials
plane
trees
euro-
pean
combin
2014
122–129
l.e
clarke
cayley
formula
counting
trees
london
math
soc
1958
26–28
r.r.x
yin
counting
labelled
trees
given
indegree
sequence
combin
theory
ser
117
2010
345–353
eˇgecioˇglu
j.b.
remmel
bijections
cayley
trees
spanning
trees
q-analogues
combin
theory
ser
1986
15–30
eˇgecioˇglu
j.b.
remmel
bijection
spanning
trees
complete
multipartite
graphs
congr
numer
100
1994
225–243
erd´elyi
i.m.h
etherington
problems
non-associative
combi-
nations
edinburgh
math
notes
1941
7–12
fiedler
sedl´aˇcek
ˇcasopis
pro
pˇestov´ani
matematiky
1958
214–225
v.j.w
guo
zeng
generalization
ramanujan
polynomials
plane
trees
adv
appl
math
2007
96–115
haiman
schmitt
incidence
algebra
antipodes
lagrange
in-
version
one
several
variables
combin
theory
ser
1989
172–185
q.-h.
hou
insertion
algorithm
leaders
rooted
trees
european
combin
2016
35–44
t.v
narayana
partial
order
application
probability
sankhy¯a
1959
91–98
pitman
coalescent
random
forests
combin
theory
ser
1999
165–193
r´enyi
remarks
theory
trees
mta
mat
kut
inst
kozl
publ
math
inst
hungar
acad
sci
1959
73-85
selected
papers
vol
akadmiai
kiad
budapest
1976
363–374
riordan
forests
labeled
trees
combin
theory
1968
90–103
shin
zeng
bijective
enumeration
labeled
trees
given
inde-
gree
sequence
combin
theory
ser
118
2011
115–128
r.p
stanley
enumerative
combinatorics
vol
cambridge
university
press
cambridge
1999
